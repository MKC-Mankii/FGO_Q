<!DOCTYPE html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
    <title>紫猫插件手机版帮助</title>
    <style>
        body{
            font-size:12px;
            font-family:"宋体", Verdana, serif;
        }
        a:link {
            color: #316AC5;
        }
        a:hover {
            color: blue;
        }
        a:active {
            color: rgb(26, 14, 190);
        }
        a:visited {
            color: #316AC5;
        }
        .ts{
            background:#fff;
            margin:0 0 40px 0;
        }
        .ts th{
            color:#666666;
            background:#D8D8D8;
            line-height:24px;
            font-size:14px;
            font-family: "Microsoft Yahei", Helvetica, sans-serif;
            white-space: nowrap;
        }
        .ts td {
            padding:8px 10px;
            line-height: 16px;
        }
        .copy {
            color: blue;
            text-decoration: underline;
        }
        .name {
            font-size:16px;
            font-weight:bold;
            border-bottom:1px dashed #9C9A9C;
            color:#316AC5;
        }
        .canshu {
            background:#E7E7EF;
        }
        .fanhui, .lizi {
            border-bottom:1px dashed #9C9A9C;
        }
        .yufa {
            border-top:1px dashed #9C9A9C;
            color:#316AC5;
        }
        .note {
            color: #006600
        }
        .ad {
            color: red;
            font-size: 20px;
            font-weight: bold;
        }
        h1 {
            text-align: center;
        }
    </style>
    <script>
        function copyToClipboard(element) { 
            var d=document.getElementById(element).innerText;
            while(d.indexOf("&amp;")!=-1)
            {
                d=d.replace("&amp;","&")
            }
            while(d.indexOf("&lt;")!=-1)
            {
                d=d.replace("&lt;","<")
            }

            while(d.indexOf("&gt;")!=-1)
            {
                d=d.replace("&gt;",">")
            }
            if(clipboardData.setData('text', d))
                alert("已复制到剪贴板");
            else 
                alert("复制失败,请手工复制");  
        }  

        function hand(obj) { 
            obj.style.cursor='pointer' ;  
        } 

        function showPic(e,sUrl){
            var x,y;
            x = e.clientX;
            y = e.clientY;
            document.getElementById("Layer1").style.left = x+2+'px';
            document.getElementById("Layer1").style.top = y+2+'px';
            document.getElementById("Layer1").innerHTML = "<img border='0' src=\"" + sUrl + "\">";
            document.getElementById("Layer1").style.display = "";
        }

        function hiddenPic(){
            document.getElementById("Layer1").innerHTML = "";
            document.getElementById("Layer1").style.display = "none";
        } 
    </script>
</head>
<body>
    <h1>紫猫插件手机版帮助</h1>
    <div id="Layer1" style="display: none; position: absolute; z-index: 100;"></div>
    <div class="ad">
        欢迎报名加入紫猫学院，享受专业的指导教学。<br />
        学院官网: <a href="https://zimaoxy.com/" target="_blank">https://zimaoxy.com/</a><br/>
        微信公众号: <a href="" onmouseout="hiddenPic();" onmousemove="showPic(event,'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPAAAADwCAMAAAAJixmgAAAAw1BMVEX///8BAQEPDw+jSaTDi8MaGhoWFRbDSaTw//+za7Thx+GzSaQfHx+jSbT//+H/49Oja9Pw4/Bwbm6zqvDDx///x8P///Dhi6SjScPh4//S4//wqrRocHDh//+ji+Cza8PSi73Dx+3Dqt3yx9Wzi9Phqr6ja73hi7ZuaGj/4+HWquDDi9PSa6T/4/DDa7Sza6TSx/XDi7JQT03w4//n/+HS4+Gzqt/Da6R5dnZhZWThx/DDqvDwx8Pw493wqsPh4/CmpqaJdvLGAAAM0UlEQVR42uyZ0W6DMAxFd48Unvj/750mTV0mx61TAw2Q82SlicPBlKDkazKZTCaTyeR4FMaORZKw2R4xqvltMPPWLaXxqwFF2VjYthsBwwthRYQ1hTuFeXMwVpgeYWT7X++RZoAK3+6RliJv8o7YEMn8fKwTu+wnzN2EGzGbCDO+MHWcEOYxnLGF/8dc8ZHGf6RRThiJvSu8hu9uZMpieq5qU4S0mKsictORUM3SIaxNhZ08Fmy2uLAM4wuLtrAuK6wLCWNeZhauJCzMloClnEv4991YwZ8W3mL2PE99I8YUdj8eUrOcSxhJ3Ek4X2GuKMyjnbErjISXejUZ6v7LW7cViQ8KuxloZfAJvcMrxhNWXli3E+ZcwswKdwkjxJ2ED6ywT2bV7b0s2z7QntYGwoimMGJsYQ6vMGeqMFWFRbvCIldhDhDmZR/O8R8mIky0whwijCtssVe3tCdbq9jTQOKvPxLOJj62v4SEJ4yEPErifBjRdXrYH9PZrhhsciD+yZg+YZ1eWJ8W5lBJthFGARKSkf6LN5Z2e0kIu+RX5sio6FcaJAR2ESYhrMg6P5qwMsKBbMNVOCc8Kzy0MOabZnUubhXSUo2qwctW9hOmmrj/CJtWZUpzvxph+yf2Ny2lO93mZ/aWrPBTjhAmLox+4NPC7FlhGs79wgxT4W9yzm3HYRAGovKRmv//5H1ZVamm2EwcVLqb10LgMOY2oRAE/yykv6kPu5tB99i3bdlo3v5awPCNW8AEewJjKsxyhamBuQrM4Fg2ar6e01MDH0EnpLmqMNMhjd+HGQMTNPswi0KaCNLtuM6rJxg6IU0W0lwLaRKLh9dKP3I1BPJ4GhJILgoF1PdGNw9m8z2mfOm6tUjTE9S53pdL5XiYwHO+tFEk3XFYx/k1wHETcNwGHAuB2Q+YpcBuHz5GwwaSPq3E0VdY31NuRetBK5v96sePBZAuPDTcG9seBzjuAUZhjG9XXwg86u2sB2Yr4F/sv6fwy4KEE+VGCj86wCfnWc260TEFvdBCfOzi0e9bzCjMUACM/wlLJcpc8/NC0kzqfFMChxty8qSuJX0vKq+VPg0vvwtMfUIDG9j3vTXYZoAZps9jZ7XCCHPH+KSlMHUpfCCk3ZXQXgpzA7BroLq5XFvfaOJlwIg3VudCS2R/YAZFHgSlz8xOCjMBzKBI7vlMH+ibP67wu1+JNvB6hevFfeJjS5GwBpgJYCpg9YflPo3peza44SwVcjbj5DOnwOpvT3hahCrm3rMRdICrsb1a/xkKu/NqknIRsHMdWR+YGvgpwA8397qdJhAEAHid2UQQUZF4QU+9gklMvaWtNmnTvP9bdUaRogsoRWvs/HBhzwnhc3ZhmUSL4d6yfNKE+CV/bDvq2qbpyZYQQznQdgbvhwHnUoCftz2PvSenhs13S2tgRzxOXX4DVhVtSMpSHu+EaGNlB/y8N02OKAxBVjBEwW6OmMPg//wfcNkwWzWksBs46lHbF4L2l3msWG957FuWh5V3K0R+ic6woryJ4RX9ntSfagG1gK4W6MO5DZ/DSxSYoltgGm+aCwxFJ/6GFILBySpwGavE6hEedsHNT2ul69DrkjsR7fZhsIo5KxjiwJAOPPcQdcNusKr+GW1Rv0d+C3bm8EcAZ8lw1e/2DPSDwNiVKyQjbVFzJWBIA2YNh77ApVZe20lH0JGBdn1YCOI1JRiygsOV4qLf8mZMqbWYfIQcBEO6PHi16NaEaM5FOe/6tAmN7MrXPAZR0eLBMeeTi/rt3GZarCc/0Ae+pMeMujdD7M4t655gfb+TwE0Cm/oM6cVIBKvnoOZZDTjm/6UzlHLiwaVtIpm97WzgGmzz9fpO1BLByTM52XIJsPDkuEfa0YAuzssNjJNtfjs3GDKC4S/BQ57BrkNbPw0ccdsgvsHgbfxPGaYUEk+n2NDMFi8tO2/pwfCPwZAe7F+e/DD1rpQztKlvrJUJfJk5nKKwnqbCXBXbmFgewUqsa4z6ln/HzQBOX9M6Kxj2wcMVYtNhMOHQHGxotfVVeiQXvPyaRoJvrwO8l2FGopzy/ZbX0ExuiTbOcGfhcc0ZzkEYzFPYdYLFM5Gxw+nlXUq6W1iHFwGGo8BwafCtMqQnX3hYSzl2/H2ilXpy4IjSVPdrPjXdva4MQ9yQPn8JHk4LVo8OUd/LwRHuyQb+rnyZIAQ2FXCTAZz978NwCnA1Kbcq75Lg02T44cRgOAgG3gb1sQ8uBYYDYLjuDP9u71x0o4aBKIovm0DbFLS7vKl4CkHLGyREBUL8/1dhJwGnDPXMZBJvwuaqqrZRlPTozjr22BlbQ1o0ZgZNi5LJq6LTLEEBfOcsPI1e1mPh9d83fnt4dp1ptMJ9GeBS4LC+2remHx6Bw5hwe+X0Wp2mvO2Hh80Ui9frZqR4/EC6alK4VInW/VBV+4YVOGQ8boVk3rb+uG0OeR0H6nehL73ys0umrS7AzDOpuopG4PXaW/wlzKo8W7/xCff1ugZ+/O7q8XtbX1pwHFpgu8NtbjYqhHDIR/tstA/ng1pHZmC1VekJZT4/qAe+e3Xrf9q+9HgOQ/J2aakMaTLtBudeRWAfxVF3W+CnnvnO87PDRmdhhJHuMJbhspWLAgvMF1UQl2QrIirzVAzAp4d/dP838Cq02ndb08Nn/aY1xqqXUaoOBhjg0yerb51pwu0P/zQKwAchil8etHosBTYODO3AhSvTwEFd4PpAG9Ldc+YCrHhB+dTntppxfttKP3qxatR2QqgcUsCYNvBL3z7XM0st8M2jex+7Tff/4vCPg0bvA1Xz8VsLfPws5CxDDyQ4rAaGAZiD0azoId9fom39Hf7uXY3rIbo64d1TrojPCfx81ejjkTey0YemlQ6cD/2vAHyz6/D5rIHjECL2pprncD3t4A8G4Atdra/DAWN3wIGtC/z08POV50dhHBWAfZPdyXjIgYFJOtzMp10EvlU/pn5n5QP4QA5TQQYMJTASDj+MTBH4zpvwXA5/xL6l0uHYXb4UGGKHaW+5SqzxSI88b/rnjg/hWnFR6Y1V01K9fbG6MHj4pIqgkgwSRDYIX6Tj+z0G6YH5YaAzAAv7PXZBDRyUExjDAjP553zAyOSw0zsMNTAMDhfOIRNwaSg+ZSpZUKabNAM7s78tJG+g24H7bqb904BpGCHlB47/4PmndgS0OfFq5442J+cnm6+bzSv/qZYMONGYTQMY4u0KTMB2hzEQMDkyVWByCbrYoSJnxuMscKUErnTAUAAnNqBHg9230Kp2cQzqvxSRSCpOSr2FIAhhADYmmAarekvzzPzlMLzDFmCogMWtbhTGdDjC6xtXDANMNQIwGIfl+yTagbvXm/R3GHpgIlM1RCLrXfRRqQeGw34Bz9Vh9HfYQQOMaQBjOg4jY0jDBgxyDgYKaQwKjJaWry9Ni2WQ4n2yuhkUuNdiGmg3HtTmpZHeJw1M3QwdML2OfViqzloadm8wAHuNAgwHDTByAoO7MnbmMObksGbfw6JPSKMncEEKQibSwyDHOYd56avwgEkPMIWwyXX6bRVo2CdxnOJt2q4LLHXk9cDYOXB8/quB5+mwy+pwK4iAMTowtMB2h5Nbi1SEt6RXqxz+eZysi6Z5bHq8IF9AtNdR7j+MxPygKZWj9zw9BQ+Lk+zjfirAXe0dMHoDY0fA6AOMfXIY+x3SDLBZtlliKn7Kzl6zelRgOJiAo2YCHD/DBAz+XUIeGOMDlw5uNIcxPYfrYfvIIQ0lMOYR0tFPkmcWA/N5aV6lPLmTyi0xdUorSZ65cvhndq3Qlmo1pGzBIBniRfwIRPMTj48JzDpsB0YSOGrnwJkcDsJAwMgX0piCw7A4DAZYNzmW3r6VHlc7kL6B1kntIISwOMOyGA2w2z2wUwJj34D3zuHhgaEGhsMcgXHJWkvIlzYkBSUwogFQA0P5TKP7DKY302ae5+Q6Lil6vhrY9QK2TGEzR6TKD4zmtw2YXicpen6mkKb9WAhXaMD/8Gv5eOYlpBdgM/BQG2HYUvz8f7IAW4BhBMbAwBgVGJfcBjtyGOR/xmghjT0J6bhJSm9gyIHBAJN9GGEGpoMHkHyIPF9VkaWHdOt00B4Ygb9sHWhhdJhfaGqYWIXgjuiexQHH2BsW2NmBh9nWGUwHJiMwnPjtVWb4gQSwmw6wzGGYHEZ/4EIADB1wKf8O0/NJI8Q0WhrgpLQpUtkGjVGl8qluWBdtA44wtjdTHZH8faaswLrWNfKDBRaWuILL67AkCCmuoqM6B4ejD1AO2bkWAfmAKx64kjhMzm9VkdpN9L4YzmE+RWZI8TBy4OuUx/wzBy8y0jEaAdj+Mtf/D4zG5izAEAOjFzA44ETem6lHjfk6vHch3Rt40aJFixYtWrQou34Bg+OzLyufRscAAAAASUVORK5CYII=');">zimaoxy-com</a><br />
        更多信息请咨询报名QQ: 345911220 <a target="_blank" href="http://wpa.qq.com/msgrd?v=3&uin=345911220&site=zmplugin&menu=yes"><img border="0" src="http://wpa.qq.com/pa?p=2:345911220:51" alt="点我联系紫猫老师" title="点我联系紫猫老师"/></a><br />
        3000人学习QQ群: 7333555 <a target="_blank" href="https://jq.qq.com/?_wv=1027&k=5jqkPLG"><img border="0" src="http://pub.idqqimg.com/wpa/images/group.png" alt="按键精灵后花园★紫猫" title="按键精灵后花园★紫猫"></a>
    </div>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="About" id="About"> <a href="https://zimaoxy.com/m/post/zm.about/" target="_blank">zm.About 介绍与下载</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>输出最新版插件更新内容，当传入命令字符串参数时，输出该命令的在线文档地址。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.About([命令])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">命令: 字符串, 可选参数，紫猫插件里的命令名，例如`RndStr`、`ColorToHSV`等。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeAbout');">复制代码</div>
                <pre id="codeAbout">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Call zm.About()
zm.About "RndStr" //显示zm.RndStr命令文档地址</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>只是一个插件介绍功能，除了想知道文档地址外，一般不需要使用。<br>
V1.1720: 加入命令<br>
V1.1722: 增加一个参数，实现输出显示在线文档地址。</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="Init" id="Init"> <a href="https://zimaoxy.com/m/post/zm.init/" target="_blank">zm.Init 初始化插件环境</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>初始化插件环境，只需要执行一次</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.Init()</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">无</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeInit');">复制代码</div>
                <pre id="codeInit">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>用于初始化插件的运行环境，加载常用数据，加强插件的稳定性，加快插件命令执行效率，一般放脚本开头运行一次即可。<br>
V1.1723b: 初次加入<br>
V1.1730: 修复报错问题<br>
V1.1750: 提高执行效率<br>
V1.1802: 加入快速初始化命令<br>
V1.1818: 仅在每天首次启动检查更新, 大幅度提高速度<br>
V1.1820: 优化执行效率</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FindStrBaiDu" id="FindStrBaiDu"> <a href="https://zimaoxy.com/m/post/zm.findstrbaidu/" target="_blank">zm.FindStrBaiDu 百度云找字</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>使用百度云识别来实现找字功能, 不需要字库, 字体颜色之类的参数, 必须先使用 <a href="https://zimaoxy.com/m/post/zm.ocrbaiduinit/" target="_blank">zm.ocrbaiduinit</a> 进行初始化后使用, 默认参数使用 <a href="https://zimaoxy.com/m/post/zm.setfindstr/" target="_blank">zm.setfindstr</a> 修改</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FindStrBaiDu([对象][x1, y1, x2, y2, ]文字[, 查找超时][, 是否点击][, 点击坐标][, 显示日志][, 输出行号][, 备注][, 等待消失][, 消失超时][, 参数返回值])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象: 表, 可选, 把所有参数放入一个table中传入, 若后面跟有其他参数, 则会对应覆盖对象数据<br>x1: 数值型, 可选, 查找范围的左上角x坐标, 省略默认为0<br>y1: 数值型, 可选, 查找范围的左上角y坐标, 省略默认为0<br>x2: 数值型, 可选, 查找范围的右下角x坐标, 省略默认为0<br>y2: 数值型, 可选, 查找范围的右下角y坐标, 省略默认为0<br>文字: 字符串, 可选, 查找的文字内容, 多个文字用“&#124;”隔开, 可以用`$`开头表示文字参数<br>超时时间: 数值型, 可选, 最大查找耗时, 单位毫秒, 如果一次找不到, 可以限时循环查找, 省略默认为`1`<br>是否点击: 布尔型, 可选, 是否需要找到后自动点击该坐标, 支持`[true, false]`这两个值, 省略默认为`false`<br>点击坐标: 字符串, 可选, 点击修改后的坐标, 格式`"±x,±y,t"`, 省略为找到的坐标, `t`是可选的, 表示点击后延时毫秒, 例如`"100,100"`表示固定点击坐标100,100, `"+10,-10"`表示偏移点击找到的x+10,y-10位置, `"10,10,2000"`表示点击10,10坐标后延时2000毫秒, 该参数会受 <a href="https://zimaoxy.com/m/post/zm.settap/" target="_blank">zm.settap</a> 影响<br>显示日志: 字符串, 可选, 输出调试日志信息, 省略默认为"隐藏", 支持`["显示","隐藏","show","hide"]`这几个值<br>输出行号: 字符串, 可选, 格式为`"_"`开头后跟行号, 比如`"_10"`表示第10行代码, 输出调试信息窗口显示第几行代码, 需开启显示日志才有效<br>备注: 字符串, 可选, 格式为`"@"`开头后跟内容, 比如`"@拾取屠龙刀"`, 输出调试信息窗口就会增加这条内容, 若连续两个`"@@"`则表示在浮窗中显示信息, 需要开启显示日志才有效<br>等待消失: 数值型, 可选, 填写`-1`禁用或`-2`启用, `-2`表示找到后或点击后继续查找, 直到找不到或消失超时, 省略默认为`-1`, 启用后返回值将有`miss`键名, 值为`true`时表示成功消失, 值为`false`表示未消失<br>消失超时: 数值型, 可选, 填写`负数`, 表示等待消失的超时时间, 单位毫秒, 注意必须填写负数, 不可填-1和-2, 省略默认为`-2000`<br>参数返回值: 表, 可选, 只能传入数组变量名, 用于保存查找结果, 格式与命令返回值相同</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 找到返回结果保存到表中, 格式为`{id, x, y, name, "id":id, "x":x, "y":y, "name":name, "miss":miss, "baidu":原生返回值}`, 没找到或出错返回null, 使用方法请看示例</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFindStrBaiDu');">复制代码</div>
                <pre id="codeFindStrBaiDu">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

If zm.OcrBaiDuInit("请修改成你的API Key", "请修改成你的Secret Key") Then
  TracePrint "设置百度云识别成功"
Else
  TracePrint "设置百度云识别失败"
End If

Dim ret

//--------------------初级用法--------------------//
//默认全屏查找"紫猫学院"这4个字, 任何颜色都可以
ret = zm.FindStrBaiDu("紫猫学院")
If ret Then
    TracePrint "可以用以下3种格式获取返回值"
    TracePrint "找到序号" & ret(0), "x=" & ret(1), "y=" & ret(2), "文字=" & ret(3)
    TracePrint "找到序号" & ret[1], "x=" & ret[2], "y=" & ret[3], "文字=" & ret[4]
    TracePrint "找到序号" & ret["id"], "x=" & ret["x"], "y=" & ret["y"], "文字=" & ret["name"]
Else
    TracePrint "没有找到"
End If

//--------------------中级用法--------------------//
Dim 返回数组()
//参数返回值必须是任意数组的变量名, 注意括号写法
//范围省略默认为全屏, 若填写, 则4个数字必须全写
If zm.FindStrBaiDu(100, 200, 300, 400, "紫猫学院", 返回数组) Then
    TracePrint "可以用以下3种格式获取返回值"
    TracePrint "找到序号=" & 返回数组(0), "x=" & 返回数组(1), "y=" & 返回数组(2), "文字=" & 返回数组(3)
    TracePrint "找到序号=" & 返回数组[1], "x=" & 返回数组[2], "y=" & 返回数组[3], "文字=" & 返回数组[4]
    TracePrint "找到序号=" & 返回数组["id"], "x=" & 返回数组["x"], "y=" & 返回数组["y"], "文字=" & 返回数组["name"]
Else
    TracePrint "没有找到"
End If

//--------------------高级用法--------------------//
//对象后面的可选参数全部可以打乱顺序任意填写或省略, 只要数据类型与格式正确即可
//这句代码意思如下:
//在范围(100,200,300,400)里, 限时30000毫秒内循环查找("紫猫|学院")
//找到任何一个后退出循环查找, 然后点击找到的坐标(True), 并将找到的序号与坐标结果保存到数组变量(ret)与(返回数组)中
//同时开启日志的输出("显示")功能, 在当前脚本第("_40")行输出备注("@怪物1"), 查找结果与其他参数信息
ret = zm.FindStrBaiDu(100, 200, 300, 400, "紫猫|学院", 30*1000, True, "显示", "@怪物1", 返回数组, "_40")
If ret Then
    TracePrint "找到了"
Else
    TracePrint "没有找到"
End If

//--------------------对象用法--------------------//
//可以把所有参数放到一个表中, 可选参数一样可以打乱顺序任意填写或省略
//对象参数必须填写在第一个参数位置
Dim 史莱姆 = {"紫猫|学院", True, "显示", "@攻击史莱姆", 返回数组, "_36"}
zm.FindStrBaiDu 史莱姆

//--------------------修改默认值--------------------//
Dim IXYs()
//设置默认参数返回值IXYs, 若命令不填写参数返回值, 则默认保存在该变量中
//设置默认日志输出为显示状态, 后面所有 zm.FindStrBaiDu() 都默认输出调试信息
//更多修改默认设置详见 zm.SetFindStr() 命令帮助
zm.SetFindStr {"ret":IXYs, "showlog":"显示"}
If zm.FindStrBaiDu("喵星人") Then
    TracePrint "可以用以下3种格式获取返回值"
    TracePrint "找到序号" & IXYs(0), "x=" & IXYs(1), "y=" & IXYs(2), "文字=" & IXYs(3)
    TracePrint "找到序号" & IXYs[1], "x=" & IXYs[2], "y=" & IXYs[3], "文字=" & IXYs[4]
    TracePrint "找到序号" & IXYs["id"], "x=" & IXYs["x"], "y=" & IXYs["y"], "文字=" & IXYs["name"]
Else
    TracePrint "没有找到"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用百度云的通用文字识别（含位置信息版）功能实现找字, 此命令的任何充值消费行为均与紫猫编程学院无关<br>
请自己注册帐号, 试用后再决定是否充值使用<br>
后台创建步骤:<br>
  前往[百度云AI官网](http://ai.baidu.com/)注册并登录<br>
  打开[文字识别控制台](https://console.bce.baidu.com/ai/#/ai/ocr/overview/index)<br>
  点击创建应用, 并输入应用名称与应用描述<br>
  查看刚刚创建的应用, 就可以查到API Key和Secret Key<br>
  百度云识别的[API接口文档](https://ai.baidu.com/docs#/OCR-API/top)<br>
V3.1839: 加入命令<br>
V3.1849: 支持超级缩放<br>
V3.1902: 优化百度云找字功能, 内部先使用`zm.OcrBaiDu()`函数查找是否存在文字, 若存在则调用含位置信息版的识别, 以节省次数<br>
V3.1903: 修复上版本的找字失败问题</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FindStrTableBaiDu" id="FindStrTableBaiDu"> <a href="https://zimaoxy.com/m/post/zm.findstrtablebaidu/" target="_blank">zm.FindStrTableBaiDu 百度云找字遍历</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>与 <a href="https://zimaoxy.com/m/post/zm.findstrbaidu/" target="_blank">zm.findstrbaidu</a> 类似, 参数只有一个对象数组, 可实现遍历参数的键值对象进行查找</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FindStrTableBaiDu([对象table])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象table: table, 把 <a href="https://zimaoxy.com/m/post/zm.findstrbaidu/" target="_blank">zm.findstrbaidu</a> 的对象参数放入table数组中, 实现遍历找字</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">table_ , 找到返回结果保存到表中, 格式为`{"success":找到数量, "fail":没找到数量, "键名":{id, x, y, name, "id":id, "x":x, "y":y, "name":name, "miss":miss, "baidu":原生返回值}, ...}`, 没找到或失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFindStrTableBaiDu');">复制代码</div>
                <pre id="codeFindStrTableBaiDu">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

If zm.OcrBaiDuInit("请修改成你的API Key", "请修改成你的Secret Key") Then
  TracePrint "设置百度云识别成功"
Else
  TracePrint "设置百度云识别失败"
End If

Dim 打怪(), Boss坐标()
打怪["史莱姆"] = {"史莱姆", true}
打怪["黑龙"] = {100,200,300,400, "黑龙", true}
打怪["紫猫BOSS"] = {"帅气的紫猫老师", Boss坐标} //这个不点击, 并返回值保存在Boss坐标中

//遍历打怪数组, 返回每个对象成员的结果
Dim t = zm.FindStrTableBaiDu(打怪)
If t Then
    TracePrint "找到了", t["success"], "个对象"
    TracePrint "没找到", t["fail"], "个对象"
    If t["史莱姆"] Then
        TracePrint "找到史莱姆, 坐标为", t["史莱姆"]["x"], t["史莱姆"]["y"]
    End If
Else
    TracePrint "所有对象都没有找到"
End If

If Boss坐标(0) > -1 Then
    TracePrint "紫猫BOSS对象里的返回参数依旧有效"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用百度云的通用文字识别（含位置信息版）功能实现找字, 此命令的任何充值消费行为均与紫猫编程学院无关<br>
请自己注册帐号, 试用后再决定是否充值使用<br>
后台创建步骤:<br>
  前往[百度云AI官网](http://ai.baidu.com/)注册并登录<br>
  打开[文字识别控制台](https://console.bce.baidu.com/ai/#/ai/ocr/overview/index)<br>
  点击创建应用, 并输入应用名称与应用描述<br>
  查看刚刚创建的应用, 就可以查到API Key和Secret Key<br>
  百度云识别的[API接口文档](https://ai.baidu.com/docs#/OCR-API/top)<br>
V3.1839: 加入命令<br>
V3.1849: 支持超级缩放<br>
V3.1902: 优化百度云找字功能, 内部先使用`zm.OcrBaiDu()`函数查找是否存在文字, 若存在则调用含位置信息版的识别, 以节省次数</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FindStrTableYouTu" id="FindStrTableYouTu"> <a href="https://zimaoxy.com/m/post/zm.findstrtableyoutu/" target="_blank">zm.FindStrTableYouTu 优图找字遍历</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>与 <a href="https://zimaoxy.com/m/post/zm.findstryoutu/" target="_blank">zm.findstryoutu</a> 类似, 参数只有一个对象数组, 可实现遍历参数的键值对象进行查找</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FindStrTableYouTu([对象table])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象table: table, 把 <a href="https://zimaoxy.com/m/post/zm.findstryoutu/" target="_blank">zm.findstryoutu</a> 的对象参数放入table数组中, 实现遍历找字</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">table_ , 找到返回结果保存到表中, 格式为`{"success":找到数量, "fail":没找到数量, "键名":{id, x, y, name, "id":id, "x":x, "y":y, "name":name, "miss":miss}, ...}`, 没找到或失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFindStrTableYouTu');">复制代码</div>
                <pre id="codeFindStrTableYouTu">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

If zm.OcrYouTuInit("请修改成你的AppID", "请修改成你的AppKey") Then
  TracePrint "设置优图AI识别成功"
Else
  TracePrint "设置优图AI识别失败"
End If

Dim 打怪(), Boss坐标()
打怪["史莱姆"] = {"史莱姆", true}
打怪["黑龙"] = {100,200,300,400, "黑龙", true}
打怪["紫猫BOSS"] = {"帅气的紫猫老师", Boss坐标} //这个不点击, 并返回值保存在Boss坐标中

//遍历打怪数组, 返回每个对象成员的结果
Dim t = zm.FindStrTableYouTu(打怪)
If t Then
    TracePrint "找到了", t["success"], "个对象"
    TracePrint "没找到", t["fail"], "个对象"
    If t["史莱姆"] Then
        TracePrint "找到史莱姆, 坐标为", t["史莱姆"]["x"], t["史莱姆"]["y"]
    End If
Else
    TracePrint "所有对象都没有找到"
End If

If Boss坐标(0) > -1 Then
    TracePrint "紫猫BOSS对象里的返回参数依旧有效"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用腾讯优图OCR的识别功能, 与百度云识别相比, 目前优图OCR完全免费使用<br>
本命令只适合正常屏幕方向使用, 横屏情况推荐使用 <a href="https://zimaoxy.com/m/post/zm.findstrbaidu/" target="_blank">zm.findstrbaidu</a> <br>
获取优图AppID和AppKey的步骤:<br>
  前往[腾讯AI官网](https://ai.qq.com/)注册并登录<br>
  打开[控制台](https://ai.qq.com/cgi-bin/console_overview)<br>
  点击创建应用, 并输入相关资料, 记得勾选全部OCR接口<br>
  查看刚刚创建的应用, 就可以查到AppID和AppKey<br>
V3.1839: 加入命令<br>
V3.1849: 支持超级缩放</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FindStrTapBaiDu" id="FindStrTapBaiDu"> <a href="https://zimaoxy.com/m/post/zm.findstrtapbaidu/" target="_blank">zm.FindStrTapBaiDu 百度云找字点击</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>与 <a href="https://zimaoxy.com/m/post/zm.findstrbaidu/" target="_blank">zm.findstrbaidu</a> 类似, 区别在于本命令内置找到后点击. 由于查找与点击是两个动作组成, 为方便代码阅读理解, 故新增本命令</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FindStrTapBaiDu([对象][x1, y1, x2, y2, ]文字[, 查找超时][, 点击坐标][, 显示日志][, 输出行号][, 备注][, 等待消失][, 消失超时][, 参数返回值])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象: 表, 可选, 把所有参数放入一个table中传入, 若后面跟有其他参数, 则会对应覆盖对象数据<br>x1: 数值型, 可选, 查找范围的左上角x坐标, 省略默认为0<br>y1: 数值型, 可选, 查找范围的左上角y坐标, 省略默认为0<br>x2: 数值型, 可选, 查找范围的右下角x坐标, 省略默认为0<br>y2: 数值型, 可选, 查找范围的右下角y坐标, 省略默认为0<br>文字: 字符串, 可选, 查找的文字内容, 多个文字用“&#124;”隔开, 可以用`$`开头表示文字参数<br>超时时间: 数值型, 可选, 最大查找耗时, 单位毫秒, 如果一次找不到, 可以限时循环查找, 省略默认为`1`<br>点击坐标: 字符串, 可选, 点击修改后的坐标, 格式`"±x,±y,t"`, 省略为找到的坐标, `t`是可选的, 表示点击后延时毫秒, 例如`"100,100"`表示固定点击坐标100,100, `"+10,-10"`表示偏移点击找到的x+10,y-10位置, `"10,10,2000"`表示点击10,10坐标后延时2000毫秒, 该参数会受 <a href="https://zimaoxy.com/m/post/zm.settap/" target="_blank">zm.settap</a> 影响<br>显示日志: 字符串, 可选, 输出调试日志信息, 省略默认为"隐藏", 支持`["显示","隐藏","show","hide"]`这几个值<br>输出行号: 字符串, 可选, 格式为`"_"`开头后跟行号, 比如`"_10"`表示第10行代码, 输出调试信息窗口显示第几行代码, 需开启显示日志才有效<br>备注: 字符串, 可选, 格式为`"@"`开头后跟内容, 比如`"@拾取屠龙刀"`, 输出调试信息窗口就会增加这条内容, 若连续两个`"@@"`则表示在浮窗中显示信息, 需要开启显示日志才有效<br>等待消失: 数值型, 可选, 填写`-1`禁用或`-2`启用, `-2`表示找到后或点击后继续查找, 直到找不到或消失超时, 省略默认为`-1`, 启用后返回值将有`miss`键名, 值为`true`时表示成功消失, 值为`false`表示未消失<br>消失超时: 数值型, 可选, 填写`负数`, 表示等待消失的超时时间, 单位毫秒, 注意必须填写负数, 不可填-1和-2, 省略默认为`-2000`<br>参数返回值: 表, 可选, 只能传入数组变量名, 用于保存查找结果, 格式与命令返回值相同</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 找到返回结果保存到表中, 格式为`{id, x, y, name, "id":id, "x":x, "y":y, "name":name, "miss":miss, "baidu":原生返回值}`, 没找到或出错返回null, 使用方法请看示例</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFindStrTapBaiDu');">复制代码</div>
                <pre id="codeFindStrTapBaiDu">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

If zm.OcrBaiDuInit("请修改成你的API Key", "请修改成你的Secret Key") Then
  TracePrint "设置百度云识别成功"
Else
  TracePrint "设置百度云识别失败"
End If

//本命令内置找到后点击, 其他用法例子与zm.FindStrBaiDu()相同
Dim ret
ret = zm.FindStrTapBaiDu("紫猫学院")
If ret Then
    TracePrint "文字找到并执行了点击"
Else
    TracePrint "没有找到文字, 不执行点击"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用百度云的通用文字识别（含位置信息版）功能实现找字, 此命令的任何充值消费行为均与紫猫编程学院无关<br>
请自己注册帐号, 试用后再决定是否充值使用<br>
后台创建步骤:<br>
  前往[百度云AI官网](http://ai.baidu.com/)注册并登录<br>
  打开[文字识别控制台](https://console.bce.baidu.com/ai/#/ai/ocr/overview/index)<br>
  点击创建应用, 并输入应用名称与应用描述<br>
  查看刚刚创建的应用, 就可以查到API Key和Secret Key<br>
  百度云识别的[API接口文档](https://ai.baidu.com/docs#/OCR-API/top)<br>
V3.1839: 加入命令<br>
V3.1849: 支持超级缩放<br>
V3.1902: 优化百度云找字功能, 内部先使用`zm.OcrBaiDu()`函数查找是否存在文字, 若存在则调用含位置信息版的识别, 以节省次数</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FindStrTapYouTu" id="FindStrTapYouTu"> <a href="https://zimaoxy.com/m/post/zm.findstrtapyoutu/" target="_blank">zm.FindStrTapYouTu 优图找字点击</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>与 <a href="https://zimaoxy.com/m/post/zm.findstryoutu/" target="_blank">zm.findstryoutu</a> 类似, 区别在于本命令内置找到后点击. 由于查找与点击是两个动作组成, 为方便代码阅读理解, 故新增本命令</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FindStrTapYouTu([对象][x1, y1, x2, y2, ]文字[, 查找超时][, 点击坐标][, 显示日志][, 输出行号][, 备注][, 等待消失][, 消失超时][, 参数返回值])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象: 表, 可选, 把所有参数放入一个table中传入, 若后面跟有其他参数, 则会对应覆盖对象数据<br>x1: 数值型, 可选, 查找范围的左上角x坐标, 省略默认为0<br>y1: 数值型, 可选, 查找范围的左上角y坐标, 省略默认为0<br>x2: 数值型, 可选, 查找范围的右下角x坐标, 省略默认为0<br>y2: 数值型, 可选, 查找范围的右下角y坐标, 省略默认为0<br>文字: 字符串, 可选, 查找的文字内容, 多个文字用“&#124;”隔开, 可以用`$`开头表示文字参数<br>超时时间: 数值型, 可选, 最大查找耗时, 单位毫秒, 如果一次找不到, 可以限时循环查找, 省略默认为`1`<br>点击坐标: 字符串, 可选, 点击修改后的坐标, 格式`"±x,±y,t"`, 省略为找到的坐标, `t`是可选的, 表示点击后延时毫秒, 例如`"100,100"`表示固定点击坐标100,100, `"+10,-10"`表示偏移点击找到的x+10,y-10位置, `"10,10,2000"`表示点击10,10坐标后延时2000毫秒, 该参数会受 <a href="https://zimaoxy.com/m/post/zm.settap/" target="_blank">zm.settap</a> 影响<br>显示日志: 字符串, 可选, 输出调试日志信息, 省略默认为"隐藏", 支持`["显示","隐藏","show","hide"]`这几个值<br>输出行号: 字符串, 可选, 格式为`"_"`开头后跟行号, 比如`"_10"`表示第10行代码, 输出调试信息窗口显示第几行代码, 需开启显示日志才有效<br>备注: 字符串, 可选, 格式为`"@"`开头后跟内容, 比如`"@拾取屠龙刀"`, 输出调试信息窗口就会增加这条内容, 若连续两个`"@@"`则表示在浮窗中显示信息, 需要开启显示日志才有效<br>等待消失: 数值型, 可选, 填写`-1`禁用或`-2`启用, `-2`表示找到后或点击后继续查找, 直到找不到或消失超时, 省略默认为`-1`, 启用后返回值将有`miss`键名, 值为`true`时表示成功消失, 值为`false`表示未消失<br>消失超时: 数值型, 可选, 填写`负数`, 表示等待消失的超时时间, 单位毫秒, 注意必须填写负数, 不可填-1和-2, 省略默认为`-2000`<br>参数返回值: 表, 可选, 只能传入数组变量名, 用于保存查找结果, 格式与命令返回值相同</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 找到返回结果保存到表中, 格式为`{id, x, y, name, "id":id, "x":x, "y":y, "name":name, "miss":miss}`, 没找到或出错返回null, 使用方法请看示例</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFindStrTapYouTu');">复制代码</div>
                <pre id="codeFindStrTapYouTu">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

If zm.OcrYouTuInit("请修改成你的AppID", "请修改成你的AppKey") Then
  TracePrint "设置优图AI识别成功"
Else
  TracePrint "设置优图AI识别失败"
End If

//本命令内置找到后点击, 其他用法例子与zm.FindStrYouTu()相同
Dim ret
ret = zm.FindStrTapYouTu("紫猫学院")
If ret Then
    TracePrint "文字找到并执行了点击"
Else
    TracePrint "没有找到文字, 不执行点击"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用腾讯优图OCR的识别功能, 与百度云识别相比, 目前优图OCR完全免费使用<br>
本命令只适合正常屏幕方向使用, 横屏情况推荐使用 <a href="https://zimaoxy.com/m/post/zm.findstrbaidu/" target="_blank">zm.findstrbaidu</a> <br>
获取优图AppID和AppKey的步骤:<br>
  前往[腾讯AI官网](https://ai.qq.com/)注册并登录<br>
  打开[控制台](https://ai.qq.com/cgi-bin/console_overview)<br>
  点击创建应用, 并输入相关资料, 记得勾选全部OCR接口<br>
  查看刚刚创建的应用, 就可以查到AppID和AppKey<br>
V3.1839: 加入命令<br>
V3.1849: 支持超级缩放</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FindStrYouTu" id="FindStrYouTu"> <a href="https://zimaoxy.com/m/post/zm.findstryoutu/" target="_blank">zm.FindStrYouTu 优图找字</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>使用优图AI识别来实现找字功能, 对横屏识别效果不佳, 不需要字库, 字体颜色之类的参数, 必须先使用 <a href="https://zimaoxy.com/m/post/zm.ocryoutuinit/" target="_blank">zm.ocryoutuinit</a> 进行初始化后使用, 默认参数使用 <a href="https://zimaoxy.com/m/post/zm.setfindstr/" target="_blank">zm.setfindstr</a> 修改</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FindStrYouTu([对象][x1, y1, x2, y2, ]文字[, 查找超时][, 是否点击][, 点击坐标][, 显示日志][, 输出行号][, 备注][, 等待消失][, 消失超时][, 参数返回值])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象: 表, 可选, 把所有参数放入一个table中传入, 若后面跟有其他参数, 则会对应覆盖对象数据<br>x1: 数值型, 可选, 查找范围的左上角x坐标, 省略默认为0<br>y1: 数值型, 可选, 查找范围的左上角y坐标, 省略默认为0<br>x2: 数值型, 可选, 查找范围的右下角x坐标, 省略默认为0<br>y2: 数值型, 可选, 查找范围的右下角y坐标, 省略默认为0<br>文字: 字符串, 可选, 查找的文字内容, 多个文字用“&#124;”隔开, 可以用`$`开头表示文字参数<br>超时时间: 数值型, 可选, 最大查找耗时, 单位毫秒, 如果一次找不到, 可以限时循环查找, 省略默认为`1`<br>是否点击: 布尔型, 可选, 是否需要找到后自动点击该坐标, 支持`[true, false]`这两个值, 省略默认为`false`<br>点击坐标: 字符串, 可选, 点击修改后的坐标, 格式`"±x,±y,t"`, 省略为找到的坐标, `t`是可选的, 表示点击后延时毫秒, 例如`"100,100"`表示固定点击坐标100,100, `"+10,-10"`表示偏移点击找到的x+10,y-10位置, `"10,10,2000"`表示点击10,10坐标后延时2000毫秒, 该参数会受 <a href="https://zimaoxy.com/m/post/zm.settap/" target="_blank">zm.settap</a> 影响<br>显示日志: 字符串, 可选, 输出调试日志信息, 省略默认为"隐藏", 支持`["显示","隐藏","show","hide"]`这几个值<br>输出行号: 字符串, 可选, 格式为`"_"`开头后跟行号, 比如`"_10"`表示第10行代码, 输出调试信息窗口显示第几行代码, 需开启显示日志才有效<br>备注: 字符串, 可选, 格式为`"@"`开头后跟内容, 比如`"@拾取屠龙刀"`, 输出调试信息窗口就会增加这条内容, 若连续两个`"@@"`则表示在浮窗中显示信息, 需要开启显示日志才有效<br>等待消失: 数值型, 可选, 填写`-1`禁用或`-2`启用, `-2`表示找到后或点击后继续查找, 直到找不到或消失超时, 省略默认为`-1`, 启用后返回值将有`miss`键名, 值为`true`时表示成功消失, 值为`false`表示未消失<br>消失超时: 数值型, 可选, 填写`负数`, 表示等待消失的超时时间, 单位毫秒, 注意必须填写负数, 不可填-1和-2, 省略默认为`-2000`<br>参数返回值: 表, 可选, 只能传入数组变量名, 用于保存查找结果, 格式与命令返回值相同</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 找到返回结果保存到表中, 格式为`{id, x, y, name, "id":id, "x":x, "y":y, "name":name, "miss":miss}`, 没找到或出错返回null, 使用方法请看示例</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFindStrYouTu');">复制代码</div>
                <pre id="codeFindStrYouTu">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

If zm.OcrYouTuInit("请修改成你的AppID", "请修改成你的AppKey") Then
  TracePrint "设置优图AI识别成功"
Else
  TracePrint "设置优图AI识别失败"
End If

Dim ret

//--------------------初级用法--------------------//
//默认全屏查找"紫猫学院"这4个字, 任何颜色都可以
ret = zm.FindStrYouTu("紫猫学院")
If ret Then
    TracePrint "可以用以下3种格式获取返回值"
    TracePrint "找到序号" & ret(0), "x=" & ret(1), "y=" & ret(2), "文字=" & ret(3)
    TracePrint "找到序号" & ret[1], "x=" & ret[2], "y=" & ret[3], "文字=" & ret[4]
    TracePrint "找到序号" & ret["id"], "x=" & ret["x"], "y=" & ret["y"], "文字=" & ret["name"]
Else
    TracePrint "没有找到"
End If

//--------------------中级用法--------------------//
Dim 返回数组()
//参数返回值必须是任意数组的变量名, 注意括号写法
//范围省略默认为全屏, 若填写, 则4个数字必须全写
If zm.FindStrYouTu(100, 200, 300, 400, "紫猫学院", 返回数组) Then
    TracePrint "可以用以下3种格式获取返回值"
    TracePrint "找到序号=" & 返回数组(0), "x=" & 返回数组(1), "y=" & 返回数组(2), "文字=" & 返回数组(3)
    TracePrint "找到序号=" & 返回数组[1], "x=" & 返回数组[2], "y=" & 返回数组[3], "文字=" & 返回数组[4]
    TracePrint "找到序号=" & 返回数组["id"], "x=" & 返回数组["x"], "y=" & 返回数组["y"], "文字=" & 返回数组["name"]
Else
    TracePrint "没有找到"
End If

//--------------------高级用法--------------------//
//对象后面的可选参数全部可以打乱顺序任意填写或省略, 只要数据类型与格式正确即可
//这句代码意思如下:
//在范围(100,200,300,400)里, 限时30000毫秒内循环查找("紫猫|学院")
//找到任何一个后退出循环查找, 然后点击找到的坐标(True), 并将找到的序号与坐标结果保存到数组变量(ret)与(返回数组)中
//同时开启日志的输出("显示")功能, 在当前脚本第("_40")行输出备注("@怪物1"), 查找结果与其他参数信息
ret = zm.FindStrYouTu(100, 200, 300, 400, "紫猫|学院", 30*1000, True, "显示", "@怪物1", 返回数组, "_40")
If ret Then
    TracePrint "找到了"
Else
    TracePrint "没有找到"
End If

//--------------------对象用法--------------------//
//可以把所有参数放到一个表中, 可选参数一样可以打乱顺序任意填写或省略
//对象参数必须填写在第一个参数位置
Dim 史莱姆 = {"紫猫|学院", True, "显示", "@攻击史莱姆", 返回数组, "_36"}
zm.FindStrYouTu 史莱姆

//--------------------修改默认值--------------------//
Dim IXYs()
//设置默认参数返回值IXYs, 若命令不填写参数返回值, 则默认保存在该变量中
//设置默认日志输出为显示状态, 后面所有 zm.FindStrYouTu() 都默认输出调试信息
//更多修改默认设置详见 zm.SetFindStr() 命令帮助
zm.SetFindStr {"ret":IXYs, "showlog":"显示"}
If zm.FindStrYouTu("喵星人") Then
    TracePrint "可以用以下3种格式获取返回值"
    TracePrint "找到序号" & IXYs(0), "x=" & IXYs(1), "y=" & IXYs(2), "文字=" & IXYs(3)
    TracePrint "找到序号" & IXYs[1], "x=" & IXYs[2], "y=" & IXYs[3], "文字=" & IXYs[4]
    TracePrint "找到序号" & IXYs["id"], "x=" & IXYs["x"], "y=" & IXYs["y"], "文字=" & IXYs["name"]
Else
    TracePrint "没有找到"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用腾讯优图OCR的识别功能, 与百度云识别相比, 目前优图OCR完全免费使用<br>
本命令只适合正常屏幕方向使用, 横屏情况推荐使用 <a href="https://zimaoxy.com/m/post/zm.findstrbaidu/" target="_blank">zm.findstrbaidu</a> <br>
获取优图AppID和AppKey的步骤:<br>
  前往[腾讯AI官网](https://ai.qq.com/)注册并登录<br>
  打开[控制台](https://ai.qq.com/cgi-bin/console_overview)<br>
  点击创建应用, 并输入相关资料, 记得勾选全部OCR接口<br>
  查看刚刚创建的应用, 就可以查到AppID和AppKey<br>
V3.1839: 加入命令<br>
V3.1849: 支持超级缩放</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="OcrBaiDu" id="OcrBaiDu"> <a href="https://zimaoxy.com/m/post/zm.ocrbaidu/" target="_blank">zm.OcrBaiDu 百度云通用文字识别</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>无需制作字库, 使用百度云实现在线云识别文字, 支持范围识别、本地图片或URL链接图片识别, 请先调用  <a href="https://zimaoxy.com/m/post/zm.ocrbaiduinit/" target="_blank">zm.ocrbaiduinit</a>  设置后才使用本命令</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.OcrBaiDu([x1, y1, x2, y2][, 图片路径][, 返回json])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">x1: 数值型, 可选, 识别范围的左上角x坐标, 与图片路径参数二选一<br>y1: 数值型, 可选, 识别范围的左上角y坐标, 与图片路径参数二选一<br>x2: 数值型, 可选, 识别范围的右下角x坐标, 与图片路径参数二选一<br>y2: 数值型, 可选, 识别范围的右下角y坐标, 与图片路径参数二选一<br>图片路径: 字符串, 可选, 要识别内容的图片本地路径或者URL图片链接, 暂不支持https链接, 与范围参数二选一<br>返回json: 表, 可选, 数组变量, 一般不建议填写, 以表的形式返回原生结果, 详见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)的返回说明部分</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 返回识别结果, 多个字符串以`\n`分割, 失败返回nil</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeOcrBaiDu');">复制代码</div>
                <pre id="codeOcrBaiDu">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim ret, t()

//例子1: 设置默认通用文字识别
If Not zm.OcrBaiDuInit("请修改成你的API Key", "请修改成你的Secret Key") Then
    TracePrint "初始化设置百度云识别失败"
    EndScript
End If
//全屏识别文字
ret = zm.OcrBaiDu(0, 0, 0, 0)
TracePrint "识别结果:", ret

//例子2: 设置通用文字识别（高精度版）
zm.OcrBaiDuInit "请修改成你的API Key", "请修改成你的Secret Key", "https://aip.baidubce.com/rest/2.0/ocr/v1/accurate_basic"
//本地图片识别文字
ret = zm.OcrBaiDu("/sdcard/紫猫.png")
TracePrint "识别结果:", ret

//例子3: 设置网络图片文字识别, 并开启检测图像朝向功能
Dim args = {"apikey":"请修改成你的API Key", "seckey":"请修改成你的Secret Key", "posturl":"https://aip.baidubce.com/rest/2.0/ocr/v1/webimage", "detect_direction":"true"}
zm.OcrBaiDuInit args
//URL图片链接识别文字并返回原生json
ret = zm.OcrBaiDu("http://bbs.anjian.com/templates/default/Images/logo1.png", t)
TracePrint "识别结果:", ret, "原生json:", zm.VarInfo(t)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用百度云的通用文字识别功能, 此命令的任何充值消费行为均与紫猫编程学院无关<br>
请自己注册帐号, 试用后再决定是否充值使用<br>
后台创建步骤:<br>
  前往[百度云AI官网](http://ai.baidu.com/)注册并登录<br>
  打开[文字识别控制台](https://console.bce.baidu.com/ai/#/ai/ocr/overview/index)<br>
  点击创建应用, 并输入应用名称与应用描述<br>
  查看刚刚创建的应用, 就可以查到API Key和Secret Key<br>
本命令通过修改  <a href="https://zimaoxy.com/m/post/zm.ocrbaiduinit/" target="_blank">zm.ocrbaiduinit</a>  的参数posturl, 实现支持通用文字识别(包括含位置信息版, 含生僻字版, 高精度版, 高精度含位置版, 网络图片文字识别)<br>
V1.1747: 加入命令<br>
V3.1849: 支持超级缩放</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="OcrBaiDuAll" id="OcrBaiDuAll"> <a href="https://zimaoxy.com/m/post/zm.ocrbaiduall/" target="_blank">zm.OcrBaiDuAll 百度云文字识别</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>百度云识别高级函数, 实现百度云文字识别的所有接口命令, 请求URL和请求参数请通过  <a href="https://zimaoxy.com/m/post/zm.ocrbaiduinit/" target="_blank">zm.ocrbaiduinit</a>  设置, 具体内容见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.OcrBaiDuAll([x1, y1, x2, y2][, 图片路径])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">x1: 数值型, 可选, 识别范围的左上角x坐标, 与图片路径参数二选一<br>y1: 数值型, 可选, 识别范围的左上角y坐标, 与图片路径参数二选一<br>x2: 数值型, 可选, 识别范围的右下角x坐标, 与图片路径参数二选一<br>y2: 数值型, 可选, 识别范围的右下角y坐标, 与图片路径参数二选一<br>图片路径: 字符串, 可选, 要识别内容的图片本地路径, 与范围参数二选一</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 返回识别结果, 格式与百度云文档中返回值相同, 详见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)的返回说明内容</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeOcrBaiDuAll');">复制代码</div>
                <pre id="codeOcrBaiDuAll">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim ret

//例子1: 设置身份证识别接口与参数, 请严格按照API文档中的请求URL与请求参数填写
//也可以使用zm.OcrBaiDuIDCard()身份证识别专用函数实现
Dim args = {"apikey":"请修改成你的API Key", "seckey":"请修改成你的Secret Key", "posturl":"https://aip.baidubce.com/rest/2.0/ocr/v1/idcard","id_card_side":"front"}
If zm.OcrBaiDuInit(args) Then
    TracePrint "初始化设置百度云识别失败"
    EndScript
End If
//使用一张本地的身份证正面照片
ret = zm.OcrBaiDuAll("/sdcard/sfz.png")
//返回值为原生json表, 故采用zm.VarInfo()查看, 具体请自行研究如何使用table表提取相关内容
TracePrint "识别结果:", zm.VarInfo(ret)

//例子2: 设置银行卡识别接口与参数, 请严格按照API文档中的请求URL与请求参数填写
zm.OcrBaiDuInit "请修改成你的API Key", "请修改成你的Secret Key", "https://aip.baidubce.com/rest/2.0/ocr/v1/bankcard"
//截图识别银行卡
ret = zm.OcrBaiDuAll(0,0,0,0)
//返回值为原生json表, 故采用zm.VarInfo()查看, 具体请自行研究如何使用table表提取相关内容
TracePrint "识别结果:", zm.VarInfo(ret)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用百度云的通用文字识别功能, 此命令的任何充值消费行为均与紫猫编程学院无关<br>
请自己注册帐号, 试用后再决定是否充值使用<br>
后台创建步骤:<br>
  前往[百度云AI官网](http://ai.baidu.com/)注册并登录<br>
  打开[文字识别控制台](https://console.bce.baidu.com/ai/#/ai/ocr/overview/index)<br>
  点击创建应用, 并输入应用名称与应用描述<br>
  查看刚刚创建的应用, 就可以查到API Key和Secret Key<br>
V1.1747: 加入命令<br>
V3.1849: 支持超级缩放</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="OcrBaiDuBankCard" id="OcrBaiDuBankCard"> <a href="https://zimaoxy.com/m/post/zm.ocrbaidubankcard/" target="_blank">zm.OcrBaiDuBankCard 百度云银行卡识别</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>识别银行卡并返回卡号和发卡行, 内置固定的请求URL, 除图片外的请求参数通过  <a href="https://zimaoxy.com/m/post/zm.ocrbaiduinit/" target="_blank">zm.ocrbaiduinit</a>  设置</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.OcrBaiDuBankCard([x1, y1, x2, y2][, 图片路径][, 返回json])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">x1: 数值型, 可选, 识别范围的左上角x坐标, 与图片路径参数二选一<br>y1: 数值型, 可选, 识别范围的左上角y坐标, 与图片路径参数二选一<br>x2: 数值型, 可选, 识别范围的右下角x坐标, 与图片路径参数二选一<br>y2: 数值型, 可选, 识别范围的右下角y坐标, 与图片路径参数二选一<br>图片路径: 字符串, 可选, 要识别内容的图片本地路径, 与范围参数二选一<br>返回json: 表, 可选, 数组变量, 一般不建议填写, 以表的形式返回原生结果, 详见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)的返回说明内容</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 返回优化后的识别结果, 格式为{"bank\_card\_number":"622500000000000","bank\_name":"招商银行","bank\_card\_type":1}, 失败返回nil</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeOcrBaiDuBankCard');">复制代码</div>
                <pre id="codeOcrBaiDuBankCard">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim ret, t()

//例子1: 设置key
If Not zm.OcrBaiDuInit("请修改成你的API Key", "请修改成你的Secret Key") Then
    TracePrint "初始化设置百度云识别失败"
    EndScript
End If
//全屏识别银行卡
ret = zm.OcrBaiDuBankCard(0, 0, 0, 0)
If ret then
    TracePrint "银行卡卡号:", ret["bank_card_number"]
    TracePrint "银行名:", ret["bank_name"]
    TracePrint "银行卡类型:", ret["bank_card_type"]
Else
    TracePrint "识别失败"
End If

//本地图片识别银行卡
ret = zm.OcrBaiDuBankCard("/sdcard/紫猫银行卡.png", t)
TracePrint "识别结果:", zm.VarInfo(ret)
TracePrint "原生返回值:", zm.VarInfo(t)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用百度云的通用文字识别功能, 此命令的任何充值消费行为均与紫猫编程学院无关<br>
请自己注册帐号, 试用后再决定是否充值使用<br>
后台创建步骤:<br>
  前往[百度云AI官网](http://ai.baidu.com/)注册并登录<br>
  打开[文字识别控制台](https://console.bce.baidu.com/ai/#/ai/ocr/overview/index)<br>
  点击创建应用, 并输入应用名称与应用描述<br>
  查看刚刚创建的应用, 就可以查到API Key和Secret Key<br>
V1.1747: 加入命令<br>
V3.1849: 支持超级缩放</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="OcrBaiDuBusiness" id="OcrBaiDuBusiness"> <a href="https://zimaoxy.com/m/post/zm.ocrbaidubusiness/" target="_blank">zm.OcrBaiDuBusiness 百度云营业执照识别</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>识别营业执照, 并返回关键字段的值, 包括单位名称/法人/地址/有效期/证件编号/社会信用代码等, 内置固定的请求URL</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.OcrBaiDuBusiness([x1, y1, x2, y2][, 图片路径][, 返回json])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">x1: 数值型, 可选, 识别范围的左上角x坐标, 与图片路径参数二选一<br>y1: 数值型, 可选, 识别范围的左上角y坐标, 与图片路径参数二选一<br>x2: 数值型, 可选, 识别范围的右下角x坐标, 与图片路径参数二选一<br>y2: 数值型, 可选, 识别范围的右下角y坐标, 与图片路径参数二选一<br>图片路径: 字符串, 可选, 要识别内容的图片本地路径, 与范围参数二选一<br>返回json: 表, 可选, 数组变量, 一般不建议填写, 以表的形式返回原生结果, 详见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)的返回说明内容</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 返回优化后的识别结果, 格式类似于{"单位名称":"紫猫编程学院","法人":"紫猫", ...}, 详细请自行遍历查看, 失败返回nil</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeOcrBaiDuBusiness');">复制代码</div>
                <pre id="codeOcrBaiDuBusiness">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim ret, t()

//例子1: 设置key
If Not zm.OcrBaiDuInit("请修改成你的API Key", "请修改成你的Secret Key") Then
    TracePrint "初始化设置百度云识别失败"
    EndScript
End If
//全屏识别营业执照
ret = zm.OcrBaiDuBusiness(0, 0, 0, 0)
If ret then
    TracePrint "单位名称:", ret["单位名称"]
    TracePrint "法人:", ret["法人"]
    //更多输出请自行遍历
Else
    TracePrint "识别失败"
End If

//本地图片识别营业执照
ret = zm.OcrBaiDuBusiness("/sdcard/紫猫营业执照.png", t)
TracePrint "识别结果:", zm.VarInfo(ret)
TracePrint "原生返回值:", zm.VarInfo(t)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用百度云的通用文字识别功能, 此命令的任何充值消费行为均与紫猫编程学院无关<br>
请自己注册帐号, 试用后再决定是否充值使用<br>
后台创建步骤:<br>
  前往[百度云AI官网](http://ai.baidu.com/)注册并登录<br>
  打开[文字识别控制台](https://console.bce.baidu.com/ai/#/ai/ocr/overview/index)<br>
  点击创建应用, 并输入应用名称与应用描述<br>
  查看刚刚创建的应用, 就可以查到API Key和Secret Key<br>
V1.1747: 加入命令<br>
V3.1849: 支持超级缩放</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="OcrBaiDuDriving" id="OcrBaiDuDriving"> <a href="https://zimaoxy.com/m/post/zm.ocrbaidudriving/" target="_blank">zm.OcrBaiDuDriving 百度云驾驶证识别</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>对机动车驾驶证所有关键字段进行识别, 内置固定的请求URL, 除图片外的请求参数通过  <a href="https://zimaoxy.com/m/post/zm.ocrbaiduinit/" target="_blank">zm.ocrbaiduinit</a>  设置, 具体内容见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.OcrBaiDuDriving([x1, y1, x2, y2][, 图片路径][, 返回json])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">x1: 数值型, 可选, 识别范围的左上角x坐标, 与图片路径参数二选一<br>y1: 数值型, 可选, 识别范围的左上角y坐标, 与图片路径参数二选一<br>x2: 数值型, 可选, 识别范围的右下角x坐标, 与图片路径参数二选一<br>y2: 数值型, 可选, 识别范围的右下角y坐标, 与图片路径参数二选一<br>图片路径: 字符串, 可选, 要识别内容的图片本地路径, 与范围参数二选一<br>返回json: 表, 可选, 数组变量, 一般不建议填写, 以表的形式返回原生结果, 详见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)的返回说明内容</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 返回优化后的识别结果, 格式类似于{"证号":"345911220","姓名":"紫猫", ...}, 详细请自行遍历查看, 失败返回nil</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeOcrBaiDuDriving');">复制代码</div>
                <pre id="codeOcrBaiDuDriving">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim ret, t()

//例子1: 设置key
If Not zm.OcrBaiDuInit("请修改成你的API Key", "请修改成你的Secret Key") Then
    TracePrint "初始化设置百度云识别失败"
    EndScript
End If
//全屏识别驾驶证
ret = zm.OcrBaiDuDriving(0, 0, 0, 0)
If ret then
    TracePrint "姓名:", ret["姓名"]
    TracePrint "证件号:", ret["证件号"]
    //更多输出请自行遍历
Else
    TracePrint "识别失败"
End If

//例子2: 在例子1的基础上, 增加开启检测朝向功能
Dim args = {"detect_direction":"true"}
zm.OcrBaiDuInit args
//本地图片识别驾驶证
ret = zm.OcrBaiDuDriving("/sdcard/紫猫驾驶证.png", t)
TracePrint "识别结果:", zm.VarInfo(ret)
TracePrint "原生返回值:", zm.VarInfo(t)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用百度云的通用文字识别功能, 此命令的任何充值消费行为均与紫猫编程学院无关<br>
请自己注册帐号, 试用后再决定是否充值使用<br>
后台创建步骤:<br>
  前往[百度云AI官网](http://ai.baidu.com/)注册并登录<br>
  打开[文字识别控制台](https://console.bce.baidu.com/ai/#/ai/ocr/overview/index)<br>
  点击创建应用, 并输入应用名称与应用描述<br>
  查看刚刚创建的应用, 就可以查到API Key和Secret Key<br>
本命令通过修改  <a href="https://zimaoxy.com/m/post/zm.ocrbaiduinit/" target="_blank">zm.ocrbaiduinit</a>  的请求参数, 实现更多功能, 详见详见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)的请求说明内容<br>
V1.1747: 加入命令<br>
V3.1849: 支持超级缩放</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="OcrBaiDuForm" id="OcrBaiDuForm"> <a href="https://zimaoxy.com/m/post/zm.ocrbaiduform/" target="_blank">zm.OcrBaiDuForm 百度云表格文字识别</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>已整合为同步请求, 自动识别表格线及表格内容, 结构化输出表头, 表尾及每个单元格的文字内容, 内置固定的请求URL, 除图片外的请求参数通过  <a href="https://zimaoxy.com/m/post/zm.ocrbaiduinit/" target="_blank">zm.ocrbaiduinit</a>  设置, 具体内容见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.OcrBaiDuForm([x1, y1, x2, y2][, 图片路径][, 返回json])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">x1: 数值型, 可选, 识别范围的左上角x坐标, 与图片路径参数二选一<br>y1: 数值型, 可选, 识别范围的左上角y坐标, 与图片路径参数二选一<br>x2: 数值型, 可选, 识别范围的右下角x坐标, 与图片路径参数二选一<br>y2: 数值型, 可选, 识别范围的右下角y坐标, 与图片路径参数二选一<br>图片路径: 字符串, 可选, 要识别内容的图片本地路径, 与范围参数二选一<br>返回json: 表, 可选, 数组变量, 一般不建议填写, 以表的形式返回原生结果, 详见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)的返回说明内容</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 返回表格下载地址或json文本, 失败返回nil</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeOcrBaiDuForm');">复制代码</div>
                <pre id="codeOcrBaiDuForm">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim ret, t()

//例子1: 设置key
If Not zm.OcrBaiDuInit("请修改成你的API Key", "请修改成你的Secret Key") Then
    TracePrint "初始化设置百度云识别失败"
    EndScript
End If
//全屏识别表格文字
ret = zm.OcrBaiDuForm(0, 0, 0, 0)
If ret then
    TracePrint "默认excel表格下载地址", ret
    //更多输出请自行遍历
Else
    TracePrint "识别失败"
End If

//例子2: 在例子1的基础上, 加入设置返回json文本
Dim args = {"result_type":"json"}
zm.OcrBaiDuInit args
//本地图片识别表格文字
ret = zm.OcrBaiDuForm("/sdcard/紫猫表格.png", t)
TracePrint "识别结果:", zm.VarInfo(ret)
TracePrint "原生返回值:", zm.VarInfo(t)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用百度云的通用文字识别功能, 此命令的任何充值消费行为均与紫猫编程学院无关<br>
请自己注册帐号, 试用后再决定是否充值使用<br>
后台创建步骤:<br>
  前往[百度云AI官网](http://ai.baidu.com/)注册并登录<br>
  打开[文字识别控制台](https://console.bce.baidu.com/ai/#/ai/ocr/overview/index)<br>
  点击创建应用, 并输入应用名称与应用描述<br>
  查看刚刚创建的应用, 就可以查到API Key和Secret Key<br>
本命令通过修改  <a href="https://zimaoxy.com/m/post/zm.ocrbaiduinit/" target="_blank">zm.ocrbaiduinit</a>  的请求参数, 实现更多功能, 详见详见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)的请求说明内容<br>
V1.1747: 加入命令<br>
V3.1849: 支持超级缩放</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="OcrBaiDuHandWriting" id="OcrBaiDuHandWriting"> <a href="https://zimaoxy.com/m/post/zm.ocrbaiduhandwriting/" target="_blank">zm.OcrBaiDuHandWriting 百度云手写识别</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>识别屏幕上的手写文字, 内置固定的请求URL, 除图片参数外的请求参数通过  <a href="https://zimaoxy.com/m/post/zm.ocrbaiduinit/" target="_blank">zm.ocrbaiduinit</a>  设置, 具体内容见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.OcrBaiDuHandWriting([x1, y1, x2, y2][图片路径][, 返回json])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">x1: 数值型, 可选, 识别范围的左上角x坐标, 与图片路径参数二选一<br>y1: 数值型, 可选, 识别范围的左上角y坐标, 与图片路径参数二选一<br>x2: 数值型, 可选, 识别范围的右下角x坐标, 与图片路径参数二选一<br>y2: 数值型, 可选, 识别范围的右下角y坐标, 与图片路径参数二选一<br>图片路径: 字符串, 可选, 要识别内容的图片本地路径, 与范围参数二选一<br>返回json: 表, 可选, 数组变量, 一般不建议填写, 以表的形式返回原生结果, 详见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)的返回说明内容</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 返回屏幕上的文字内容, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeOcrBaiDuHandWriting');">复制代码</div>
                <pre id="codeOcrBaiDuHandWriting">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

If Not zm.OcrBaiDuInit("请修改成你的API Key", "请修改成你的Secret Key") Then
    TracePrint "初始化设置百度云识别失败"
    EndScript
End If

//全屏识别文字
ret = zm.OcrBaiDuHandWriting(0, 0, 0, 0)
If ret then
    TracePrint "手写文字", ret
Else
    TracePrint "识别失败"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用百度云的手写文字识别功能, 此命令的任何充值消费行为均与紫猫编程学院无关<br>
请自己注册帐号, 试用后再决定是否充值使用<br>
后台创建步骤:<br>
  前往[百度云AI官网](http://ai.baidu.com/)注册并登录<br>
  打开[文字识别控制台](https://console.bce.baidu.com/ai/#/ai/ocr/overview/index)<br>
  点击创建应用, 并输入应用名称与应用描述<br>
  查看刚刚创建的应用, 就可以查到API Key和Secret Key<br>
本命令通过修改  <a href="https://zimaoxy.com/m/post/zm.ocrbaiduinit/" target="_blank">zm.ocrbaiduinit</a>  的请求参数, 实现更多功能, 详见详见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)的请求说明内容<br>
V3.1839: 加入命令<br>
V3.1849: 支持超级缩放<br>
V3.1929: 修复错误函数名</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="OcrBaiDuIDCard" id="OcrBaiDuIDCard"> <a href="https://zimaoxy.com/m/post/zm.ocrbaiduidcard/" target="_blank">zm.OcrBaiDuIDCard 百度云身份证识别</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>识别身份证正背面, 内置固定的请求URL, 除图片和正背面id\_card\_side参数外的请求参数通过  <a href="https://zimaoxy.com/m/post/zm.ocrbaiduinit/" target="_blank">zm.ocrbaiduinit</a>  设置, 具体内容见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.OcrBaiDuIDCard(正背面, [x1, y1, x2, y2][, 图片路径][, 返回json])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">正背面: 字符串, 必选, 身份证照片的正背面, 正面照片填写`"正面"`或`"front"`, 背面照片填写`"背面"`或`"back"`<br>x1: 数值型, 可选, 识别范围的左上角x坐标, 与图片路径参数二选一<br>y1: 数值型, 可选, 识别范围的左上角y坐标, 与图片路径参数二选一<br>x2: 数值型, 可选, 识别范围的右下角x坐标, 与图片路径参数二选一<br>y2: 数值型, 可选, 识别范围的右下角y坐标, 与图片路径参数二选一<br>图片路径: 字符串, 可选, 要识别内容的图片本地路径, 与范围参数二选一<br>返回json: 表, 可选, 数组变量, 一般不建议填写, 以表的形式返回原生结果, 详见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)的返回说明内容</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 返回优化后的识别结果, 格式类似于{"公民身份号码":"345911220","姓名":"紫猫", ...}, 详细请自行遍历查看, 失败返回nil</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeOcrBaiDuIDCard');">复制代码</div>
                <pre id="codeOcrBaiDuIDCard">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim ret, t()

//例子1: 设置key
If Not zm.OcrBaiDuInit("请修改成你的API Key", "请修改成你的Secret Key") Then
    TracePrint "初始化设置百度云识别失败"
    EndScript
End If
//全屏识别身份证
ret = zm.OcrBaiDuIDCard("正面", 0, 0, 0, 0)
If ret then
    TracePrint "姓名:", ret["姓名"]
    TracePrint "公民身份号码:", ret["证件号"]
    //更多输出请自行遍历
Else
    TracePrint "识别失败"
End If

//例子2: 在例子1的基础上, 增加开启检测朝向功能
Dim args = {"detect_direction":"true"}
zm.OcrBaiDuInit args
//本地图片识别身份证
ret = zm.OcrBaiDuIDCard("back", "/sdcard/紫猫身份证.png", t)
TracePrint "识别结果:", zm.VarInfo(ret)
TracePrint "原生返回值:", zm.VarInfo(t)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用百度云的通用文字识别功能, 此命令的任何充值消费行为均与紫猫编程学院无关<br>
请自己注册帐号, 试用后再决定是否充值使用<br>
后台创建步骤:<br>
  前往[百度云AI官网](http://ai.baidu.com/)注册并登录<br>
  打开[文字识别控制台](https://console.bce.baidu.com/ai/#/ai/ocr/overview/index)<br>
  点击创建应用, 并输入应用名称与应用描述<br>
  查看刚刚创建的应用, 就可以查到API Key和Secret Key<br>
本命令通过修改  <a href="https://zimaoxy.com/m/post/zm.ocrbaiduinit/" target="_blank">zm.ocrbaiduinit</a>  的请求参数, 实现更多功能, 详见详见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)的请求说明内容<br>
V1.1747: 加入命令<br>
V3.1849: 支持超级缩放</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="OcrBaiDuInit" id="OcrBaiDuInit"> <a href="https://zimaoxy.com/m/post/zm.ocrbaiduinit/" target="_blank">zm.OcrBaiDuInit 设置百度云文字识别</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>初始化设置百度云文字识别key和请求参数, 一般只要调用一次, 除非需要用不同的识别模式与参数, 账户注册详见最下方的备注</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.OcrBaiDuInit([高级属性, ][apikey, seckey][, 图片朝向][, posturl])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">高级属性: 表, 可选, 高级参数, 一般不需要填写, 以table类型详细设置每个参数, 若填写本参数, 则将忽略其他参数, 详见 http://ai.baidu.com/docs#/OCR-API/top 中的请求参数, 其中请求URL的键名为posturl<br>apikey: 字符串, 可选, 百度云文字识别控制台创建的API Key, 详见最下面的备注<br>seckey: 字符串, 可选, 百度云文字识别控制台创建的Secret Key, 详见最下面的备注<br>图片朝向: 布尔值, 可选, 是否开启检测图像朝向功能功能, 省略默认为true<br>posturl: 字符串, 可选, 百度云文字识别的请求URL, 用于不同模式的识别, 省略默认为`https://aip.baidubce.com/rest/2.0/ocr/v1/general_basic`</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 返回设置后的参数列表, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeOcrBaiDuInit');">复制代码</div>
                <pre id="codeOcrBaiDuInit">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//例子1: 设置默认通用文字识别
Dim r = zm.OcrBaiDuInit("请修改成你的API Key", "请修改成你的Secret Key")
zm.TracePrint(r) //查看返回值

//例子2: 设置通用文字识别（高精度版）
zm.OcrBaiDuInit "请修改成你的API Key", "请修改成你的Secret Key", "https://aip.baidubce.com/rest/2.0/ocr/v1/accurate_basic"

//例子3: 通过高级属性设置默认通用文字识别, 并开启检测图像朝向功能
Dim args = {"apikey":"请修改成你的API Key", "seckey":"请修改成你的Secret Key", "posturl":"https://aip.baidubce.com/rest/2.0/ocr/v1/general_basic", "detect_direction":"true"}
If zm.OcrBaiDuInit(args) Then
  TracePrint "设置百度云识别成功"
Else
  TracePrint "设置百度云识别失败"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用百度云的通用文字识别功能, 此命令的任何充值消费行为均与紫猫编程学院无关<br>
请自己注册帐号, 试用后再决定是否充值使用<br>
后台创建步骤:<br>
  前往[百度云AI官网](http://ai.baidu.com/)注册并登录<br>
  打开[文字识别控制台](https://console.bce.baidu.com/ai/#/ai/ocr/overview/index)<br>
  点击创建应用, 并输入应用名称与应用描述<br>
  查看刚刚创建的应用, 就可以查到API Key和Secret Key<br>
  百度云识别的[API接口文档](https://ai.baidu.com/docs#/OCR-API/top)<br>
本命令通过修改请求URL参数posturl与相关请求参数, 实现支持文字识别的所有功能<br>
V1.1747: 加入命令<br>
V2.1829: 加入图像朝向检测参数<br>
V3.1832: 为统一命令格式, `zm.SetOcrBaidu()`改为`zm.OcrBaiduInit()`<br>
V3.1839: 检测图像朝向功能默认为启用状态</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="OcrBaiDuNumbers" id="OcrBaiDuNumbers"> <a href="https://zimaoxy.com/m/post/zm.ocrbaidunumbers/" target="_blank">zm.OcrBaiDuNumbers 百度云数字识别</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>识别屏幕上的数字, 返回字符串数据类型, 内置固定的请求URL, 除图片参数外的请求参数通过  <a href="https://zimaoxy.com/m/post/zm.ocrbaiduinit/" target="_blank">zm.ocrbaiduinit</a>  设置, 具体内容见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.OcrBaiDuNumbers([x1, y1, x2, y2][图片路径][, 返回json])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">x1: 数值型, 可选, 识别范围的左上角x坐标, 与图片路径参数二选一<br>y1: 数值型, 可选, 识别范围的左上角y坐标, 与图片路径参数二选一<br>x2: 数值型, 可选, 识别范围的右下角x坐标, 与图片路径参数二选一<br>y2: 数值型, 可选, 识别范围的右下角y坐标, 与图片路径参数二选一<br>图片路径: 字符串, 可选, 要识别内容的图片本地路径, 与范围参数二选一<br>返回json: 表, 可选, 数组变量, 一般不建议填写, 以表的形式返回原生结果, 详见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)的返回说明内容</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 返回屏幕上的数字内容, 注意数据类型是字符串格式, 做大小比较请用`CDbl`之类的函数转换数值型</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeOcrBaiDuNumbers');">复制代码</div>
                <pre id="codeOcrBaiDuNumbers">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

If Not zm.OcrBaiDuInit("请修改成你的API Key", "请修改成你的Secret Key") Then
    TracePrint "初始化设置百度云识别失败"
    EndScript
End If

//全屏识别数字
ret = zm.OcrBaiDuNumbers(0, 0, 0, 0)
If ret then
    TracePrint "数字", ret
Else
    TracePrint "识别失败"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用百度云的数字识别功能, 此命令的任何充值消费行为均与紫猫编程学院无关<br>
请自己注册帐号, 试用后再决定是否充值使用<br>
后台创建步骤:<br>
  前往[百度云AI官网](http://ai.baidu.com/)注册并登录<br>
  打开[文字识别控制台](https://console.bce.baidu.com/ai/#/ai/ocr/overview/index)<br>
  点击创建应用, 并输入应用名称与应用描述<br>
  查看刚刚创建的应用, 就可以查到API Key和Secret Key<br>
本命令通过修改  <a href="https://zimaoxy.com/m/post/zm.ocrbaiduinit/" target="_blank">zm.ocrbaiduinit</a>  的请求参数, 实现更多功能, 详见详见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)的请求说明内容<br>
V3.1839: 加入命令<br>
V3.1849: 支持超级缩放</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="OcrBaiDuPlate" id="OcrBaiDuPlate"> <a href="https://zimaoxy.com/m/post/zm.ocrbaiduplate/" target="_blank">zm.OcrBaiDuPlate 百度云车牌识别</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>识别机动车车牌, 并返回签发地和号牌, 内置固定的请求URL, 除图片参数外的请求参数通过  <a href="https://zimaoxy.com/m/post/zm.ocrbaiduinit/" target="_blank">zm.ocrbaiduinit</a>  设置, 具体内容见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.OcrBaiDuPlate([x1, y1, x2, y2][, 图片路径][, 返回json])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">x1: 数值型, 可选, 识别范围的左上角x坐标, 与图片路径参数二选一<br>y1: 数值型, 可选, 识别范围的左上角y坐标, 与图片路径参数二选一<br>x2: 数值型, 可选, 识别范围的右下角x坐标, 与图片路径参数二选一<br>y2: 数值型, 可选, 识别范围的右下角y坐标, 与图片路径参数二选一<br>图片路径: 字符串, 可选, 要识别内容的图片本地路径, 与范围参数二选一<br>返回json: 表, 可选, 数组变量, 一般不建议填写, 以表的形式返回原生结果, 详见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)的返回说明内容</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数组_ , 返回优化后的识别结果, 格式类似于{"鄂A345911220", ...}, 详细请自行遍历查看, 失败返回nil</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeOcrBaiDuPlate');">复制代码</div>
                <pre id="codeOcrBaiDuPlate">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim ret, t()

//例子1: 设置key
If Not zm.OcrBaiDuInit("请修改成你的API Key", "请修改成你的Secret Key") Then
    TracePrint "初始化设置百度云识别失败"
    EndScript
End If
//全屏识别一张车牌
ret = zm.OcrBaiDuPlate(0, 0, 0, 0)
If ret then
    TracePrint "车牌号", ret(0)
Else
    TracePrint "识别失败"
End If

//例子2: 在例子1的基础上, 增加开启多张车牌检测功能
Dim args = {"multi_detect":"true"}
zm.OcrBaiDuInit args
//本地图片识别多张车牌
ret = zm.OcrBaiDuPlate("/sdcard/紫猫车牌.png", t)
TracePrint "识别结果:", zm.VarInfo(ret)
TracePrint "原生返回值:", zm.VarInfo(t)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用百度云的通用文字识别功能, 此命令的任何充值消费行为均与紫猫编程学院无关<br>
请自己注册帐号, 试用后再决定是否充值使用<br>
后台创建步骤:<br>
  前往[百度云AI官网](http://ai.baidu.com/)注册并登录<br>
  打开[文字识别控制台](https://console.bce.baidu.com/ai/#/ai/ocr/overview/index)<br>
  点击创建应用, 并输入应用名称与应用描述<br>
  查看刚刚创建的应用, 就可以查到API Key和Secret Key<br>
本命令通过修改  <a href="https://zimaoxy.com/m/post/zm.ocrbaiduinit/" target="_blank">zm.ocrbaiduinit</a>  的请求参数, 实现更多功能, 详见详见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)的请求说明内容<br>
V1.1747: 加入命令<br>
V3.1849: 支持超级缩放</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="OcrBaiDuQRCode" id="OcrBaiDuQRCode"> <a href="https://zimaoxy.com/m/post/zm.ocrbaiduqrcode/" target="_blank">zm.OcrBaiDuQRCode 百度云二维码识别</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>对图片中的二维码, 条形码进行检测和识别, 请先调用  <a href="https://zimaoxy.com/m/post/zm.ocrbaiduinit/" target="_blank">zm.ocrbaiduinit</a>  设置后才使用本命令</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.OcrBaiDuQRCode([x1, y1, x2, y2][, 图片路径][, 返回json])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">x1: 数值型, 可选, 识别范围的左上角x坐标, 与图片路径参数二选一<br>y1: 数值型, 可选, 识别范围的左上角y坐标, 与图片路径参数二选一<br>x2: 数值型, 可选, 识别范围的右下角x坐标, 与图片路径参数二选一<br>y2: 数值型, 可选, 识别范围的右下角y坐标, 与图片路径参数二选一<br>图片路径: 字符串, 可选, 要识别二维码的图片本地路径, 与范围参数二选一<br>返回json: 表, 可选, 数组变量, 一般不建议填写, 以表的形式返回原生结果, 详见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)的返回说明内容</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ 或 _表_ , 单个二维码返回字符串, 多个二维码返回数组.</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeOcrBaiDuQRCode');">复制代码</div>
                <pre id="codeOcrBaiDuQRCode">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

If Not zm.OcrBaiDuInit("请修改成你的API Key", "请修改成你的Secret Key") Then
    TracePrint "初始化设置百度云识别失败"
    EndScript
End If

//识别单个二维码
ret = zm.OcrBaiDuQRCode("/sdcard/二维码.png")
If ret then
    TracePrint "二维码内容为: ", ret
Else
    TracePrint "识别失败"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用百度云的通用文字识别功能, 此命令的任何充值消费行为均与紫猫编程学院无关<br>
请自己注册帐号, 试用后再决定是否充值使用<br>
后台创建步骤:<br>
  前往[百度云AI官网](http://ai.baidu.com/)注册并登录<br>
  打开[文字识别控制台](https://console.bce.baidu.com/ai/#/ai/ocr/overview/index)<br>
  点击创建应用, 并输入应用名称与应用描述<br>
  查看刚刚创建的应用, 就可以查到API Key和Secret Key<br>
本命令通过修改  <a href="https://zimaoxy.com/m/post/zm.ocrbaiduinit/" target="_blank">zm.ocrbaiduinit</a>  的请求参数, 实现更多功能, 详见详见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)的请求说明内容<br>
V4.2016: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="OcrBaiDuReceipt" id="OcrBaiDuReceipt"> <a href="https://zimaoxy.com/m/post/zm.ocrbaidureceipt/" target="_blank">zm.OcrBaiDuReceipt 百度云通用票据识别</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>识别医疗票据/发票/的士票/保险保单等票据类图片中的所有文字, 内置固定的请求URL, 除图片参数外的请求参数通过  <a href="https://zimaoxy.com/m/post/zm.ocrbaiduinit/" target="_blank">zm.ocrbaiduinit</a>  设置, 具体内容见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.OcrBaiDuReceipt([x1, y1, x2, y2][, 图片路径][, 返回json])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">x1: 数值型, 可选, 识别范围的左上角x坐标, 与图片路径参数二选一<br>y1: 数值型, 可选, 识别范围的左上角y坐标, 与图片路径参数二选一<br>x2: 数值型, 可选, 识别范围的右下角x坐标, 与图片路径参数二选一<br>y2: 数值型, 可选, 识别范围的右下角y坐标, 与图片路径参数二选一<br>图片路径: 字符串, 可选, 要识别内容的图片本地路径, 与范围参数二选一<br>返回json: 表, 可选, 数组变量, 一般不建议填写, 以表的形式返回原生结果, 详见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)的返回说明内容</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数组_ , 返回优化后的识别结果, 格式类似于{"345911220","紫猫", ...}, 详细请自行遍历查看, 失败返回nil</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeOcrBaiDuReceipt');">复制代码</div>
                <pre id="codeOcrBaiDuReceipt">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim ret, t()

//例子1: 设置key
If Not zm.OcrBaiDuInit("请修改成你的API Key", "请修改成你的Secret Key") Then
    TracePrint "初始化设置百度云识别失败"
    EndScript
End If
//全屏识别发票
ret = zm.OcrBaiDuReceipt(0, 0, 0, 0)
If ret then
    For i = 0 to UBound(ret)
        TracePrint ret(i)
    Next
    //更多输出请自行遍历
Else
    TracePrint "识别失败"
End If

//例子2: 在例子1的基础上, 增加开启检测朝向功能
Dim args = {"detect_direction":"true"}
zm.OcrBaiDuInit args
//本地图片识别的士票
ret = zm.OcrBaiDuReceipt("/sdcard/紫猫的士票.png", t)
TracePrint "识别结果:", zm.VarInfo(ret)
TracePrint "原生返回值:", zm.VarInfo(t)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用百度云的通用文字识别功能, 此命令的任何充值消费行为均与紫猫编程学院无关<br>
请自己注册帐号, 试用后再决定是否充值使用<br>
后台创建步骤:<br>
  前往[百度云AI官网](http://ai.baidu.com/)注册并登录<br>
  打开[文字识别控制台](https://console.bce.baidu.com/ai/#/ai/ocr/overview/index)<br>
  点击创建应用, 并输入应用名称与应用描述<br>
  查看刚刚创建的应用, 就可以查到API Key和Secret Key<br>
本命令通过修改  <a href="https://zimaoxy.com/m/post/zm.ocrbaiduinit/" target="_blank">zm.ocrbaiduinit</a>  的请求参数, 实现更多功能, 详见详见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)的请求说明内容<br>
V1.1747: 加入命令<br>
V3.1849: 支持超级缩放</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="OcrBaiDuVehicle" id="OcrBaiDuVehicle"> <a href="https://zimaoxy.com/m/post/zm.ocrbaiduvehicle/" target="_blank">zm.OcrBaiDuVehicle 百度云行驶证识别</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>对机动车行驶证正本所有关键字段进行识别, 内置固定的请求URL, 除图片参数外的请求参数通过  <a href="https://zimaoxy.com/m/post/zm.ocrbaiduinit/" target="_blank">zm.ocrbaiduinit</a>  设置, 具体内容见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.OcrBaiDuVehicle(正背面, [x1, y1, x2, y2][, 图片路径][, 返回json])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">x1: 数值型, 可选, 识别范围的左上角x坐标, 与图片路径参数二选一<br>y1: 数值型, 可选, 识别范围的左上角y坐标, 与图片路径参数二选一<br>x2: 数值型, 可选, 识别范围的右下角x坐标, 与图片路径参数二选一<br>y2: 数值型, 可选, 识别范围的右下角y坐标, 与图片路径参数二选一<br>图片路径: 字符串, 可选, 要识别内容的图片本地路径, 与范围参数二选一<br>返回json: 表, 可选, 数组变量, 一般不建议填写, 以表的形式返回原生结果, 详见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)的返回说明内容</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 返回优化后的识别结果, 格式类似于{"品牌型号":"保时捷GT37182RUCRE","所有人":"紫猫", ...}, 详细请自行遍历查看, 失败返回nil</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeOcrBaiDuVehicle');">复制代码</div>
                <pre id="codeOcrBaiDuVehicle">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim ret, t()

//例子1: 设置key
If Not zm.OcrBaiDuInit("请修改成你的API Key", "请修改成你的Secret Key") Then
    TracePrint "初始化设置百度云识别失败"
    EndScript
End If
//全屏识别行驶证
ret = zm.OcrBaiDuVehicle(0, 0, 0, 0)
If ret then
    TracePrint "所有人:", ret["所有人"]
    TracePrint "品牌型号:", ret["品牌型号"]
    //更多输出请自行遍历
Else
    TracePrint "识别失败"
End If

//例子2: 在例子1的基础上, 增加开启检测朝向功能
Dim args = {"detect_direction":"true"}
zm.OcrBaiDuInit args
//本地图片识别行驶证
ret = zm.OcrBaiDuVehicle("back", "/sdcard/紫猫行驶证.png", t)
TracePrint "识别结果:", zm.VarInfo(ret)
TracePrint "原生返回值:", zm.VarInfo(t)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用百度云的通用文字识别功能, 此命令的任何充值消费行为均与紫猫编程学院无关<br>
请自己注册帐号, 试用后再决定是否充值使用<br>
后台创建步骤:<br>
  前往[百度云AI官网](http://ai.baidu.com/)注册并登录<br>
  打开[文字识别控制台](https://console.bce.baidu.com/ai/#/ai/ocr/overview/index)<br>
  点击创建应用, 并输入应用名称与应用描述<br>
  查看刚刚创建的应用, 就可以查到API Key和Secret Key<br>
本命令通过修改  <a href="https://zimaoxy.com/m/post/zm.ocrbaiduinit/" target="_blank">zm.ocrbaiduinit</a>  的请求参数, 实现更多功能, 详见详见[百度云文字识别API文档](http://ai.baidu.com/docs#/OCR-API/top)的请求说明内容<br>
V1.1747: 加入命令<br>
V3.1849: 支持超级缩放</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="OcrNumbers" id="OcrNumbers"> <a href="https://zimaoxy.com/m/post/zm.ocrnumbers/" target="_blank">zm.OcrNumbers 免字库识别数字</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>免字库识别指定范围内符合颜色的数值, 支持小数, 基于  <a href="https://zimaoxy.com/m/post/smartocr/" target="_blank">smartocr</a>  开发.<br><br>该命令目前还在优化中, 识别效果以实际执行效果为准.</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.OcrNumbers(x1, y1, x2, y2, 颜色, 识别模式)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">左上角x: 数值型, 识别区域范围的左上角x坐标，区域范围全为0时表示全屏范围。请尽量缩小识别范围, 提高准确率.<br>左上角y: 数值型, 识别区域范围的左上角y坐标，区域范围全为0时表示全屏范围。请尽量缩小识别范围, 提高准确率.<br>右下角x: 数值型, 识别区域范围的右下角x坐标，区域范围全为0时表示全屏范围。请尽量缩小识别范围, 提高准确率.<br>右下角y: 数值型, 识别区域范围的右下角y坐标，区域范围全为0时表示全屏范围。请尽量缩小识别范围, 提高准确率.<br>颜色值: 字符串, 识别数字的16进制颜色，格式为“BBGGRR”，多个颜色用“&#124;”隔开，偏色使用“-”隔开，比如"FFFFFF-101010&#124;123456"。<br>识别模式: 数值型, 可选, 0等同于 <a href="https://zimaoxy.com/m/post/smartocr/" target="_blank">smartocr</a> , 1表示识别数字与小数点, 2表示识别数字与逗号, 省略默认为0</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数值型_ 或 _字符串_ 或 _表_ , 识别模式参数为0时, 返回字符串; 识别模式参数为1时, 返回数值型; 识别模式为2时, 返回坐标数组table, 格式为 `{x, y, "x":x, "y":y}`</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeOcrNumbers');">复制代码</div>
                <pre id="codeOcrNumbers">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//识别小数
Dim 数值 = zm.OcrNumbers(100,100,120,110,"000000", 1)
TracePrint 数值

//识别坐标
Dim 坐标 = zm.OcrNumbers(100,100,120,110,"000000", 2)
TracePrint 坐标["x"], 坐标["y"]</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令目前还在优化中, 识别效果以实际测试为准.<br>
V4.2016<br>
  初次加入<br>
V4.2017<br>
  优化准确率并加入识别坐标功能</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="OcrYouDao" id="OcrYouDao"> <a href="https://zimaoxy.com/m/post/zm.ocryoudao/" target="_blank">zm.OcrYouDao 有道智云OCR</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>无需制作字库, 使用有道智云实现在线云识别文字, 支持范围识别或指定图片识别, 必须先使用  <a href="https://zimaoxy.com/m/post/zm.ocryoudaoinit/" target="_blank">zm.ocryoudaoinit</a>  进行初始化</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.OcrYouDao([x1, y1, x2, y2][, 图片路径][, 返回json])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">x1: 数值型, 可选, 识别范围的左上角x坐标, 不可与图片路径参数同时存在<br>y1: 数值型, 可选, 识别范围的左上角y坐标, 不可与图片路径参数同时存在<br>x2: 数值型, 可选, 识别范围的右下角x坐标, 不可与图片路径参数同时存在<br>y2: 数值型, 可选, 识别范围的右下角y坐标, 不可与图片路径参数同时存在<br>图片路径: 字符串, 可选, 要识别内容的图片路径, 不可与范围参数同时存在<br>返回json: 表, 可选, 一般不建议填写, 以表的形式返回原生结果, 详情请自行遍历查看</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 返回识别结果, 失败返回nil</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeOcrYouDao');">复制代码</div>
                <pre id="codeOcrYouDao">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

zm.OcrYouDaoInit "请修改成你的应用ID", "请修改成你的应用密钥"

Dim ret = zm.OcrYouDao(100,100,400,400)
TracePrint "识别结果为:", ret</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用网易公司的有道智云OCR功能, 此命令的任何充值消费行为均与紫猫编程学院无关<br>
请自己注册帐号, 试用后再决定是否充值使用<br>
后台创建步骤:<br>
  前往[有道智云官网](http://ai.youdao.com/)注册并登录<br>
  创建一个我的应用<br>
  再创建一个文字识别OCR实例, 并绑定应用<br>
  打开应用就可以看到应用ID和应用密钥<br>
识别范围与图片路径参数只能二选一, 不可同时填写<br>
V1.1745: 加入命令<br>
V1.1746: 解决语法报错问题<br>
V3.1849: 支持超级缩放</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="OcrYouDaoInit" id="OcrYouDaoInit"> <a href="https://zimaoxy.com/m/post/zm.ocryoudaoinit/" target="_blank">zm.OcrYouDaoInit 设置有道智云OCR</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>初始化设置有道智云OCR的账户数据, 只要调用一次, 账户注册详见最下方的备注</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.OcrYouDaoInit([列表, ][应用ID, 应用密钥])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">列表: 表, 可选, 高级参数, 建议不写, 以table类型详细设置每个参数, 若填写本参数, 则将忽略其他参数, 详见下方属性表<br>应用ID: 字符串, 可选, 有道智云后台创建的应用ID, 详见最下面的备注<br>应用密钥: 字符串, 可选, 有道智云后台创建的应用密钥, 详见最下面的备注<br><br>属性 | 默认值 | 数据类型 | 解释<br>---|-----|------|---<br>appKey | "" | 字符串 | 有道智云后台创建的应用ID<br>secKey | "" | 字符串 | 有道智云后台创建的应用密钥<br>langType | "zh-en" | 字符串 | 要识别的语言类型, 目前支持英文:en，和中英混合：zh-en<br>detectType | "1011" | 字符串 | 识别类型，目前只支持片段识别:1011<br>imageType | "1" | 字符串 | 图片类型，目前只支持Base64:1<br>docType | "json" | 字符串 | 服务器响应类型，目前只支持json<br>url | "http://openapi.youdao.com/ocrapi" | 字符串 | 有道智云OCR API HTTP地址<br></td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 返回设置后的参数列表</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeOcrYouDaoInit');">复制代码</div>
                <pre id="codeOcrYouDaoInit">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

zm.OcrYouDaoInit "请修改成你的应用ID", "请修改成你的应用密钥"</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用网易公司的有道智云OCR功能, 此命令的任何充值消费行为均与紫猫编程学院无关<br>
请自己注册帐号, 试用后再决定是否充值使用<br>
后台创建步骤:<br>
  前往[有道智云官网](http://ai.youdao.com/)注册并登录<br>
  创建一个我的应用<br>
  再创建一个文字识别OCR实例, 并绑定应用<br>
  打开应用就可以看到应用ID和应用密钥<br>
V1.1745: 加入命令<br>
V3.1832: 为统一命令格式, `zm.SetOcrYouDao()`改为`zm.OcrYouDaoInit()`</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="OcrYouTu" id="OcrYouTu"> <a href="https://zimaoxy.com/m/post/zm.ocryoutu/" target="_blank">zm.OcrYouTu 优图通用OCR</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>无需制作字库, 使用腾讯的免费优图OCR实现在线云识别文字, 支持范围识别、本地图片或URL链接图片识别, 图片大小上限1MB, 请先调用  <a href="https://zimaoxy.com/m/post/zm.ocryoutuinit/" target="_blank">zm.ocryoutuinit</a>  设置后才使用本命令</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.OcrYouTu([x1, y1, x2, y2][图片路径][, 返回json])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">x1: 数值型, 可选, 识别范围的左上角x坐标, 与图片路径参数二选一<br>y1: 数值型, 可选, 识别范围的左上角y坐标, 与图片路径参数二选一<br>x2: 数值型, 可选, 识别范围的右下角x坐标, 与图片路径参数二选一<br>y2: 数值型, 可选, 识别范围的右下角y坐标, 与图片路径参数二选一<br>图片路径: 字符串, 可选, 要识别内容的图片本地路径或者URL图片链接, 支持https链接, 与范围参数二选一<br>返回json: table, 可选, 数组变量, 一般不需要填写, 以表的形式返回原生结果, 包括文字坐标等, 详见[优图通用OCR文档](https://ai.qq.com/doc/ocrgeneralocr.shtml)的响应参数部分</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 成功返回识别结果, 多行内容以`"\n"`分割, 失败返回`null`</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeOcrYouTu');">复制代码</div>
                <pre id="codeOcrYouTu">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//初始化优图账户数据, 只需执行一次, 请自行修改
zm.OcrYouTuInit("请修改成你的AppID", "请修改成你的AppKey")

Dim ret = zm.OcrYouTu(0, 0, 0, 0) //识别范围文字
TracePrint "识别结果: ", ret

ret = zm.OcrYouTu("/sdcard/紫猫.png") //识别本地图片
TracePrint "识别结果: ", ret

ret = zm.OcrYouTu("http://bbs.anjian.com/templates/default/Images/logo1.png") //识别网络图片
TracePrint "识别结果: ", ret

Dim t()
ret = zm.OcrYouTu(100, 100, 200, 200, t) //获取原生返回值t
TracePrint "部分原生返回值: ", zm.VarInfo(t)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用腾讯优图OCR的识别功能, 与百度云识别相比, 目前优图OCR完全免费使用<br>
获取优图AppID和AppKey的步骤:<br>
  前往[腾讯AI官网](https://ai.qq.com/)注册并登录<br>
  打开[控制台](https://ai.qq.com/cgi-bin/console_overview)<br>
  点击创建应用, 并输入相关资料, 记得勾选全部OCR接口<br>
  查看刚刚创建的应用, 就可以查到AppID和AppKey<br>
V3.1832: 加入命令<br>
V3.1849: 支持超级缩放</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="OcrYouTuBankCard" id="OcrYouTuBankCard"> <a href="https://zimaoxy.com/m/post/zm.ocryoutubankcard/" target="_blank">zm.OcrYouTuBankCard 优图银行卡OCR</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>无需制作字库, 使用腾讯的免费优图OCR实现在线云识别银行卡, 支持范围识别、本地图片或URL链接图片识别, 图片大小上限1MB, 请先调用  <a href="https://zimaoxy.com/m/post/zm.ocryoutuinit/" target="_blank">zm.ocryoutuinit</a>  设置后才使用本命令</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.OcrYouTuBankCard([x1, y1, x2, y2][图片路径][, 返回json])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">x1: 数值型, 可选, 识别范围的左上角x坐标, 与图片路径参数二选一<br>y1: 数值型, 可选, 识别范围的左上角y坐标, 与图片路径参数二选一<br>x2: 数值型, 可选, 识别范围的右下角x坐标, 与图片路径参数二选一<br>y2: 数值型, 可选, 识别范围的右下角y坐标, 与图片路径参数二选一<br>图片路径: 字符串, 可选, 要识别内容的图片本地路径或者URL图片链接, 支持https链接, 与范围参数二选一<br>返回json: table, 可选, 数组变量, 一般不需要填写, 以表的形式返回原生结果, 包括文字坐标等, 详见[优图银行卡OCR文档](https://ai.qq.com/doc/ocrcreditcardocr.shtml)的响应参数部分</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">table_ , 成功返回键值对table结果, 请遍历查看, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeOcrYouTuBankCard');">复制代码</div>
                <pre id="codeOcrYouTuBankCard">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//初始化优图账户数据, 只需执行一次, 请自行修改
zm.OcrYouTuInit("请修改成你的AppID", "请修改成你的AppKey")
Dim ret = zm.OcrYouTuBankCard("/sdcard/银行卡.png")
TracePrint "银行卡数据: ", zm.VarInfo(ret)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用腾讯优图OCR的识别功能, 与百度云识别相比, 目前优图OCR完全免费使用<br>
获取优图AppID和AppKey的步骤:<br>
  前往[腾讯AI官网](https://ai.qq.com/)注册并登录<br>
  打开[控制台](https://ai.qq.com/cgi-bin/console_overview)<br>
  点击创建应用, 并输入相关资料, 记得勾选全部OCR接口<br>
  查看刚刚创建的应用, 就可以查到AppID和AppKey<br>
V3.1832: 加入命令<br>
V3.1849: 支持超级缩放</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="OcrYouTuBC" id="OcrYouTuBC"> <a href="https://zimaoxy.com/m/post/zm.ocryoutubc/" target="_blank">zm.OcrYouTuBC 优图名片OCR</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>无需制作字库, 使用腾讯的免费优图OCR实现在线云识别名片, 支持范围识别、本地图片或URL链接图片识别, 图片大小上限1MB, 请先调用  <a href="https://zimaoxy.com/m/post/zm.ocryoutuinit/" target="_blank">zm.ocryoutuinit</a>  设置后才使用本命令</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.OcrYouTuBC([x1, y1, x2, y2][图片路径][, 返回json])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">x1: 数值型, 可选, 识别范围的左上角x坐标, 与图片路径参数二选一<br>y1: 数值型, 可选, 识别范围的左上角y坐标, 与图片路径参数二选一<br>x2: 数值型, 可选, 识别范围的右下角x坐标, 与图片路径参数二选一<br>y2: 数值型, 可选, 识别范围的右下角y坐标, 与图片路径参数二选一<br>图片路径: 字符串, 可选, 要识别内容的图片本地路径或者URL图片链接, 支持https链接, 与范围参数二选一<br>返回json: table, 可选, 数组变量, 一般不需要填写, 以表的形式返回原生结果, 包括文字坐标等, 详见[优图名片OCR文档](https://ai.qq.com/doc/ocrbcocr.shtml)的响应参数部分</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">table_ , 成功返回键值对table结果, 请遍历查看, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeOcrYouTuBC');">复制代码</div>
                <pre id="codeOcrYouTuBC">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//初始化优图账户数据, 只需执行一次, 请自行修改
zm.OcrYouTuInit("请修改成你的AppID", "请修改成你的AppKey")
Dim ret = zm.OcrYouTuBC("/sdcard/名片.png")
TracePrint "名片数据: ", zm.VarInfo(ret)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用腾讯优图OCR的识别功能, 与百度云识别相比, 目前优图OCR完全免费使用<br>
获取优图AppID和AppKey的步骤:<br>
  前往[腾讯AI官网](https://ai.qq.com/)注册并登录<br>
  打开[控制台](https://ai.qq.com/cgi-bin/console_overview)<br>
  点击创建应用, 并输入相关资料, 记得勾选全部OCR接口<br>
  查看刚刚创建的应用, 就可以查到AppID和AppKey<br>
V3.1832: 加入命令<br>
V3.1849: 支持超级缩放</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="OcrYouTuBusiness" id="OcrYouTuBusiness"> <a href="https://zimaoxy.com/m/post/zm.ocryoutubusiness/" target="_blank">zm.OcrYouTuBusiness 优图营业执照OCR</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>无需制作字库, 使用腾讯的免费优图OCR实现在线云识别营业执照, 支持范围识别、本地图片或URL链接图片识别, 图片大小上限1MB, 请先调用  <a href="https://zimaoxy.com/m/post/zm.ocryoutuinit/" target="_blank">zm.ocryoutuinit</a>  设置后才使用本命令</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.OcrYouTuBusiness([x1, y1, x2, y2][图片路径][, 返回json])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">x1: 数值型, 可选, 识别范围的左上角x坐标, 与图片路径参数二选一<br>y1: 数值型, 可选, 识别范围的左上角y坐标, 与图片路径参数二选一<br>x2: 数值型, 可选, 识别范围的右下角x坐标, 与图片路径参数二选一<br>y2: 数值型, 可选, 识别范围的右下角y坐标, 与图片路径参数二选一<br>图片路径: 字符串, 可选, 要识别内容的图片本地路径或者URL图片链接, 支持https链接, 与范围参数二选一<br>返回json: table, 可选, 数组变量, 一般不需要填写, 以表的形式返回原生结果, 包括文字坐标等, 详见[优图营业执照OCR文档](https://ai.qq.com/doc/ocrbizlicenseocr.shtml)的响应参数部分</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">table_ , 成功返回键值对table结果, 请遍历查看, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeOcrYouTuBusiness');">复制代码</div>
                <pre id="codeOcrYouTuBusiness">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//初始化优图账户数据, 只需执行一次, 请自行修改
zm.OcrYouTuInit("请修改成你的AppID", "请修改成你的AppKey")
Dim ret = zm.OcrYouTuBusiness("/sdcard/名片.png")
TracePrint "营业执照数据: ", zm.VarInfo(ret)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用腾讯优图OCR的识别功能, 与百度云识别相比, 目前优图OCR完全免费使用<br>
获取优图AppID和AppKey的步骤:<br>
  前往[腾讯AI官网](https://ai.qq.com/)注册并登录<br>
  打开[控制台](https://ai.qq.com/cgi-bin/console_overview)<br>
  点击创建应用, 并输入相关资料, 记得勾选全部OCR接口<br>
  查看刚刚创建的应用, 就可以查到AppID和AppKey<br>
V3.1832: 加入命令<br>
V3.1849: 支持超级缩放</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="OcrYouTuDriverLicense" id="OcrYouTuDriverLicense"> <a href="https://zimaoxy.com/m/post/zm.ocryoutudriverlicense/" target="_blank">zm.OcrYouTuDriverLicense 优图行驶证驾驶证OCR</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>无需制作字库, 使用腾讯的免费优图OCR实现在线云识别行驶证与驾驶证, 支持范围识别、本地图片或URL链接图片识别, 图片大小上限1MB, 请先调用  <a href="https://zimaoxy.com/m/post/zm.ocryoutuinit/" target="_blank">zm.ocryoutuinit</a>  设置后才使用本命令</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.OcrYouTuDriverLicense(类型, [x1, y1, x2, y2][图片路径][, 返回json])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">类型: 数值型_或_字符串, 必选, 行驶证照片填写"行驶证"或0, 驾驶证照片填写"驾驶证"或1<br>x1: 数值型, 可选, 识别范围的左上角x坐标, 与图片路径参数二选一<br>y1: 数值型, 可选, 识别范围的左上角y坐标, 与图片路径参数二选一<br>x2: 数值型, 可选, 识别范围的右下角x坐标, 与图片路径参数二选一<br>y2: 数值型, 可选, 识别范围的右下角y坐标, 与图片路径参数二选一<br>图片路径: 字符串, 可选, 要识别内容的图片本地路径或者URL图片链接, 支持https链接, 与范围参数二选一<br>返回json: table, 可选, 数组变量, 一般不需要填写, 以表的形式返回原生结果, 包括文字坐标等, 详见[优图行驶证驾驶证OCR文档](https://ai.qq.com/doc/ocrdriverlicenseocr.shtml)的响应参数部分</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">table_ , 成功返回键值对table结果, 请遍历查看, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeOcrYouTuDriverLicense');">复制代码</div>
                <pre id="codeOcrYouTuDriverLicense">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//初始化优图账户数据, 只需执行一次, 请自行修改
zm.OcrYouTuInit("请修改成你的AppID", "请修改成你的AppKey")
Dim ret = zm.OcrYouTuDriverLicense(0, "/sdcard/行驶证.png")
TracePrint "行驶证: ", zm.VarInfo(ret)
ret = zm.OcrYouTuDriverLicense(1, "/sdcard/驾驶证.png")
TracePrint "驾驶证: ", zm.VarInfo(ret)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用腾讯优图OCR的识别功能, 与百度云识别相比, 目前优图OCR完全免费使用<br>
获取优图AppID和AppKey的步骤:<br>
  前往[腾讯AI官网](https://ai.qq.com/)注册并登录<br>
  打开[控制台](https://ai.qq.com/cgi-bin/console_overview)<br>
  点击创建应用, 并输入相关资料, 记得勾选全部OCR接口<br>
  查看刚刚创建的应用, 就可以查到AppID和AppKey<br>
V3.1832: 加入命令<br>
V3.1849: 支持超级缩放</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="OcrYouTuHandWriting" id="OcrYouTuHandWriting"> <a href="https://zimaoxy.com/m/post/zm.ocryoutuhandwriting/" target="_blank">zm.OcrYouTuHandWriting 优图手写OCR</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>无需制作字库, 使用腾讯的免费优图OCR实现在线云识别手写文字, 支持范围识别、本地图片或URL链接图片识别, 图片大小上限1MB, 请先调用  <a href="https://zimaoxy.com/m/post/zm.ocryoutuinit/" target="_blank">zm.ocryoutuinit</a>  设置后才使用本命令</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.OcrYouTuHandWriting([x1, y1, x2, y2][图片路径][, 返回json])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">x1: 数值型, 可选, 识别范围的左上角x坐标, 与图片路径参数二选一<br>y1: 数值型, 可选, 识别范围的左上角y坐标, 与图片路径参数二选一<br>x2: 数值型, 可选, 识别范围的右下角x坐标, 与图片路径参数二选一<br>y2: 数值型, 可选, 识别范围的右下角y坐标, 与图片路径参数二选一<br>图片路径: 字符串, 可选, 要识别内容的图片本地路径或者URL图片链接, 支持https链接, 与范围参数二选一<br>返回json: table, 可选, 数组变量, 一般不需要填写, 以表的形式返回原生结果, 包括文字坐标等, 详见[优图手写OCR文档](https://ai.qq.com/doc/handwritingocr.shtml)的响应参数部分</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 成功返回识别结果, 多行内容以`"\n"`分割, 失败返回`null`</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeOcrYouTuHandWriting');">复制代码</div>
                <pre id="codeOcrYouTuHandWriting">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//初始化优图账户数据, 只需执行一次, 请自行修改
zm.OcrYouTuInit("请修改成你的AppID", "请修改成你的AppKey")
Dim ret = zm.OcrYouTuHandWriting("/sdcard/名片.png")
TracePrint "手写数据: ", ret</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用腾讯优图OCR的识别功能, 与百度云识别相比, 目前优图OCR完全免费使用<br>
获取优图AppID和AppKey的步骤:<br>
  前往[腾讯AI官网](https://ai.qq.com/)注册并登录<br>
  打开[控制台](https://ai.qq.com/cgi-bin/console_overview)<br>
  点击创建应用, 并输入相关资料, 记得勾选全部OCR接口<br>
  查看刚刚创建的应用, 就可以查到AppID和AppKey<br>
V3.1832: 加入命令<br>
V3.1849: 支持超级缩放</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="OcrYouTuIDCard" id="OcrYouTuIDCard"> <a href="https://zimaoxy.com/m/post/zm.ocryoutuidcard/" target="_blank">zm.OcrYouTuIDCard 优图身份证OCR</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>无需制作字库, 使用腾讯的免费优图OCR实现在线云识别身份证, 支持范围识别、本地图片或URL链接图片识别, 图片大小上限1MB, 请先调用  <a href="https://zimaoxy.com/m/post/zm.ocryoutuinit/" target="_blank">zm.ocryoutuinit</a>  设置后才使用本命令</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.OcrYouTuIDCard(正反面, [x1, y1, x2, y2][图片路径][, 返回json])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">正反面: 数值型_或_字符串, 必选, 身份证照片的正反面, 正面照片填写"正面"或0, 反面照片填写"反面"或1<br>x1: 数值型, 可选, 识别范围的左上角x坐标, 与图片路径参数二选一<br>y1: 数值型, 可选, 识别范围的左上角y坐标, 与图片路径参数二选一<br>x2: 数值型, 可选, 识别范围的右下角x坐标, 与图片路径参数二选一<br>y2: 数值型, 可选, 识别范围的右下角y坐标, 与图片路径参数二选一<br>图片路径: 字符串, 可选, 要识别内容的图片本地路径或者URL图片链接, 支持https链接, 与范围参数二选一<br>返回json: table, 可选, 数组变量, 一般不需要填写, 以表的形式返回原生结果, 包括文字坐标等, 详见[优图行驶证驾驶证OCR文档](https://ai.qq.com/doc/ocrdriverlicenseocr.shtml)的响应参数部分</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">table_ , 成功返回键值对table结果, 请遍历查看, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeOcrYouTuIDCard');">复制代码</div>
                <pre id="codeOcrYouTuIDCard">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//初始化优图账户数据, 只需执行一次, 请自行修改
zm.OcrYouTuInit("请修改成你的AppID", "请修改成你的AppKey")
Dim ret = zm.OcrYouTuIDCard(0, "/sdcard/身份证正面.png")
TracePrint "正面: ", zm.VarInfo(ret)
ret = zm.OcrYouTuIDCard(1, "/sdcard/身份证反面.png")
TracePrint "反面: ", zm.VarInfo(ret)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用腾讯优图OCR的识别功能, 与百度云识别相比, 目前优图OCR完全免费使用<br>
获取优图AppID和AppKey的步骤:<br>
  前往[腾讯AI官网](https://ai.qq.com/)注册并登录<br>
  打开[控制台](https://ai.qq.com/cgi-bin/console_overview)<br>
  点击创建应用, 并输入相关资料, 记得勾选全部OCR接口<br>
  查看刚刚创建的应用, 就可以查到AppID和AppKey<br>
V3.1832: 加入命令<br>
V3.1849: 支持超级缩放</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="OcrYouTuInit" id="OcrYouTuInit"> <a href="https://zimaoxy.com/m/post/zm.ocryoutuinit/" target="_blank">zm.OcrYouTuInit 初始化优图OCR</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>初始化设置腾讯优图OCR识别的账户AppID和AppKey, 一般只需调用一次, 账户注册详见最下方的备注</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.OcrYouTuInit(AppID, AppKey)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">AppID: 字符串, 可选, 腾讯AI控制台创建的优图OCR AppID, 详见最下面的备注<br>AppKey: 字符串, 可选, 腾讯AI控制台创建的优图OCR AppKey, 详见最下面的备注</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">table_ , 返回设置后的参数列表, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeOcrYouTuInit');">复制代码</div>
                <pre id="codeOcrYouTuInit">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//初始化优图账户数据, 只需执行一次, 请自行修改
zm.OcrYouTuInit("请修改成你的AppID", "请修改成你的AppKey")

Dim ret = zm.OcrYouTu(0, 0, 0, 0) //识别范围文字
TracePrint "识别结果: ", ret

ret = zm.OcrYouTu("/sdcard/紫猫.png") //识别本地图片
TracePrint "识别结果: ", ret

ret = zm.OcrYouTu("http://bbs.anjian.com/templates/default/Images/logo1.png") //识别网络图片
TracePrint "识别结果: ", ret

Dim t()
ret = zm.OcrYouTu(100, 100, 200, 200, t) //获取原生返回值t
TracePrint "部分原生返回值: ", zm.VarInfo(t)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用腾讯优图OCR的识别功能, 与百度云识别相比, 目前优图OCR完全免费使用<br>
获取优图AppID和AppKey的步骤:<br>
  前往[腾讯AI官网](https://ai.qq.com/)注册并登录<br>
  打开[控制台](https://ai.qq.com/cgi-bin/console_overview)<br>
  点击创建应用, 并输入相关资料, 记得勾选全部OCR接口<br>
  查看刚刚创建的应用, 就可以查到AppID和AppKey<br>
V3.1832: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="OcrYouTuPlate" id="OcrYouTuPlate"> <a href="https://zimaoxy.com/m/post/zm.ocryoutuplate/" target="_blank">zm.OcrYouTuPlate 优图车牌OCR</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>无需制作字库, 使用腾讯的免费优图OCR实现在线云识别车牌, 支持范围识别、本地图片或URL链接图片识别, 图片大小上限1MB, 请先调用  <a href="https://zimaoxy.com/m/post/zm.ocryoutuinit/" target="_blank">zm.ocryoutuinit</a>  设置后才使用本命令</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.OcrYouTuPlate([x1, y1, x2, y2][图片路径][, 返回json])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">x1: 数值型, 可选, 识别范围的左上角x坐标, 与图片路径参数二选一<br>y1: 数值型, 可选, 识别范围的左上角y坐标, 与图片路径参数二选一<br>x2: 数值型, 可选, 识别范围的右下角x坐标, 与图片路径参数二选一<br>y2: 数值型, 可选, 识别范围的右下角y坐标, 与图片路径参数二选一<br>图片路径: 字符串, 可选, 要识别内容的图片本地路径或者URL图片链接, 支持https链接, 与范围参数二选一<br>返回json: table, 可选, 数组变量, 一般不需要填写, 以表的形式返回原生结果, 包括文字坐标等, 详见[优图营业执照OCR文档](https://ai.qq.com/doc/ocrbizlicenseocr.shtml)的响应参数部分</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">table_ , 成功返回键值对table结果, 请遍历查看, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeOcrYouTuPlate');">复制代码</div>
                <pre id="codeOcrYouTuPlate">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//初始化优图账户数据, 只需执行一次, 请自行修改
zm.OcrYouTuInit("请修改成你的AppID", "请修改成你的AppKey")
Dim ret = zm.OcrYouTuPlate("/sdcard/车牌.png")
TracePrint "车牌: ", zm.VarInfo(ret)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用腾讯优图OCR的识别功能, 与百度云识别相比, 目前优图OCR完全免费使用<br>
获取优图AppID和AppKey的步骤:<br>
  前往[腾讯AI官网](https://ai.qq.com/)注册并登录<br>
  打开[控制台](https://ai.qq.com/cgi-bin/console_overview)<br>
  点击创建应用, 并输入相关资料, 记得勾选全部OCR接口<br>
  查看刚刚创建的应用, 就可以查到AppID和AppKey<br>
V3.1832: 加入命令<br>
V3.1849: 支持超级缩放</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="SpeechSsYouTu" id="SpeechSsYouTu"> <a href="https://zimaoxy.com/m/post/zm.speechssyoutu/" target="_blank">zm.SpeechSsYouTu 优图语音合成播放</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>使用优图提供的语音合成功能实现文字转声音并播放, 注意脚本停止会导致播放停止. 请先调用 <a href="https://zimaoxy.com/m/post/zm.speechssyoutuinit/" target="_blank">zm.speechssyoutuinit</a> 初始化后才使用本命令, 设置发音人等内容都在初始化命令中调整</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.SpeechSsYouTu(文本内容[, 是否播放[, 是否删除]])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">文本内容: 字符串, 准备合成语音的文本内容<br>是否播放: 布尔型, 可选, 是否自动播放音频, 注意脚本停止会导致播放停止<br>是否删除: 布尔型, 可选, 是否删除合成的文件, 注意前面必须要有是否播放参数</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 返回合成的语音文件路径, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeSpeechSsYouTu');">复制代码</div>
                <pre id="codeSpeechSsYouTu">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//初始化腾讯AI语音合成的账户数据, 只需执行一次, 请自行修改
zm.SpeechSsYouTuInit "请修改成你的AppID", "请修改成你的AppKey"
//合成并自动播放
zm.SpeechSsYouTu "欢迎使用紫猫插件手机版", True
Delay 5000 //防止脚本停止导致播放停止

//前面已经初始化过app数据, 现在修改默认发音人
zm.SpeechSsYouTuInit {"speaker":6}
//合成并自动播放
zm.SpeechSsYouTu "紫猫老师真帅!", True
Delay 5000 //防止脚本停止导致播放停止</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用腾讯AI的语音合成接口<br>
获取优图AppID和AppKey的步骤:<br>
  前往[腾讯AI官网](https://ai.qq.com/)注册并登录<br>
  打开[控制台](https://ai.qq.com/cgi-bin/console_overview)<br>
  点击创建应用, 并输入相关资料, 勾选`语音合成`<br>
  查看刚刚创建的应用, 就可以查到AppID和AppKey<br>
V3.1832: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="SpeechSsYouTuInit" id="SpeechSsYouTuInit"> <a href="https://zimaoxy.com/m/post/zm.speechssyoutuinit/" target="_blank">zm.SpeechSsYouTuInit 初始化优图语音合成</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>初始化设置腾讯AI语音合成的账户AppID和AppKey, 一般只需调用一次, 账户注册详见最下方的备注</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.SpeechSsYouTuInit([高级属性][AppID, AppKey])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">高级属性: table, 可选, 一般不需要填写, 以table类型详细设置每个参数, 若填写本参数, 则将忽略其他参数, 详见下面表格<br>AppID: 字符串, 可选, 腾讯AI控制台创建的语音合成 AppID, 详见最下面的备注<br>AppKey: 字符串, 可选, 腾讯AI控制台创建的语音合成 AppKey, 详见最下面的备注<br>app_id: 字符串, 腾讯AI控制台创建的语音合成 AppID<br>app_key: 字符串, 腾讯AI控制台创建的语音合成 AppKey<br>interface: 字符串, 语音合成接口, 支持`"aai_tts"`和`"aai_tta"`, 默认为`"aai_tts"`<br>speaker: 数值型, `aai_tts`接口的语音发音人编码, 支持`1,5,6,7`, 默认为`1`<br>format: 数值型, `aai_tts`接口的语音格式编码, 支持`1,2,3`, 默认为`2`<br>volume: 数值型, `aai_tts`接口的语音音量, 支持`[-10, 10]`, 默认为`0`<br>speed_tts: 数值型, `aai_tts`接口的语音语速, 支持`[50, 200]`, 默认为`100`<br>aht: 数值型, `aai_tts`接口的语音降低/升高半音个数, 支持`[-24, 24]`, 默认为`0`<br>apc: 数值型, `aai_tts`接口的控制频谱翘曲的程度，改变说话人的音色, 支持`[0, 100]`, 默认为`58`<br>model_type: 数值型, `aai_tta`接口的语音发音人编码, 支持`0,1,2,6`, 默认为`0`<br>speed_tta: 数值型, `aai_tta`接口的语音语速, 支持`-2,-1,0,1,2`, 默认为`0`</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">table_ , 返回设置后的参数列表, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeSpeechSsYouTuInit');">复制代码</div>
                <pre id="codeSpeechSsYouTuInit">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//初始化腾讯AI语音合成的账户数据, 只需执行一次, 请自行修改
zm.SpeechSsYouTuInit "请修改成你的AppID", "请修改成你的AppKey"
//合成并自动播放
zm.SpeechSsYouTu "欢迎使用紫猫插件手机版", True
Delay 5000 //防止脚本停止导致播放停止

//前面已经初始化过app数据, 现在修改默认发音人
zm.SpeechSsYouTuInit {"speaker":6}
//合成并自动播放
zm.SpeechSsYouTu "紫猫老师真帅!", True
Delay 5000 //防止脚本停止导致播放停止</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令调用腾讯AI的语音合成接口<br>
获取优图AppID和AppKey的步骤:<br>
  前往[腾讯AI官网](https://ai.qq.com/)注册并登录<br>
  打开[控制台](https://ai.qq.com/cgi-bin/console_overview)<br>
  点击创建应用, 并输入相关资料, 勾选`语音合成`<br>
  查看刚刚创建的应用, 就可以查到AppID和AppKey<br>
V3.1832: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="ElementFind" id="ElementFind"> <a href="https://zimaoxy.com/m/post/zm.elementfind/" target="_blank">zm.ElementFind 超级查找元素</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>根据条件查找元素节点, 返回元素节点表信息与中心坐标等数据. 比 `Element.Find()` 更加强大, 具体特色如下<br><br>- 除了返回抓抓上显示的元素特征信息外, 还有中心坐标, index等数据<br>- 支持指定范围查找, 再也不用担心找到范围外的元素节点了, 甚至直接获取指定范围内的节点<br>- 支持指定坐标查找, 直接获取该坐标点的元素节点, 不用再考虑特征串之类的了<br>- 支持抓抓上的五大元素特征串, 分别是 `text`, `resource-id`, `class`, `package`, `content-desc`, 这5个元素特征串可自由填写任意数量, 且没有顺序要求, 每个特征串之间为 `And` 关系<br>- 除了支持普通的完整匹配外, 还支持正则匹配模式, 让元素特征串更加灵活<br>- 默认仅获取最终子节点, 避免干扰, 但你也可以改为获取任意一个符合条件的节点<br>- 担心查找的时候节点还没出现? 限时循环查找完美解决这个问题<br>- 大量可选参数, 减少不必要的代码量<br>- 支持对象参数写法, 将所有参数保存到一张表里, 直接传入该表, 方便优化代码结构</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.ElementFind([对象, ...][x1,y1,x2,y2,][元素特征, ...][指定坐标x,指定坐标y,][是否最终元素,][匹配模式][,超时时间])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象: 表, 可选, 对象是指把查找一个元素用到的参数全部放到数组中, 然后用该数组做对象参数. 若要填写对象参数, 则必须写在最前面, 填写后将忽略除超时参数以外的其他普通参数. 支持多个对象参数, 每个对象为 `OR` 关系, 找到任何一个对象立即返回结果<br>x1: 数值型, 可选, 查找范围左上角x, 元素节点必须完全在范围内, 不能超出范围, 省略默认为0, 范围0,0,0,0表示全屏<br>y1: 数值型, 可选, 查找范围左上角y, 元素节点必须完全在范围内, 不能超出范围, 省略默认为0, 范围0,0,0,0表示全屏<br>x2: 数值型, 可选, 查找范围右下角x, 元素节点必须完全在范围内, 不能超出范围, 省略默认为0, 范围0,0,0,0表示全屏<br>y2: 数值型, 可选, 查找范围右下角y, 元素节点必须完全在范围内, 不能超出范围, 省略默认为0, 范围0,0,0,0表示全屏<br>元素特征: 字符串, 可选, 抓抓上获取到的元素特征值, 支持 `text`, `resource-id`, `class`, `package`, `content-desc`这5个对应特征值, 可自由填写0到5个元素特征参数, 无顺序要求, 同个对象每个特征之间为 `AND` 关系, 内部忽略特征名, 只判断特征值, 详见例子<br>指定坐标x: 数值型, 可选, 直接获取指定坐标上的元素特征串, 省略默认为0, 指定坐标0,0表示不使用本参数<br>指定坐标y: 数值型, 可选, 直接获取指定坐标上的元素特征串, 省略默认为0, 指定坐标0,0表示不使用本参数<br>是否最终元素: 布尔型, 可选, 是否只获取没有子节点的最终元素节点, 省略默认为true, 表示只获取没有子节点的最终元素元素<br>匹配模式: 数值型, 可选, 元素特征的匹配模式, -1表示直接比较是否相等的完整匹配模式, -2表示正则匹配是否符合的正则模式, 省略默认为-1<br>超时时间: 数值型, 可选, 最大查找时间, 如果每个对象内都有超时时间的话, 将仅使用最大的时间做判断</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 找到返回元素特征表, 没找到返回 `null`, 元素特征表格式为 `{"x":0,"y":0,"id":0,"xy":[0,0]"index":0,"text":"","resource-id":"","class":"","package":"","content-desc":"","checkable":true,"checked":true,"clickable":true,"enabled":true,"focusable":true,"focused":true,"scrollable":true,"long-clickable":true,"password":true,"selected":true,"bounds":[0,0,0,0],"left":0,"top":0,"right":0,"bottom":0,"pos":[0,0]}` , 其中 `"x"`, `"y"` 代表找到元素节点的中心位置坐标, 可用于tap点击, `"id"` 代表多个对象情况下找到的那个序号</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeElementFind');">复制代码</div>
                <pre id="codeElementFind">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//--------------------简易用法--------------------//
//下面这个例子实现了限时5秒钟内获取并点击桌面显示的微信App坐标
//这里找到的坐标为元素中心的坐标
Dim 微信 = zm.ElementFind("微信", 5000)
If 微信 Then 
	TracePrint "找到微信的坐标为: ", 微信["x"], 微信["y"]
	zm.Tap 微信["x"], 微信["y"]
	//小技巧: 返回值中另一个xy成员是数组表, 可以直接被zm.tap调用
	//zm.Tap 微信["xy"] //这句代码也实现了点击坐标功能
Else 
	TracePrint "没找到微信"
End If


//--------------------获取元素文本--------------------//
//获取右上角的时间文本
//这里3个参数是And关系, 也就是要在抓抓上的5个特征中同时找到符合这3个参数值
Dim 时钟 = zm.ElementFind("com.android.systemui:id/clock", "android.widget.TextView","com.android.systemui")
If 时钟 Then 
	TracePrint "当前时间为: ", 时钟["text"]
Else 
	TracePrint "没找到时钟"
End If

//--------------------指定坐标--------------------//
//获取指定坐标的元素文本内容
//一般指定坐标情况下必定有元素的存在, 但该元素不一定有text文本内容
//所以建议是再加上一些元素特征串, 避免获取到的内容不是自己想要的数据
//另外默认仅获取最后一个子元素节点, 如果该坐标只有父节点的话, 请修改布尔值参数
Dim 指定坐标文本 = zm.ElementFind("android.view.View", 650, 1222, 2000)
If 指定坐标文本 Then 
	TracePrint "指定坐标的元素文本为:", 指定坐标文本["text"]
Else 
	TracePrint "没找到元素"
End If

//--------------------指定范围--------------------//
//在固定范围内查找符合条件的元素
//当你发现有大量元素特征重复的情况下, 除了可以用指定坐标解决外, 也可以用指定范围
//指定范围必须要完全包括元素, 例如元素边框是100,100,200,200, 那么范围必须比它大
//如果担心元素不对, 可以加上一些特征串, 这里省略不加
Dim 范围元素 = zm.ElementFind(90, 90, 210, 210)
If 范围元素 Then 
	TracePrint "范围元素的元素坐标与文本为:", 范围元素["x"], 范围元素["y"], 范围元素["text"]
Else 
	TracePrint "没找到元素"
End If

//--------------------对象用法--------------------//
//对象嘛, 肯定是要你自己去找到, 找不到咋办?自己创建一个呗, 咳咳
//所谓的对象其实就是把所有用到普通参数放到一个table数组中
//有了对象后, 将忽略除了超时时间外的所有普通参数, 多个超时时间仅取最大值
//允许填写多个对象, 内部将会循环查找, 找到任何一个对象立即返回结果
//对象参数必须从第1个参数位置开始填写
//下面定义对象的特征串与超时时间, 其他参数也可以写进来
Dim 京东对象 = {"京东","android.widget.TextView","com.android.launcher3", 1000}
Dim 淘宝对象 = {"淘宝","android.widget.TextView","com.android.launcher3", 2000}
//传入多个对象与另一个超时时间, 由于5000大于1000, 所以超时最终为5000毫秒
//假如外面不写超时的话, 那最终超时时间由两个对象决定出最大值为2000毫秒
Dim 对象结果 = zm.ElementFind(京东对象, 淘宝对象, 5000)
If 对象结果 Then 
	TracePrint "找到了一个对象, 坐标为:", 对象结果["x"], 对象结果["y"], "序号为:", 对象结果["id"]
Else
	TracePrint "没有找到任何一个对象喜欢你, 呜呜呜...."
End If


//--------------------正则匹配--------------------//
//元素特征默认是完整匹配, 即大小写与长度都要符合才能找到
//但填入参数-2后将切换至正则匹配模式, 需注意这里使用的是Lua的正则规则
//一般不推荐新手使用该方法, 但这里提供几种简易的规则供大家模仿
// ^紫猫.* 这个规则表示匹配由紫猫做开头的元素特征
// .*紫猫$ 这个规则表示匹配由紫猫做结尾的元素特征
// .*紫猫.* 这个规则表示匹配包含紫猫的元素特征
//更多的匹配规则请浏览 https://zimaoxy.com/m/post/pattern-matching/

Dim 正则结果 = zm.ElementFind("^充值.*", -2)
If 正则结果 Then 
	TracePrint "找到元素为:", 正则结果["text"]
Else 
	TracePrint "未找到元素"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>关于参数填写顺序说明<br>
  本插件所有参数都是可选的, 绝大多数参数对顺序没有要求, 但以下3个参数有顺序要求<br>
  ( `查找范围`, `指定坐标`, `超时时间` )<br>
  这3个参数均为可选参数, 中间也可以填写其他参数, 但是前后关系不能打乱, 下面举几个例子<br>
  正确例子: ( `查找范围`, `超时时间`), (`指定坐标`, `元素特征`, `超时时间`), (`查找范围`, `元素特征`)<br>
  错误例子: (`超时时间`, `查找范围`), (`查找范围`, `超时时间`, `指定坐标`), (`指定坐标`, `元素特征`, `查找范围`)<br>
  如果无法理解的话, 建议按照语法说明的参数顺序填写<br>
关于对象参数<br>
  对象参数必须从第1个位置开始填写, 并且填写后除了超时时间外的其他普通参数全都忽略<br>
  多个对象为 `OR` 关系, 内部依次循环查找每一个对象, 任何一个被找到则立即返回<br>
  当存在多个超时时间时, 仅最大的时间会生效, 限时内会不断查找每一个对象<br>
关于元素特征串<br>
  支持抓抓上的`text`, `resource-id`, `class`, `package`, `content-desc`<br>
  填写数量自定义, 你可以只写1个, 也可以写3个, 甚至都不写或者全都写.<br>
  查找时忽略特征名, 只找特征值, 例如你填写了 `"微信"`, 那么有可能找到 `text` 是 `微信` 的元素, 或者 `content-desc` 是 `微信` 的元素.<br>
  查找时要求填写的特征全都要找到才算符合条件, 包括填写空字符串 `""`, 也会要求找到对应空字符串<br>
  两个特征值一样的也会查找, 例如你填写了 `"微信", "微信"`, 那么查找的时候就会去找元素特征里存在两个 `微信` 的元素<br>
关于最终元素<br>
  最终元素是指没有子节点的元素, 也就是抓抓里看到前面没有 `+` 或 `-` 的元素<br>
关于旋转横屏坐标处理<br>
  如果遇到打开某个应用后, 屏幕方向被旋转了, 导致获取元素中心坐标异常时, 请使用  <a href="https://zimaoxy.com/m/post/zm.elementrotation/" target="_blank">zm.elementrotation</a>  解决<br>
需按键精灵V3.5.8以上版本支持本命令<br>
V4.2111: 初次加入</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="ElementFindEx" id="ElementFindEx"> <a href="https://zimaoxy.com/m/post/zm.elementfindex/" target="_blank">zm.ElementFindEx 超级查找元素返回全部</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>- 与 <a href="https://zimaoxy.com/m/post/zm.elementfind/" target="_blank">zm.elementfind</a> 的唯一区别是返回了所有找到的坐标, 注意如果多个对象的话, 仅返回找到的首个对象所有坐标.<br>- 除了返回抓抓上显示的元素特征信息外, 还有中心坐标, index等数据<br>- 支持指定范围查找, 再也不用担心找到范围外的元素节点了, 甚至直接获取指定范围内的节点<br>- 支持指定坐标查找, 直接获取该坐标点的元素节点, 不用再考虑特征串之类的了<br>- 支持抓抓上的五大元素特征串, 分别是 `text`, `resource-id`, `class`, `package`, `content-desc`, 这5个元素特征串可自由填写任意数量, 且没有顺序要求, 每个特征串之间为 `And` 关系<br>- 除了支持普通的完整匹配外, 还支持正则匹配模式, 让元素特征串更加灵活<br>- 默认仅获取最终子节点, 避免干扰, 但你也可以改为获取任意一个符合条件的节点<br>- 担心查找的时候节点还没出现? 限时循环查找完美解决这个问题<br>- 大量可选参数, 减少不必要的代码量<br>- 支持对象参数写法, 将所有参数保存到一张表里, 直接传入该表, 方便优化代码结构</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.ElementFindEx([对象, ...][x1,y1,x2,y2,][元素特征, ...][指定坐标x,指定坐标y,][是否最终元素,][匹配模式][,超时时间])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象: 表, 可选, 对象是指把查找一个元素用到的参数全部放到数组中, 然后用该数组做对象参数. 若要填写对象参数, 则必须写在最前面, 填写后将忽略除超时参数以外的其他普通参数. 支持多个对象参数, 每个对象为 `OR` 关系, 找到任何一个对象立即返回结果<br>x1: 数值型, 可选, 查找范围左上角x, 元素节点必须完全在范围内, 不能超出范围, 省略默认为0, 范围0,0,0,0表示全屏<br>y1: 数值型, 可选, 查找范围左上角y, 元素节点必须完全在范围内, 不能超出范围, 省略默认为0, 范围0,0,0,0表示全屏<br>x2: 数值型, 可选, 查找范围右下角x, 元素节点必须完全在范围内, 不能超出范围, 省略默认为0, 范围0,0,0,0表示全屏<br>y2: 数值型, 可选, 查找范围右下角y, 元素节点必须完全在范围内, 不能超出范围, 省略默认为0, 范围0,0,0,0表示全屏<br>元素特征: 字符串, 可选, 抓抓上获取到的元素特征值, 支持 `text`, `resource-id`, `class`, `package`, `content-desc`这5个对应特征值, 可自由填写0到5个元素特征参数, 无顺序要求, 同个对象每个特征之间为 `AND` 关系, 内部忽略特征名, 只判断特征值, 详见例子<br>指定坐标x: 数值型, 可选, 直接获取指定坐标上的元素特征串, 省略默认为0, 指定坐标0,0表示不使用本参数<br>指定坐标y: 数值型, 可选, 直接获取指定坐标上的元素特征串, 省略默认为0, 指定坐标0,0表示不使用本参数<br>是否最终元素: 布尔型, 可选, 是否只获取没有子节点的最终元素节点, 省略默认为true, 表示只获取没有子节点的最终元素元素<br>匹配模式: 数值型, 可选, 元素特征的匹配模式, -1表示直接比较是否相等的完整匹配模式, -2表示正则匹配是否符合的正则模式, 省略默认为-1<br>超时时间: 数值型, 可选, 最大查找时间, 如果每个对象内都有超时时间的话, 将仅使用最大的时间做判断</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 返回找到首个对象的所有元素特征二维表, 没找到返回 `null`, 元素特征表格式为 `{"id":0, "counts":0, {"x":0,"y":0,"xy":[0,0],"index":0,"text":"","resource-id":"","class":"","package":"","content-desc":"","checkable":true,"checked":true,"clickable":true,"enabled":true,"focusable":true,"focused":true,"scrollable":true,"long-clickable":true,"password":true,"selected":true,"bounds":[0,0,0,0],"left":0,"top":0,"right":0,"bottom":0,"pos":[0,0]}, ...}` , 其中 `"x"`, `"y"` 代表找到元素节点的中心位置坐标, 可用于tap点击, `"id"` 代表多个对象情况下找到的那个序号, `"counts"` 代表找到的数量</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeElementFindEx');">复制代码</div>
                <pre id="codeElementFindEx">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//参数语法与zm.ElementFind()一样, 只是返回值不同
//所以这里仅写几个例子, 更多例子详见zm.ElementFind()命令

//--------------获取所有符合条件的元素--------------//
Dim nodes = zm.ElementFindEx("android.widget.TextView", "com.android.launcher3")
If nodes Then 
	TracePrint "一共找到了", nodes["counts"], "个元素"
	For i = 1 To nodes["counts"]
		TracePrint "第", i, "个元素标题是", nodes[i]["text"], ", 坐标是", nodes[i]["x"], ",", nodes[i]["y"]
	Next
Else 
	TracePrint "没有找到元素"
End If

//--------------多个对象情况--------------//
//如果存在多个对象时, 仅返回找到首个对象的所有元素
//例如对象1, 对象2, 对象3循环限时查找, 当找到对象2存在时, 将对象2所有元素都返回后, 立即停止查找
Dim 京东对象 = {"京东","android.widget.TextView","com.android.launcher3", 1000}
Dim 淘宝对象 = {"淘宝","android.widget.TextView","com.android.launcher3", 2000}
Dim 对象结果 = zm.ElementFindEx(京东对象, 淘宝对象, 5000)
If 对象结果 Then 
	TracePrint "找到了第", 对象结果["id"], "个对象, 一共有", 对象结果["counts"], "个元素"
	For i = 1 To 对象结果["counts"]
		TracePrint "第", i, "个元素标题是", 对象结果[i]["text"], ", 坐标是", 对象结果[i]["x"], ",", 对象结果[i]["y"]
	Next
Else
	TracePrint "没有找到任何一个对象喜欢你, 呜呜呜...."
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>关于多个对象查找返回注意事项<br>
  多个对象依旧会循环查找, 但是当找到一个对象时, 将返回该对象的所有元素节点后, 停止查找<br>
  如果你需要所有对象都返回所有节点, 请多写几行不同参数的代码<br>
关于参数填写顺序说明<br>
  本插件所有参数都是可选的, 绝大多数参数对顺序没有要求, 但以下3个参数有顺序要求<br>
  ( `查找范围`, `指定坐标`, `超时时间` )<br>
  这3个参数均为可选参数, 中间也可以填写其他参数, 但是前后关系不能打乱, 下面举几个例子<br>
  正确例子: ( `查找范围`, `超时时间`), (`指定坐标`, `元素特征`, `超时时间`), (`查找范围`, `元素特征`)<br>
  错误例子: (`超时时间`, `查找范围`), (`查找范围`, `超时时间`, `指定坐标`), (`指定坐标`, `元素特征`, `查找范围`)<br>
  如果无法理解的话, 建议按照语法说明的参数顺序填写<br>
关于对象参数<br>
  对象参数必须从第1个位置开始填写, 并且填写后除了超时时间外的其他普通参数全都忽略<br>
  多个对象为 `OR` 关系, 内部依次循环查找每一个对象, 任何一个被找到则立即返回<br>
  当存在多个超时时间时, 仅最大的时间会生效, 限时内会不断查找每一个对象<br>
关于元素特征串<br>
  支持抓抓上的`text`, `resource-id`, `class`, `package`, `content-desc`<br>
  填写数量自定义, 你可以只写1个, 也可以写3个, 甚至都不写或者全都写.<br>
  查找时忽略特征名, 只找特征值, 例如你填写了 `"微信"`, 那么有可能找到 `text` 是 `微信` 的元素, 或者 `content-desc` 是 `微信` 的元素.<br>
  查找时要求填写的特征全都要找到才算符合条件, 包括填写空字符串 `""`, 也会要求找到对应空字符串<br>
  两个特征值一样的也会查找, 例如你填写了 `"微信", "微信"`, 那么查找的时候就会去找元素特征里存在两个 `微信` 的元素<br>
关于最终元素<br>
  最终元素是指没有子节点的元素, 也就是抓抓里看到前面没有 `+` 或 `-` 的元素<br>
关于旋转横屏坐标处理<br>
  如果遇到打开某个应用后, 屏幕方向被旋转了, 导致获取元素中心坐标异常时, 请使用  <a href="https://zimaoxy.com/m/post/zm.elementrotation/" target="_blank">zm.elementrotation</a>  解决<br>
需按键精灵V3.5.8以上版本支持本命令<br>
V4.2113: 初次加入</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="ElementFindExTap" id="ElementFindExTap"> <a href="https://zimaoxy.com/m/post/zm.elementfindextap/" target="_blank">zm.ElementFindExTap 超级查找元素返回全部并点击</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>与 <a href="https://zimaoxy.com/m/post/zm.elementfindex/" target="_blank">zm.elementfindex</a> 相比, 仅多了一个找到后立即点击所有元素的功能, 其它都相同, 点击会受 <a href="https://zimaoxy.com/m/post/zm.settap/" target="_blank">zm.settap</a> 设置影响, 内置每次点击间隔250毫秒.<br><br>- 找到后内部会调用 <a href="https://zimaoxy.com/m/post/zm.tap/" target="_blank">zm.tap</a> 点击找到的坐标<br>- 除了返回抓抓上显示的元素特征信息外, 还有中心坐标, index等数据<br>- 支持指定范围查找, 再也不用担心找到范围外的元素节点了, 甚至直接获取指定范围内的节点<br>- 支持指定坐标查找, 直接获取该坐标点的元素节点, 不用再考虑特征串之类的了<br>- 支持抓抓上的五大元素特征串, 分别是 `text`, `resource-id`, `class`, `package`, `content-desc`, 这5个元素特征串可自由填写任意数量, 且没有顺序要求, 每个特征串之间为 `And` 关系<br>- 除了支持普通的完整匹配外, 还支持正则匹配模式, 让元素特征串更加灵活<br>- 默认仅获取最终子节点, 避免干扰, 但你也可以改为获取任意一个符合条件的节点<br>- 担心查找的时候节点还没出现? 限时循环查找完美解决这个问题<br>- 大量可选参数, 减少不必要的代码量<br>- 支持对象参数写法, 将所有参数保存到一张表里, 直接传入该表, 方便优化代码结构</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.ElementFindExTap([对象, ...][x1,y1,x2,y2,][元素特征, ...][指定坐标x,指定坐标y,][是否最终元素,][匹配模式][,超时时间])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象: 表, 可选, 对象是指把查找一个元素用到的参数全部放到数组中, 然后用该数组做对象参数. 若要填写对象参数, 则必须写在最前面, 填写后将忽略除超时参数以外的其他普通参数. 支持多个对象参数, 每个对象为 `OR` 关系, 找到任何一个对象立即返回结果<br>x1: 数值型, 可选, 查找范围左上角x, 元素节点必须完全在范围内, 不能超出范围, 省略默认为0, 范围0,0,0,0表示全屏<br>y1: 数值型, 可选, 查找范围左上角y, 元素节点必须完全在范围内, 不能超出范围, 省略默认为0, 范围0,0,0,0表示全屏<br>x2: 数值型, 可选, 查找范围右下角x, 元素节点必须完全在范围内, 不能超出范围, 省略默认为0, 范围0,0,0,0表示全屏<br>y2: 数值型, 可选, 查找范围右下角y, 元素节点必须完全在范围内, 不能超出范围, 省略默认为0, 范围0,0,0,0表示全屏<br>元素特征: 字符串, 可选, 抓抓上获取到的元素特征值, 支持 `text`, `resource-id`, `class`, `package`, `content-desc`这5个对应特征值, 可自由填写0到5个元素特征参数, 无顺序要求, 同个对象每个特征之间为 `AND` 关系, 内部忽略特征名, 只判断特征值, 详见例子<br>指定坐标x: 数值型, 可选, 直接获取指定坐标上的元素特征串, 省略默认为0, 指定坐标0,0表示不使用本参数<br>指定坐标y: 数值型, 可选, 直接获取指定坐标上的元素特征串, 省略默认为0, 指定坐标0,0表示不使用本参数<br>是否最终元素: 布尔型, 可选, 是否只获取没有子节点的最终元素节点, 省略默认为true, 表示只获取没有子节点的最终元素元素<br>匹配模式: 数值型, 可选, 元素特征的匹配模式, -1表示直接比较是否相等的完整匹配模式, -2表示正则匹配是否符合的正则模式, 省略默认为-1<br>超时时间: 数值型, 可选, 最大查找时间, 如果每个对象内都有超时时间的话, 将仅使用最大的时间做判断</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 返回找到首个对象的所有元素特征二维表, 没找到返回 `null`, 元素特征表格式为 `{"id":0, "counts":0, {"x":0,"y":0,"xy":[0,0],"index":0,"text":"","resource-id":"","class":"","package":"","content-desc":"","checkable":true,"checked":true,"clickable":true,"enabled":true,"focusable":true,"focused":true,"scrollable":true,"long-clickable":true,"password":true,"selected":true,"bounds":[0,0,0,0],"left":0,"top":0,"right":0,"bottom":0,"pos":[0,0]}, ...}` , 其中 `"x"`, `"y"` 代表找到元素节点的中心位置坐标, 可用于tap点击, `"id"` 代表多个对象情况下找到的那个序号, `"counts"` 代表找到的数量</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeElementFindExTap');">复制代码</div>
                <pre id="codeElementFindExTap">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//本命令与zm.ElementFindEx()类似, 仅多了一个找到后立即点击所有点功能, 故详细例子请去查看zm.ElementFindEx()命令
//下面演示打开京东的发现, 并依次点击关注
RunApp "com.jingdong.app.mall"

If zm.ElementFindTap("发现", "com.jingdong.app.mall", "android.view.View", 5000) Then 
	TracePrint "找到发现, 并已点击"
	Delay 3000
Else 
	TracePrint "没找到发现"
End If

Dim 关注 = zm.ElementFindExTap("com.jd.lib.DiscoverAttention:id/a5_", "android.widget.ImageView", "com.jingdong.app.mall", "", "", 5000)
If 关注 Then 
	TracePrint "找到", 关注["counts"], "个关注并全部已点击"
Else 
	TracePrint "没找到关注"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>关于多个对象查找返回注意事项<br>
  多个对象依旧会循环查找, 但是当找到一个对象时, 将返回该对象的所有元素节点后, 停止查找<br>
  如果你需要所有对象都返回所有节点, 请多写几行不同参数的代码<br>
关于参数填写顺序说明<br>
  本插件所有参数都是可选的, 绝大多数参数对顺序没有要求, 但以下3个参数有顺序要求<br>
  ( `查找范围`, `指定坐标`, `超时时间` )<br>
  这3个参数均为可选参数, 中间也可以填写其他参数, 但是前后关系不能打乱, 下面举几个例子<br>
  正确例子: ( `查找范围`, `超时时间`), (`指定坐标`, `元素特征`, `超时时间`), (`查找范围`, `元素特征`)<br>
  错误例子: (`超时时间`, `查找范围`), (`查找范围`, `超时时间`, `指定坐标`), (`指定坐标`, `元素特征`, `查找范围`)<br>
  如果无法理解的话, 建议按照语法说明的参数顺序填写<br>
关于对象参数<br>
  对象参数必须从第1个位置开始填写, 并且填写后除了超时时间外的其他普通参数全都忽略<br>
  多个对象为 `OR` 关系, 内部依次循环查找每一个对象, 任何一个被找到则立即返回<br>
  当存在多个超时时间时, 仅最大的时间会生效, 限时内会不断查找每一个对象<br>
关于元素特征串<br>
  支持抓抓上的`text`, `resource-id`, `class`, `package`, `content-desc`<br>
  填写数量自定义, 你可以只写1个, 也可以写3个, 甚至都不写或者全都写.<br>
  查找时忽略特征名, 只找特征值, 例如你填写了 `"微信"`, 那么有可能找到 `text` 是 `微信` 的元素, 或者 `content-desc` 是 `微信` 的元素.<br>
  查找时要求填写的特征全都要找到才算符合条件, 包括填写空字符串 `""`, 也会要求找到对应空字符串<br>
  两个特征值一样的也会查找, 例如你填写了 `"微信", "微信"`, 那么查找的时候就会去找元素特征里存在两个 `微信` 的元素<br>
关于最终元素<br>
  最终元素是指没有子节点的元素, 也就是抓抓里看到前面没有 `+` 或 `-` 的元素<br>
关于旋转横屏坐标处理<br>
  如果遇到打开某个应用后, 屏幕方向被旋转了, 导致获取元素中心坐标异常时, 请使用  <a href="https://zimaoxy.com/m/post/zm.elementrotation/" target="_blank">zm.elementrotation</a>  解决<br>
需按键精灵V3.5.8以上版本支持本命令<br>
V4.2113: 初次加入</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="ElementFindS" id="ElementFindS"> <a href="https://zimaoxy.com/m/post/zm.elementfinds/" target="_blank">zm.ElementFindS 超级查找元素(专业版)</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>- 与 <a href="https://zimaoxy.com/m/post/zm.elementfind/" target="_blank">zm.elementfind</a> 的区别是支持抓抓上所有特征串, 但仅支持键值对形式的对象参数, 并且对每个键名与键值做了详细规定, 详见代码例子<br>- 支持index范围查找, 一些特征不明显的直接用index元素秒杀<br>- 支持抓抓上的所有特征串, 详细写法见参数说明与代码例子<br>- 同一个键名允许填写多个键值, 多个之间为或关系, 详见代码例子<br>- 大量键名支持简写方式, 详见代码例子<br>- 除了返回抓抓上显示的元素特征信息外, 还有中心坐标, index等数据<br>- 支持指定范围查找, 再也不用担心找到范围外的元素节点了, 甚至直接获取指定范围内的节点<br>- 支持指定坐标查找, 直接获取该坐标点的元素节点, 不用再考虑特征串之类的了<br>- 除了支持普通的完整匹配外, 还支持正则匹配模式, 让元素特征串更加灵活<br>- 默认仅获取最终子节点, 避免干扰, 但你也可以改为获取任意一个符合条件的节点<br>- 担心查找的时候节点还没出现? 限时循环查找完美解决这个问题</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.ElementFindS(元素对象[, ...][, 超时时间])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">元素对象: 表, 要查找的元素特征表, 支持多个元素对象参数, 每个对象之间为或关系, 格式为`{"index":0,"text":"","resource-id":"","class":"","package":"","content-desc":"","checkable":true,"checked":true,"clickable":true,"enabled":true,"focusable":true,"focused":true,"scrollable":true,"long-clickable":true,"password":true,"selected":true,"bounds":{0,0,0,0},"xy":{0,0},"size":{0,0},"ischild":true,"matchmode":0,"timeout":0}`, 每个成员均是可选的, 具体定义详见代码例子<br>超时时间: 数值型, 可选, 最大查找时间, 如果每个对象内都有超时时间的话, 将仅使用最大的时间做判断</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 找到返回元素特征表, 没找到返回 `null`, 元素特征表格式为 `{"x":0,"y":0,"id":0,"xy":[0,0]"index":0,"text":"","resource-id":"","class":"","package":"","content-desc":"","checkable":true,"checked":true,"clickable":true,"enabled":true,"focusable":true,"focused":true,"scrollable":true,"long-clickable":true,"password":true,"selected":true,"bounds":[0,0,0,0],"left":0,"top":0,"right":0,"bottom":0,"pos":[0,0]}` , 其中 `"x"`, `"y"` 代表找到元素节点的中心位置坐标, 可用于tap点击, `"id"` 代表多个对象情况下找到的那个序号</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeElementFindS');">复制代码</div>
                <pre id="codeElementFindS">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//本命令与zm.ElementFind()相似, 但是区别在于更加专业严谨
//元素特征表除了抓抓上的键值对外, 还增加了一些缩写与新键值对参数
//填写相关元素特征则查找, 若不填写则忽略

//----------index与id----------//
//"index":10, 表示抓抓上的index值为10
//"index":{10,20}, 表示抓抓上index值为10或者20, 支持任意数量个
//"index":{ {20, 30} }, 表示抓抓上index的范围在20到30之间, 包括20和30
//"index":{ {20, 30}, {40, 80} }, 表示抓抓上index的范围在20到30或者40到80之间, 支持任意数量个
//index的缩写是id, 即 "id":10 与 "index":10 是相同的意思.

//----------text与txt, resource-id与res, class与cls, package与pkg, content-desc与des----------//
//"text":"紫猫学院", 表示抓抓上的text值为紫猫学院
//"text":{"紫猫学院", "zimaoxy.com"}, 表示抓抓上的text值为 紫猫学院 或者 zimaoxy.com, 支持任意数量个
//text的缩写是txt, 即 txt:"紫猫" 与 text:"紫猫" 是相同意思
//resource-id, class, package, content-desc均与text类似, 都分别代表抓抓上的键值对
//res, cls, pkg, des分别对应以上键名的缩写

//----------布尔型元素----------//
//所有抓抓上的布尔型元素均暂无缩写, 保持与抓抓一致即可

//----------坐标特征----------//
//所有范围默认5个像素坐标的误差
//"bounds":{100,200,300,400}, 表示查找范围左上角100,200,右下角300,400以内的元素, 受范围误差影响
//"bounds":{ {10,20,30,40}, {50,60,70,80} }, 表示查找 范围10,20,30,40 或者 范围50,60,70,80 内的元素, 受范围误差影响
//"size":{100,200}, 表示查找长度100, 宽度200形状的元素, 受范围误差影响
//"size":{ {10,20}, {40,60} }, 表示查找 长度10,宽度20 或 长度40,宽度60 形状的元素, 受范围误差影响
//"xy":{10, 20}, 表示查找坐标点10, 20位置的元素, 受范围误差影响
//"xy":{ {10, 20}, {33, 55} }, 表示查找坐标点 10,20 或者 33,55 位置的元素, 受范围误差影响

//----------自定义参数----------//
//"ischild":true, 默认true, 表示只查最终元素, 改为false将查所有元素
//"timeout":0, 默认0, 表示查找超时时间
//"matchmode":-1, 默认-1, 表示查找模式, -1为完整匹配, -2为正常匹配
//"offsetlen":5, 默认5, 表示范围相关参数默认误差5个像素坐标


//下面是表示限时5秒内查找index范围在10到40之间, text值为按键精灵或按键精灵高级版的元素
//适当使用index可以提高查找效率与准确率, 但请注意, 不同设备或者不同界面内容的情况下, index值可能会变化
Dim 按键对象 = {"id":{ {10,40} }, "text":{"按键精灵", "按键精灵高级版"} }
Dim 按键元素 = zm.ElementFindS(按键对象, 5000)
If 按键元素 Then 
	TracePrint "找到按键的坐标为:", 按键元素["x"], ",", 按键元素["y"], ", text值是", 按键元素["text"]
Else 
	TracePrint "没找到按键"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>关于对象参数<br>
  多个对象为 `OR` 关系, 内部依次循环查找每一个对象, 任何一个被找到则立即返回<br>
  当存在多个超时时间时, 仅最大的时间会生效, 限时内会不断查找每一个对象<br>
关于元素特征串<br>
  对象中元素特征串必须与元素名一一对应, 若不填写则忽略该元素<br>
关于最终元素<br>
  最终元素是指没有子节点的元素, 也就是抓抓里看到前面没有 `+` 或 `-` 的元素<br>
关于Index<br>
  不同画面或不同设备的Index均可能会出现变化, 故使用前请务必详细测试<br>
关于旋转横屏坐标处理<br>
  如果遇到打开某个应用后, 屏幕方向被旋转了, 导致获取元素中心坐标异常时, 请使用  <a href="https://zimaoxy.com/m/post/zm.elementrotation/" target="_blank">zm.elementrotation</a>  解决<br>
需按键精灵V3.5.8以上版本支持本命令<br>
V4.2113: 初次加入</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="ElementFindSTap" id="ElementFindSTap"> <a href="https://zimaoxy.com/m/post/zm.elementfindstap/" target="_blank">zm.ElementFindSTap 超级查找元素并点击(专业版)</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>- 与 <a href="https://zimaoxy.com/m/post/zm.elementfindstap/" target="_blank">zm.elementfindstap</a> 的唯一区别是找到后立即点击该坐标<br>- 与 <a href="https://zimaoxy.com/m/post/zm.elementfindtap/" target="_blank">zm.elementfindtap</a> 的区别是支持抓抓上所有特征串, 但仅支持键值对形式的对象参数, 并且对每个键名与键值做了详细规定, 详见代码例子<br>- 支持index范围查找, 一些特征不明显的直接用index元素秒杀<br>- 支持抓抓上的所有特征串, 详细写法见参数说明与代码例子<br>- 同一个键名允许填写多个键值, 多个之间为或关系, 详见代码例子<br>- 大量键名支持简写方式, 详见代码例子<br>- 除了返回抓抓上显示的元素特征信息外, 还有中心坐标, index等数据<br>- 支持指定范围查找, 再也不用担心找到范围外的元素节点了, 甚至直接获取指定范围内的节点<br>- 支持指定坐标查找, 直接获取该坐标点的元素节点, 不用再考虑特征串之类的了<br>- 除了支持普通的完整匹配外, 还支持正则匹配模式, 让元素特征串更加灵活<br>- 默认仅获取最终子节点, 避免干扰, 但你也可以改为获取任意一个符合条件的节点<br>- 担心查找的时候节点还没出现? 限时循环查找完美解决这个问题</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.ElementFindSTap(元素对象[, ...][, 超时时间])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">元素对象: 表, 要查找的元素特征表, 支持多个元素对象参数, 每个对象之间为或关系, 格式为`{"index":0,"text":"","resource-id":"","class":"","package":"","content-desc":"","checkable":true,"checked":true,"clickable":true,"enabled":true,"focusable":true,"focused":true,"scrollable":true,"long-clickable":true,"password":true,"selected":true,"bounds":{0,0,0,0},"xy":{0,0},"size":{0,0},"ischild":true,"matchmode":0,"timeout":0}`, 每个成员均是可选的, 具体定义详见代码例子<br>超时时间: 数值型, 可选, 最大查找时间, 如果每个对象内都有超时时间的话, 将仅使用最大的时间做判断</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 找到返回元素特征表, 没找到返回 `null`, 元素特征表格式为 `{"x":0,"y":0,"id":0,"xy":[0,0]"index":0,"text":"","resource-id":"","class":"","package":"","content-desc":"","checkable":true,"checked":true,"clickable":true,"enabled":true,"focusable":true,"focused":true,"scrollable":true,"long-clickable":true,"password":true,"selected":true,"bounds":[0,0,0,0],"left":0,"top":0,"right":0,"bottom":0,"pos":[0,0]}` , 其中 `"x"`, `"y"` 代表找到元素节点的中心位置坐标, 可用于tap点击, `"id"` 代表多个对象情况下找到的那个序号</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeElementFindSTap');">复制代码</div>
                <pre id="codeElementFindSTap">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//本命令与zm.ElementFind()相似, 但是区别在于更加专业严谨
//元素特征表除了抓抓上的键值对外, 还增加了一些缩写与新键值对参数
//填写相关元素特征则查找, 若不填写则忽略

//----------index与id----------//
//"index":10, 表示抓抓上的index值为10
//"index":{10,20}, 表示抓抓上index值为10或者20, 支持任意数量个
//"index":{ {20, 30} }, 表示抓抓上index的范围在20到30之间, 包括20和30
//"index":{ {20, 30}, {40, 80} }, 表示抓抓上index的范围在20到30或者40到80之间, 支持任意数量个
//index的缩写是id, 即 "id":10 与 "index":10 是相同的意思.

//----------text与txt, resource-id与res, class与cls, package与pkg, content-desc与des----------//
//"text":"紫猫学院", 表示抓抓上的text值为紫猫学院
//"text":{"紫猫学院", "zimaoxy.com"}, 表示抓抓上的text值为 紫猫学院 或者 zimaoxy.com, 支持任意数量个
//text的缩写是txt, 即 txt:"紫猫" 与 text:"紫猫" 是相同意思
//resource-id, class, package, content-desc均与text类似, 都分别代表抓抓上的键值对
//res, cls, pkg, des分别对应以上键名的缩写

//----------布尔型元素----------//
//所有抓抓上的布尔型元素均暂无缩写, 保持与抓抓一致即可

//----------坐标特征----------//
//所有范围默认5个像素坐标的误差
//"bounds":{100,200,300,400}, 表示查找范围左上角100,200,右下角300,400以内的元素, 受范围误差影响
//"bounds":{ {10,20,30,40}, {50,60,70,80} }, 表示查找 范围10,20,30,40 或者 范围50,60,70,80 内的元素, 受范围误差影响
//"size":{100,200}, 表示查找长度100, 宽度200形状的元素, 受范围误差影响
//"size":{ {10,20}, {40,60} }, 表示查找 长度10,宽度20 或 长度40,宽度60 形状的元素, 受范围误差影响
//"xy":{10, 20}, 表示查找坐标点10, 20位置的元素, 受范围误差影响
//"xy":{ {10, 20}, {33, 55} }, 表示查找坐标点 10,20 或者 33,55 位置的元素, 受范围误差影响

//----------自定义参数----------//
//"ischild":true, 默认true, 表示只查最终元素, 改为false将查所有元素
//"timeout":0, 默认0, 表示查找超时时间
//"matchmode":-1, 默认-1, 表示查找模式, -1为完整匹配, -2为正常匹配
//"offsetlen":5, 默认5, 表示范围相关参数默认误差5个像素坐标


//下面是表示限时5秒内查找index范围在10到40之间, text值为按键精灵或按键精灵高级版的元素
//适当使用index可以提高查找效率与准确率, 但请注意, 不同设备或者不同界面内容的情况下, index值可能会变化
Dim 按键对象 = {"id":{ {10,40} }, "text":{"按键精灵", "按键精灵高级版"} }
Dim 按键元素 = zm.ElementFindSTap(按键对象, 5000)
If 按键元素 Then 
	TracePrint "找到并点击按键的坐标为:", 按键元素["x"], ",", 按键元素["y"], ", text值是", 按键元素["text"]
Else 
	TracePrint "没找到按键"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>关于对象参数<br>
  多个对象为 `OR` 关系, 内部依次循环查找每一个对象, 任何一个被找到则立即返回<br>
  当存在多个超时时间时, 仅最大的时间会生效, 限时内会不断查找每一个对象<br>
关于元素特征串<br>
  对象中元素特征串必须与元素名一一对应, 若不填写则忽略该元素<br>
关于最终元素<br>
  最终元素是指没有子节点的元素, 也就是抓抓里看到前面没有 `+` 或 `-` 的元素<br>
关于Index<br>
  不同画面或不同设备的Index均可能会出现变化, 故使用前请务必详细测试<br>
关于旋转横屏坐标处理<br>
  如果遇到打开某个应用后, 屏幕方向被旋转了, 导致获取元素中心坐标异常时, 请使用  <a href="https://zimaoxy.com/m/post/zm.elementrotation/" target="_blank">zm.elementrotation</a>  解决<br>
需按键精灵V3.5.8以上版本支持本命令<br>
V4.2113: 初次加入</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="ElementFindTap" id="ElementFindTap"> <a href="https://zimaoxy.com/m/post/zm.elementfindtap/" target="_blank">zm.ElementFindTap 超级查找元素点击</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>与 <a href="https://zimaoxy.com/m/post/zm.elementfind/" target="_blank">zm.elementfind</a> 相比, 仅多了一个找到后立即点击的功能, 其它都相同, 点击会受 <a href="https://zimaoxy.com/m/post/zm.settap/" target="_blank">zm.settap</a> 设置影响.<br><br>根据条件查找元素节点并点击, 返回元素节点表信息与中心坐标等数据. 比 `Element.Find()` 更加强大, 具体特色如下<br><br>- 找到后内部会调用 <a href="https://zimaoxy.com/m/post/zm.tap/" target="_blank">zm.tap</a> 点击找到的坐标<br>- 除了返回抓抓上显示的元素特征信息外, 还有中心坐标, index等数据<br>- 支持指定范围查找, 再也不用担心找到范围外的元素节点了, 甚至直接获取指定范围内的节点<br>- 支持指定坐标查找, 直接获取该坐标点的元素节点, 不用再考虑特征串之类的了<br>- 支持抓抓上的五大元素特征串, 分别是 `text`, `resource-id`, `class`, `package`, `content-desc`, 这5个元素特征串可自由填写任意数量, 且没有顺序要求, 每个特征串之间为 `And` 关系<br>- 除了支持普通的完整匹配外, 还支持正则匹配模式, 让元素特征串更加灵活<br>- 默认仅获取最终子节点, 避免干扰, 但你也可以改为获取任意一个符合条件的节点<br>- 担心查找的时候节点还没出现? 限时循环查找完美解决这个问题<br>- 大量可选参数, 减少不必要的代码量<br>- 支持对象参数写法, 将所有参数保存到一张表里, 直接传入该表, 方便优化代码结构</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.ElementFindTap([对象, ...][x1,y1,x2,y2,][元素特征, ...][指定坐标x,指定坐标y,][是否最终元素,][匹配模式][,超时时间])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象: 表, 可选, 对象是指把查找一个元素用到的参数全部放到数组中, 然后用该数组做对象参数. 若要填写对象参数, 则必须写在最前面, 填写后将忽略除超时参数以外的其他普通参数. 支持多个对象参数, 每个对象为 `OR` 关系, 找到任何一个对象立即返回结果<br>x1: 数值型, 可选, 查找范围左上角x, 元素节点必须完全在范围内, 不能超出范围, 省略默认为0, 范围0,0,0,0表示全屏<br>y1: 数值型, 可选, 查找范围左上角y, 元素节点必须完全在范围内, 不能超出范围, 省略默认为0, 范围0,0,0,0表示全屏<br>x2: 数值型, 可选, 查找范围右下角x, 元素节点必须完全在范围内, 不能超出范围, 省略默认为0, 范围0,0,0,0表示全屏<br>y2: 数值型, 可选, 查找范围右下角y, 元素节点必须完全在范围内, 不能超出范围, 省略默认为0, 范围0,0,0,0表示全屏<br>元素特征: 字符串, 可选, 抓抓上获取到的元素特征值, 支持 `text`, `resource-id`, `class`, `package`, `content-desc`这5个对应特征值, 可自由填写0到5个元素特征参数, 无顺序要求, 同个对象每个特征之间为 `AND` 关系, 内部忽略特征名, 只判断特征值, 详见例子<br>指定坐标x: 数值型, 可选, 直接获取指定坐标上的元素特征串, 省略默认为0, 指定坐标0,0表示不使用本参数<br>指定坐标y: 数值型, 可选, 直接获取指定坐标上的元素特征串, 省略默认为0, 指定坐标0,0表示不使用本参数<br>是否最终元素: 布尔型, 可选, 是否只获取没有子节点的最终元素节点, 省略默认为true, 表示只获取没有子节点的最终元素元素<br>匹配模式: 数值型, 可选, 元素特征的匹配模式, -1表示直接比较是否相等的完整匹配模式, -2表示正则匹配是否符合的正则模式, 省略默认为-1<br>超时时间: 数值型, 可选, 最大查找时间, 如果每个对象内都有超时时间的话, 将仅使用最大的时间做判断</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 找到返回元素特征表, 没找到返回 `null`, 元素特征表格式为 `{"x":0,"y":0,"id":0,"xy":[0,0]"index":0,"text":"","resource-id":"","class":"","package":"","content-desc":"","checkable":true,"checked":true,"clickable":true,"enabled":true,"focusable":true,"focused":true,"scrollable":true,"long-clickable":true,"password":true,"selected":true,"bounds":[0,0,0,0],"left":0,"top":0,"right":0,"bottom":0,"pos":[0,0]}` , 其中 `"x"`, `"y"` 代表找到元素节点的中心位置坐标, 可用于tap点击, `"id"` 代表多个对象情况下找到的那个序号</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeElementFindTap');">复制代码</div>
                <pre id="codeElementFindTap">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//本命令与zm.ElementFind()类似, 仅多了一个找到后立即点击功能, 故详细例子请去查看zm.ElementFind()命令

//下面演示打开京东搜索电脑, 获取第一件商品价格的例子
RunApp "com.jingdong.app.mall"

If zm.ElementFindTap("^搜索框.*", "com.jingdong.app.mall", "android.widget.TextView", -2, 5000) Then 
	TracePrint "找到搜索框, 并已点击"
Else 
	TracePrint "没找到搜索框"
End If

Delay 1000
InputText "电脑"
Delay 1000
If zm.ElementFindTap("搜索", "android.widget.TextView", "com.jingdong.app.mall") Then 
	TracePrint "找到搜索按钮, 并已点击"
Else 
	TracePrint "没找到搜索按钮"
End If

Dim 价格对象 = {"%d+", "%d+元", "android.widget.TextView","com.jingdong.app.mall", -2, 10000}
Dim 价格元素 = zm.ElementFind(价格对象)
If 价格元素 Then 
	TracePrint "找到第一件商品的价格为:", 价格元素["text"]
Else 
	TracePrint "没找到商品"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>关于参数填写顺序说明<br>
  本插件所有参数都是可选的, 绝大多数参数对顺序没有要求, 但以下3个参数有顺序要求<br>
  ( `查找范围`, `指定坐标`, `超时时间` )<br>
  这3个参数均为可选参数, 中间也可以填写其他参数, 但是前后关系不能打乱, 下面举几个例子<br>
  正确例子: ( `查找范围`, `超时时间`), (`指定坐标`, `元素特征`, `超时时间`), (`查找范围`, `元素特征`)<br>
  错误例子: (`超时时间`, `查找范围`), (`查找范围`, `超时时间`, `指定坐标`), (`指定坐标`, `元素特征`, `查找范围`)<br>
  如果无法理解的话, 建议按照语法说明的参数顺序填写<br>
关于对象参数<br>
  对象参数必须从第1个位置开始填写, 并且填写后除了超时时间外的其他普通参数全都忽略<br>
  多个对象为 `OR` 关系, 内部依次循环查找每一个对象, 任何一个被找到则立即返回<br>
  当存在多个超时时间时, 仅最大的时间会生效, 限时内会不断查找每一个对象<br>
关于元素特征串<br>
  支持抓抓上的`text`, `resource-id`, `class`, `package`, `content-desc`<br>
  填写数量自定义, 你可以只写1个, 也可以写3个, 甚至都不写或者全都写.<br>
  查找时忽略特征名, 只找特征值, 例如你填写了 `"微信"`, 那么有可能找到 `text` 是 `微信` 的元素, 或者 `content-desc` 是 `微信` 的元素.<br>
  查找时要求填写的特征全都要找到才算符合条件, 包括填写空字符串 `""`, 也会要求找到对应空字符串<br>
  两个特征值一样的也会查找, 例如你填写了 `"微信", "微信"`, 那么查找的时候就会去找元素特征里存在两个 `微信` 的元素<br>
关于最终元素<br>
  最终元素是指没有子节点的元素, 也就是抓抓里看到前面没有 `+` 或 `-` 的元素<br>
关于旋转横屏坐标处理<br>
  如果遇到打开某个应用后, 屏幕方向被旋转了, 导致获取元素中心坐标异常时, 请使用  <a href="https://zimaoxy.com/m/post/zm.elementrotation/" target="_blank">zm.elementrotation</a>  解决<br>
需按键精灵V3.5.8以上版本支持本命令<br>
V4.2111: 初次加入</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="ElementRotation" id="ElementRotation"> <a href="https://zimaoxy.com/m/post/zm.elementrotation/" target="_blank">zm.ElementRotation 设置元素旋转方向</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>设备旋转后元素的坐标系与触摸的坐标系也许会不一样, 本命令将对最后一步得到元素中心坐标做旋转处理, 其他坐标例如范围之类不做处理.<br><br>当存在传入x,y坐标参数时, 仅对本次传入坐标转换, 不会处理元素命令坐标转换.</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.ElementRotation(方向[, x, y][, ...])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">方向: 数值型, 设备的逆时针旋转方向, 默认为0, 表示未旋转, 支持 `-1, 0, 1, 2, 3, 90, 180, 270` 这几个数值, `-1`表示自动判断旋转方向, `0`表示未旋转, `1`或`90`表示逆时针旋转90°, `2`或`180`表示逆时针旋转180°, `3`或`270`表示逆时针旋转270°, 推荐填`-1`<br>x: 数值型, 可选, 要转换的x坐标, 必须与y坐标一起填写, 支持任意数量坐标<br>yx: 数值型, 可选, 要转换的y坐标, 必须与x坐标一起填写, 支持任意数量坐标</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表: 当有转换坐标参数时, 返回转换后的坐标数组</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeElementRotation');">复制代码</div>
                <pre id="codeElementRotation">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//自动识别设备的旋转方向, 使接下来超级元素命令得到的元素中心坐标为可以Tap点击的坐标
zm.ElementRotation(-1)

//接下来的紫猫插件超级元素节点命令请自行编写
```

```qscript
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//自动识别设备的旋转方向, 返回传入坐标的转换结果, 对后面超级节点元素命令没有任何影响
Dim xy = zm.ElementRotation(-1, 100, 200, 300, 400)
TracePrint xy[1], xy[2], xy[3], xy[4]</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V4.2114: <br>
  初次加入<br>
  需在执行超级元素命令之前设置, 一般建议参数填-1, 让设备自动识别处理<br>
V4.2118: 加入转换指定坐标参数</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="CatchTouchPoint" id="CatchTouchPoint"> <a href="https://zimaoxy.com/m/post/zm.catchtouchpoint/" target="_blank">zm.CatchTouchPoint 获取点击坐标</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>获取屏幕上手指点击的坐标(命令为阻塞状态), 解决自带命令获取结果不准确的问题</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.CatchTouchPoint([次数])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">次数: 数值型, 可选, 省略默认为1, 表示需要获取用户点击的次数。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数值表_ ，返回点击的坐标表，格式为`[点击数][坐标]`，详见示例。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeCatchTouchPoint');">复制代码</div>
                <pre id="codeCatchTouchPoint">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim 坐标表 = zm.CatchTouchPoint(2)
TracePrint "第1个点x坐标：", 坐标表[1][1]
TracePrint "第1个点y坐标：", 坐标表[1][2]
TracePrint "第2个点x坐标：", 坐标表[2][1]
TracePrint "第2个点y坐标：", 坐标表[2][2]</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>如果你发现  <a href="https://zimaoxy.com/m/post/catchtouchpoint/" target="_blank">catchtouchpoint</a>  获取的坐标不准确, 请尝试使用本命令 `zm.CatchTouchPoint()`<br>
<br>
V4.2039: 初次加入</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="Delay" id="Delay"> <a href="https://zimaoxy.com/m/post/zm.delay/" target="_blank">zm.Delay 超级延时</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>脚本暂停延时一段时间，支持防检测的随机延迟时长。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.Delay(时长1[, 时长2])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">时长1: 数值型, 需要延迟的最小时间，单位毫秒。<br>时长2: 数值型, 可选参数，需要延迟的最大时间，单位毫秒，省略默认为时长1的值。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数值型_ ，最终随机到延迟的时长。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeDelay');">复制代码</div>
                <pre id="codeDelay">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

zm.RndInitSeed() //初始化随机种子，只需执行一次，也可以使用zm.Init()初始化
TracePrint "固定延迟一段时间"
zm.Delay(1000) //固定延迟1000毫秒
TracePrint "随机延迟一段时间"
zm.Delay(1000, 2000) //随机延迟1000到2000毫秒
TracePrint "延迟结束"</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>大部分游戏检测属于行为检测，比如每隔固定一段时间就执行操作内容之类，所以需要使用随机延迟时间。<br>
V1.1722: 插件加入本命令<br>
V1.1730: 修复报错问题<br>
v3.1929: 延时小于0的报错改为直接延时0毫秒</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="GetScreenScale" id="GetScreenScale"> <a href="https://zimaoxy.com/m/post/zm.getscreenscale/" target="_blank">zm.GetScreenScale 获取超级缩放状态</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>获取通过 <a href="https://zimaoxy.com/m/post/zm.setscreenscale/" target="_blank">zm.setscreenscale</a> 和 <a href="https://zimaoxy.com/m/post/zm.resetscreenscale/" target="_blank">zm.resetscreenscale</a> 设置的超级缩放状态, 对按键自带的缩放命令无效</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.GetScreenScale()</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">无</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数值型_ , -1表示没有缩放; 0表示传入坐标缩放, 传出坐标不缩放; 1表示传入坐标缩放, 传出坐标反向缩放</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeGetScreenScale');">复制代码</div>
                <pre id="codeGetScreenScale">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

If zm.GetScreenScale() = -1 Then
  TracePrint "没有缩放"
Else
  TracePrint "缩放中"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>对按键自带缩放无效, 仅支持超级缩放状态。<br>
V1.1803: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="ResetScreenScale" id="ResetScreenScale"> <a href="https://zimaoxy.com/m/post/zm.resetscreenscale/" target="_blank">zm.ResetScreenScale 取消超级缩放</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>取消屏幕比例缩放设置, 一般与 <a href="https://zimaoxy.com/m/post/zm.setscreenscale/" target="_blank">zm.setscreenscale</a> 配套使用。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.ResetScreenScale()</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">无</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeResetScreenScale');">复制代码</div>
                <pre id="codeResetScreenScale">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//在720x1280分辨率下开发脚本的超级缩放
zm.SetScreenScale 720, 1280

//取消超级缩放
zm.ResetScreenScale</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1803: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="SetDelay" id="SetDelay"> <a href="https://zimaoxy.com/m/post/zm.setdelay/" target="_blank">zm.SetDelay 设置超级延时</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>设置超级延时zm.Delay()的默认值, 设置一次后, 所有zm.Delay()均受影响</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.SetDelay(属性表)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">属性表: 表, 例如{“min”:-50, “max”:50}表示所有zm.Delay()函数随机浮动-50到50之间, 更多属性见下面表格<br><br>属性 | 默认值 | 数据类型 | 解释<br>---|-----|------|---<br>min | 0 | 数值型 | 随机浮动最小值<br>max | 0 | 数值型 | 随机浮动最大值<br>time | 0 | 数值型 | 默认延时时间<br></td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 返回设置后的参数列表, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeSetDelay');">复制代码</div>
                <pre id="codeSetDelay">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//设置一次后, 所有zm.Delay都有效, 除非再次改变设置
zm.SetDelay({"min":-30, "max":40})
zm.Delay(100)  //表示随机延时(100-30)到(100+40)毫秒范围

zm.SetDelay({"min":-30, "max":40})
zm.Delay(100, 200)  //表示随机延时100到200毫秒范围, 不受默认值影响

zm.SetDelay({"min":-30, "max":40})
zm.Delay(100, true)  //表示固定延时100毫秒, 不要随机

zm.SetDelay({"min":-300, "max":400, "time":1000})
zm.Delay()   //表示随机延迟(1000-300)到(1000+400)毫秒范围
</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>设置一次后, 所有zm.Delay都有效, 除非再次改变设置<br>
V3.1853: 初次加入命令<br>
V4.2025: 仅对`zm.Delay()`有效, 对其他命令均无效</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="SetScreenScale" id="SetScreenScale"> <a href="https://zimaoxy.com/m/post/zm.setscreenscale/" target="_blank">zm.SetScreenScale 超级缩放</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>与按键自带的 <a href="https://zimaoxy.com/m/post/setscreenscale/" target="_blank">setscreenscale</a> 相比, 多了对zm.FindPic()和zm.FindStr()的支持, 另外还可以使用 <a href="https://zimaoxy.com/m/post/zm.getscreenscale/" target="_blank">zm.getscreenscale</a> 获取缩放状态.<br><br>缩放找图和缩放找字仅针对传入与传出坐标进行缩放, 对应的图片与字库请自行设置多套数据供命令调用.</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.SetScreenScale(开发宽度, 开发高度[, 输出缩放])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">开发宽度: 数值型, 开发脚本时使用的设备横向分辨率。<br>开发高度: 数值型, 开发脚本时使用的设备纵向分辨率。<br>输出缩放: 数值型, 可选参数，默认为1。0表示只对传入函数的坐标（如范围坐标等）进行缩放，从函数传出的坐标（如返回坐标等）不缩放，即为当前设备的真实坐标。1表示对传入的坐标（如范围坐标等）进行缩放，对函数传出的坐标（如返回坐标）进行反向缩放。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeSetScreenScale');">复制代码</div>
                <pre id="codeSetScreenScale">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//普通找色点击情况与按键自带例子的SetScreenScale()相同, 这里就不演示了
//下面是找图找字功能缩放的演示

'设置开发分辨率进行超级缩放
zm.SetScreenScale 720, 1280

'附件中存放各个分辨率的图片, 图片文件名格式为: 横向分辨率x纵向分辨率xDPI数值-图片名.png
Dim 图片前缀 = "Attachment:" & GetScreenX() & "x" & GetScreenY() & "x" & Device.GetDPI() & "-"
TracePrint "本设备的图片默认前缀为:", 图片前缀

'设置找图的图片前缀
zm.SetFindPic {"pic":图片前缀}

If zm.FindPic("图片1.png|Attachment:图片2.png|/sdcard/图片3.png", "显示") Then
    '如果只写图片名的话, 插件就会自动帮你把图片前缀加上去, 比如图片1.png会自动加前缀
    '通过不同分辨率不同图片文件名的方式实现调用查找对应图片
    '而图片2和图片3由于是完整路径, 所以就没有自动加图片前缀了
    TracePrint "找到图片了"
Else
    TracePrint "没找到图片"
End If

'附件中存放各个分辨率下的字库文件, 文件名格式与图片相同: 横向分辨率x纵向分辨率xDPI数值-字库.txt
Dim 字库前缀 = "Attachment:" & GetScreenX() & "x" & GetScreenY() & "x" & Device.GetDPI() & "-"
TracePrint "本设备的图片默认前缀为:", 字库前缀

'设置字库
ret = SetDictEx(0, 字库前缀 & "紫猫学院字库.txt")
TracePrint "0号字库设置结果:", ret
ret = UseDict(0)
TracePrint "切换0号字库设置结果:", ret

If zm.FindStr("紫猫", "FFFFFF", "显示") Then
    TracePrint "找到文字了"
Else
    TracePrint "没找到文字"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1803: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="SetShowLog" id="SetShowLog"> <a href="https://zimaoxy.com/m/post/zm.setshowlog/" target="_blank">zm.SetShowLog 设置日志输出</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>修改所有日志显示输出的默认参数值，支持以`显示|隐藏`做日志参数的命令。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">默认值 = zm.SetShowLog(显示隐藏)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">显示隐藏: 字符串_&#124;_布尔值, 可取以下[true, false, "显示", "隐藏", "show", "hide"]几个值</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 返回设置的默认参数值</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeSetShowLog');">复制代码</div>
                <pre id="codeSetShowLog">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//设置后, 对所有带有日志输出显示参数的命令生效
zm.SetShowLog "显示"
zm.FindColor "123456"
zm.FindMultiColor "123456", "1|1|000000"
zm.FindPic "紫猫.bmp"
zm.FindStr "学|院", "隐藏"</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1741: 加入命令<br>
V2.1829: 支持布尔值参数设置是否显示</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="SetTap" id="SetTap"> <a href="https://zimaoxy.com/m/post/zm.settap/" target="_blank">zm.SetTap 设置超级点击</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>修改  <a href="https://zimaoxy.com/m/post/zm.tap/" target="_blank">zm.tap</a>  的默认参数值, 并影响超级图色命令中的点击参数效果</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.SetTap(属性表)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">属性表: 表, 按照指定格式对表中的键值对进行赋值, 例如{"t":2000, "showlog":"显示"}表示修改点击后默认延时时间为3000毫秒, 日志输出默认为显示, 更多属性见下面表格<br><br>属性 | 默认值 | 数据类型 | 解释<br>---|-----|------|---<br>minx | 0 | 数值型 | 点击x坐标的浮动随机数<br>maxx | 0 | 数值型 | 点击x坐标的浮动随机数<br>miny | 0 | 数值型 | 点击y坐标的浮动随机数<br>maxy | 0 | 数值型 | 点击y坐标的浮动随机数<br>t | 0 | 数值型 | 点击后默认延时时间, 单位毫秒<br>mintouch | 0 | 数值型 | 点击时, 按下与弹起之间的最小时间间隔, 单位毫秒<br>maxtouch | 50 | 数值型 | 点击时, 按下与弹起之间的最大时间间隔, 单位毫秒<br>norandom | false | 布尔型 | 是否禁用随机, 填写true后, 所有点击都失去随机效果<br>showlog | "隐藏" | 字符串 | 日志输出显示, 可选["显示","隐藏","show","hide"]这几个值<br></td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 返回设置后的参数列表, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeSetTap');">复制代码</div>
                <pre id="codeSetTap">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//点击固定坐标100,200
zm.Tap 100, 200

//点击固定坐标100,200后延时3000毫秒
zm.Tap 100, 200, 3000

//在范围100,200,150,250内随机点击某个点, 并显示输出
zm.Tap 100, 200, 150, 250, "show"

//在范围100,200,150,250内随机点击某个点后延时4000毫秒
zm.Tap 100, 200, 150, 250, 4000

//设置固定坐标x浮动范围[-10,15], 固定坐标y浮动范围[-5,20], 点击后默认延时2000毫秒
zm.SetTap {"minx":-10, "maxx":15, "miny":-5, "maxy":20, "t":2000}

//x从100-10到100+15中随机取值, y从200-5到200+20中随机取值, 点击后默认延时2000毫秒
zm.Tap 100, 200

//在范围100,200,150,250内随机点击某个点并默认延时2000毫秒, 不受默认浮动范围影响
Dim t = zm.Tap(100, 200, 150, 250)
//查看实际点击坐标
TracePrint zm.VarInfo(t)

//设置按下与弹起之间的时间间隔为10到30毫秒, 默认日志输出为显示
zm.SetTap {"mintouch":10, "maxtouch":30, "showlog":"显示"}

//x从100-10到100+15中随机取值, y从200-5到200+20中随机取值, 点击后延时3000毫秒
zm.Tap 100, 200, 3000</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1802: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="ShowMessage" id="ShowMessage"> <a href="https://zimaoxy.com/m/post/zm.showmessage/" target="_blank">zm.ShowMessage 超级浮窗</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>与自带的命令相比, 加入了依次显示信息和倒计时功能</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.ShowMessage(信息[, 显示时长][, x, y][, 倒计间隔])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">信息: table_或_string, 浮窗显示的内容, 如果是字符串, 当包含"#时间"时将启用倒计时功能; 如果是表, 则在显示时间内依次遍历显示<br>显示时长: number, 可选, 在屏幕上显示总时长, 单位毫秒, 省略默认3000毫秒<br>x: number, 可选, 设置显示框在屏幕上的左上角X坐标, 省略默认为屏幕中间<br>y: number, 可选, 设置显示框在屏幕上的左上角Y坐标, 省略默认为屏幕中间<br>倒计间隔: number, 可选, 填写必须小于0, 表示倒计时步长, 省略默认为-1000毫秒</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeShowMessage');">复制代码</div>
                <pre id="codeShowMessage">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//倒计时5秒, 脚本也会对应延时5秒
zm.ShowMessage("脚本将在 #时间 秒后启用", 5000)

//遍历循环显示内容, 总耗时10秒, 脚本也会对应延时10秒
zm.ShowMessage({"1.先打开app", "2.点击登录", "3.输入帐号密码", "4.点击确定"}, 10*1000)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V3.1902: 初次加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="Swipe" id="Swipe"> <a href="https://zimaoxy.com/m/post/zm.swipe/" target="_blank">zm.Swipe 超级划动</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>快速精准无惯性的模拟划动操作，可切换模式支持网页划动。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.Swipe(横坐标x1, 纵坐标y1, 横坐标x2, 纵坐标y2[, 划动耗时[, 轨迹次数]][, 按住时间][, 模式][, 禁用轨迹])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">横坐标x1: 数值型, 划动的起点x坐标<br>横坐标y1: 数值型, 划动的起点y坐标<br>横坐标x2: 数值型, 划动的终点x坐标<br>横坐标y2: 数值型, 划动的终点y坐标<br>划动耗时: 数值型, 可选，划动花费的时间，单位毫秒，省略默认为100毫秒<br>轨迹次数: 数值型, 可选，划动轨迹多少次, 省略默认为10, 若填写轨迹次数参数, 则前面必须写耗时参数<br>按住时间: 数值型, 可选, 第一点按住不放一段时间后再移动, 格式为小于-50的负数, 例如-500表示按住500毫秒, 省略默认为-50<br>模式: 数值型, 可选，-1为普通模拟，-2为硬件模拟，-3为翻页模拟, -4为空格翻页, -5为导航移动, 当普通模式无法划动时，可以试下切换至其他模式，省略默认为-1<br>禁用轨迹: 布尔型, 可选，是否模拟真实带轨迹移动, 对翻页模式无效, 省略默认为false表示禁用, 启用后耗时参数将会失效</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeSwipe');">复制代码</div>
                <pre id="codeSwipe">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//用时500毫秒,从坐标100,500精准划动到坐标100,200
zm.Swipe 100, 500, 100, 200, 500

//当遇到默认普通模式划动失效时，例如浏览器网页之类的，可以试下硬件模拟。
zm.Swipe 100, 500, 100, 200, 500, -2

//当遇到默认普通模式划动失效时，例如浏览器网页之类的，可以试下翻页模拟。
zm.Swipe 100, 500, 100, 200, -3

//当遇到默认普通模式划动失效时，例如浏览器网页之类的，可以试下空格翻页模拟。
zm.Swipe 100, 500, 100, 200, -4

//当遇到默认普通模式划动失效时，例如浏览器网页之类的，可以试下导航移动模拟。
zm.Swipe 100, 500, 100, 200, -5

//遇到滑块验证等检测轨迹操作时, 可以开启轨迹功能
zm.Swipe 100, 200, 400, 200, true</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>与 <a href="https://zimaoxy.com/m/post/swipe/" target="_blank">swipe</a> 相比，本命令加入了无惯性与硬件模拟特点，可以实现精准定位划动，并且支持特殊页面与模拟真实轨迹操作。<br>
一般情况下推荐使用普通模拟划动，除非普通模拟失效了，才考虑使用硬件模拟或翻页模拟。<br>
滑块验证等操作推荐开启轨迹功能。<br>
V1.1722: 插件加入本命令<br>
V1.1730: 修复报错问题<br>
V1.1750: 加入翻页模拟模式<br>
V1.1816: 加入轨迹参数<br>
V1.1821: 提高过滑块验证的准确率, 感谢`.`提供测试<br>
V2.1826: 加入轨迹次数参数<br>
V3.1835: 加入按住时间参数, 移动轨迹支持随机抖动<br>
v3.1852: 加入空格翻页与导航移动模式</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="SwipeEx" id="SwipeEx"> <a href="https://zimaoxy.com/m/post/zm.swipeex/" target="_blank">zm.SwipeEx 多次划动</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>与 <a href="https://zimaoxy.com/m/post/zm.swipe/" target="_blank">zm.swipe</a> 类似, 区别在于本命令支持指定多个坐标划动</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.SwipeEx([xy, ...][, 偏移量][, 划动耗时[, 轨迹次数]][, 按住时间][, 模式][, 禁用轨迹])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">xy: table_ 或 _字符串, 要划动经过的坐标点, 支持多个坐标参数, 格式为`{x, y}` 或 `x,y|x,y|...`, 字符串时可使用任意分隔符, 详见例子<br>偏移量: 字符串, 可选, 坐标的偏移量, 格式为`"±x,±y"`, 默认为`"+0,+0"`, 例如`"+0,-20"`, 表示实际点击传入坐标`x+0,y-20`的位置, 常用于答题上的初始坐标系<br>划动耗时: 数值型, 可选, 每个划动花费的时间, 单位毫秒, 省略默认为`100`毫秒<br>轨迹次数: 数值型, 可选, 每个划动轨迹多少次, 省略默认为`10`, 若填写轨迹次数参数, 则前面必须写耗时参数<br>按住时间: 数值型, 可选, 第一点按住不放一段时间后再移动, 格式为`小于-50`的负数, 例如`-500`表示按住500毫秒, 省略默认为`-50`<br>模式: 数值型, 可选, `-1`为普通模拟，`-2`为硬件模拟, 当普通模式无法划动时, 可以试下切换至硬件模拟, 省略默认为`-1`<br>禁用轨迹: 布尔型, 可选, 是否模拟真实带轨迹移动, 省略默认为false表示禁用</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeSwipeEx');">复制代码</div>
                <pre id="codeSwipeEx">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//以真实轨迹从10,600划动到10,700到200,500到300,800
zm.SwipeEx {10, 600}, {10, 700}, {200, 500}, {300, 800}, True

//以真实轨迹从20,630划动到20,730到220,530到320,830
zm.SwipeEx "10,600|10,700|200,500|300,800", "+10,+30", True

//以真实轨迹从10,600划动到10,700到200,500到300,800
zm.SwipeEx "10,600", "10,700", "200,500", "300,800", True</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V3.1835: 初次加入<br>
V4.2118: 加入字符串坐标格式与偏移量参数</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="Tap" id="Tap"> <a href="https://zimaoxy.com/m/post/zm.tap/" target="_blank">zm.Tap 超级点击</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>比  <a href="https://zimaoxy.com/m/post/tap/" target="_blank">tap</a>  更加强大的命令, 具体特色如下<br><br>- 担心被行为检测导致封号? 多种随机模式搭配防检测<br>- 每次点击后加延时命令麻烦? 直接把延时写到点击中<br>- 分割坐标字符串麻烦? 可以直接传入格式为"x,y"的坐标字符串参数<br>- 支持对象参数写法, 将所有参数保存到一张表里, 直接传入该表<br>- 支持重写, 即传入对象参数后, 再写其他参数将会覆盖对应的对象数据<br>- 省略参数的默认值不理想? 可使用  <a href="https://zimaoxy.com/m/post/zm.settap/" target="_blank">zm.settap</a>  来自定义修改</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.Tap([对象,][坐标字符串][,x, y][, rx, ry][, 延时毫秒][, 禁用随机][, 显示日志][, 输出行号][, 备注])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象: 表, 可选, 把所有参数放入一个table中传入, 若后面跟有其他参数, 则会对应覆盖对象数据<br>坐标字符串: 字符串, 可选, 与下面的x,y参数二选一填写, 坐标格式为`"x,y"`, 省略默认为`null`<br>x: 数值型, 可选, 要点击的x坐标, 填写对象参数后可省略<br>y: 数值型, 可选, 要点击的y坐标, 填写对象参数后可省略<br>rx: 数值型, 可选, 从x到rx范围中随机获取一个数作为横坐标x<br>ry: 数值型, 可选, 从y到ry范围中随机获取一个数作为纵坐标y<br>延时毫秒: 数值型, 可选, 点击后延时时间, 单位毫秒<br>禁用随机: 布尔型, 可选, 填写`true`时禁用任何随机功能, 填写`false`表示不禁用, 省略默认为`false`<br>显示日志: 字符串, 可选, 输出调试日志信息, 省略默认为"隐藏", 支持`["显示","隐藏","show","hide"]`这几个值<br>输出行号: 字符串, 可选, 格式为`"_"`开头后跟行号, 比如`"_10"`表示第10行代码, 输出调试信息窗口显示第几行代码, 需开启显示日志才有效<br>备注: 字符串, 可选, 格式为`"@"`开头后跟内容, 比如`"@拾取屠龙刀"`, 输出调试信息窗口就会增加这条内容, 若连续两个`"@@"`则表示在浮窗中显示信息, 需要开启显示日志才有效</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 返回实际点击的坐标与延时表, 格式为{x,y,t,"x":x,"y":y,"t":t}, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeTap');">复制代码</div>
                <pre id="codeTap">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//点击固定坐标100,200
zm.Tap 100, 200

//点击固定坐标100,200后延时3000毫秒
zm.Tap 100, 200, 3000

//点击字符串坐标100,200后, 延时300毫秒
zm.Tap "100,200", 300

//在范围100,200,150,250内随机点击某个点, 并显示输出
zm.Tap 100, 200, 150, 250, "show"

//在范围100,200,150,250内随机点击某个点后延时4000毫秒
zm.Tap 100, 200, 150, 250, 4000
```

```qscript 例子2
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//设置固定坐标x浮动范围[-10,15], 固定坐标y浮动范围[-5,20], 点击后默认延时2000毫秒
//此设置会都接下来所有zm.Tap()均有影响
zm.SetTap {"minx":-10, "maxx":15, "miny":-5, "maxy":20, "t":2000}
//x从100-10到100+15中随机取值, y从200-5到200+20中随机取值, 点击后默认延时2000毫秒
zm.Tap 100, 200

//在范围100,200,150,250内随机点击某个点并默认延时2000毫秒, 不受默认浮动范围影响
Dim t = zm.Tap(100, 200, 150, 250)
//查看实际点击坐标
TracePrint zm.VarInfo(t)

//设置按下与弹起之间的时间间隔为10到30毫秒, 默认日志输出为显示
//此设置会都接下来所有zm.Tap()均有影响
zm.SetTap {"mintouch":10, "maxtouch":30, "showlog":"显示"}
//x从100-10到100+15中随机取值, y从200-5到200+20中随机取值, 点击后延时3000毫秒
zm.Tap 100, 200, 3000, "@测试点击"</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1802: 加入命令<br>
V1.1816: 支持字符串参数坐标<br>
V2.1829: 点击坐标无效时, 延时不生效</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="TracePrint" id="TracePrint"> <a href="https://zimaoxy.com/m/post/zm.traceprint/" target="_blank">zm.TracePrint 超级调试输出</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>调试输出加强版命令，支持输出数据类型、长度、数组、表。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.TracePrint(...)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">行号: 字符串, 可选参数, 调试显示第几行代码, 格式为`"_行号"`, 例如`"_10"`表示第10行代码<br>参数: 任意类型, 要输出的内容，支持多个参数。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeTracePrint');">复制代码</div>
                <pre id="codeTracePrint">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim a = {1,2,3,4,5}
//如果第一个参数是下划线+行号的字符串，则显示当前脚本第几行。
//支持直接输出表或数组、支持多维数组。
zm.TracePrint "_5", a
//如果第一个参数不是下划线的，则不显示第几行
zm.TracePrint "紫猫"
//输出多个参数也可分别显示每个参数的数据类型、长度、值
zm.TracePrint "_9", "紫猫", "学院", 345911220, a
//也可以使用zm.VarInfo实现类似效果
TracePrint zm.VarInfo(a, "紫猫", null, 345911220)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>由于行号参数过于麻烦，故推荐使用自带输出命令TracePrint配合 <a href="https://zimaoxy.com/m/post/zm.varinfo/" target="_blank">zm.varinfo</a> 命令使用。<br>
支持嵌套表或者多维数组的直接输出，格式是由中括号与大括号组成的。<br>
V1.1720: 插件加入本命令。<br>
V1.1722: 加入显示长度与第几行功能。<br>
V1.1723: 支持嵌套表与多维数组，支持多参数显示信息。<br>
</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="BGRToColor" id="BGRToColor"> <a href="https://zimaoxy.com/m/post/zm.bgrtocolor/" target="_blank">zm.BGRToColor 合成BGR颜色</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>合成三个BGR颜色分量到十六进制BGR字符串中</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.BGRToColor(b, g, r)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">b: 数值型或字符串, 蓝色分量，数值型时表示十进制，字符串时表示十六进制。<br>g: 数值型或字符串, 绿色分量，数值型时表示十进制，字符串时表示十六进制。<br>r: 数值型或字符串, 红色分量，数值型时表示十进制，字符串时表示十六进制。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，合成后的BGR格式颜色</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeBGRToColor');">复制代码</div>
                <pre id="codeBGRToColor">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim c = zm.BGRToColor(10,20,30)
TracePrint c</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1720: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="BGRToRGB" id="BGRToRGB"> <a href="https://zimaoxy.com/m/post/zm.bgrtorgb/" target="_blank">zm.BGRToRGB BGR转RGB</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>BGR格式颜色转换成RGB格式颜色</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.BGRToRGB(bgr)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">bgr: 数值型或字符串, BGR格式的颜色，数值型时表示十进制，字符串时表示十六进制。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，返回转换后的RGB格式颜色</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeBGRToRGB');">复制代码</div>
                <pre id="codeBGRToRGB">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim c = zm.BGRToRGB("FF00AA")
TracePrint c</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1720: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="ColorSim" id="ColorSim"> <a href="https://zimaoxy.com/m/post/zm.colorsim/" target="_blank">zm.ColorSim 计算颜色相似度</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>获取两个颜色之间的相似度, 注意两个参数颜色格式必须一致, 可能与按键自带的相似度算法不同</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.ColorSim(颜色1, 颜色2)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">颜色1: 字符串_或_数值型_或_table, BGR或RGB颜色, 字符串时表示十六进制, 数值时表示十进制, table时格式为{r, g, b}<br>颜色2: 字符串_或_数值型_或_table, BGR或RGB颜色, 字符串时表示十六进制, 数值时表示十进制, table时格式为{r, g, b}</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数值型_ , 返回两个颜色的相似度小数, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeColorSim');">复制代码</div>
                <pre id="codeColorSim">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

TracePrint zm.ColorSim("FFFFFF", "000000")
TracePrint zm.ColorSim("FFFFFF", "FFFFFF")
TracePrint zm.ColorSim("FFFFFF", "EEEEEE")</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>可能与按键图色的相似度算法不同<br>
V3.1832: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="ColorToHSV" id="ColorToHSV"> <a href="https://zimaoxy.com/m/post/zm.colortohsv/" target="_blank">zm.ColorToHSV 分解HSV颜色</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>分解HSV颜色至H、S、V三个分量中。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.ColorToHSV(HSV[, 返回表])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">HSV: 字符串, HSV颜色，格式为“H.S.V”。<br>返回表: table, 可选参数，返回分解保存的表。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">table_ ，返回分解后的结果，可以通过键名h、s、v查看，也可以通过下标0、1、2查看。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeColorToHSV');">复制代码</div>
                <pre id="codeColorToHSV">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim t = zm.ColorToHSV("100.20.30")
TracePrint t(0), t(1), t(2)
TracePrint t["h"], t["s"], t["v"]</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1720: 加入命令<br>
V1.1813: 修复H结果未取整数问题, 感谢`学员2123`反馈</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="ColorToRGB" id="ColorToRGB"> <a href="https://zimaoxy.com/m/post/zm.colortorgb/" target="_blank">zm.ColorToRGB 分解RGB颜色</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>分解RGB颜色至R、G、B三个分量中。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.ColorToRGB(RGB[, 返回表])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">RGB: 字符串或数值型, RGB颜色，字符串时为十六进制，数值时为十进制。<br>返回表: table, 可选参数，返回分解保存的表。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">table_ ，返回分解后的结果，可以通过键名r、g、b查看，也可以通过下标0、1、2查看。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeColorToRGB');">复制代码</div>
                <pre id="codeColorToRGB">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim t = zm.ColorToRGB("11BBDD")
TracePrint t(0), t(1), t(2)
TracePrint t["r"], t["g"], t["b"]</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1720: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="GetPicSize" id="GetPicSize"> <a href="https://zimaoxy.com/m/post/zm.getpicsize/" target="_blank">zm.GetPicSize 获取图片宽高</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>获取一张图片的宽度和高度, 支持PNG, BMP, GIF这3种图片格式, 支持附件路径</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.GetPicSize(图片路径)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">图片路径: 字符串,  图片的所在路径, 支持附件</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">table_ , 成功返回格式{宽度, 高度, "w":宽度, "h":高度, "type":图片类型}, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeGetPicSize');">复制代码</div>
                <pre id="codeGetPicSize">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim 图片宽高 = zm.GetPicSize("Attachment:紫猫.png") //也可以写本地路径
If 图片宽高 Then
  TracePrint "第1种写法: 宽度=", 图片宽高(0), ", 高度=", 图片宽高(1)
  TracePrint "第2种写法: 宽度=", 图片宽高["w"], ", 高度=", 图片宽高["h"]
Else
  TracePrint "获取失败"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V3.1831: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="GetPixelHSV" id="GetPixelHSV"> <a href="https://zimaoxy.com/m/post/zm.getpixelhsv/" target="_blank">zm.GetPixelHSV 得到指定点HSV颜色</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>得到指定点HSV颜色</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.(横坐标x, 纵坐标y[, hsv数组])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">横坐标x: 整数型, 待取色的x点坐标<br>纵坐标y: 整数型, 待取色的x点坐标<br>hsv数组: 表, 可选, 返回table格式的hsv三分量结果, 格式为{h, s, v, "h":h, "s":s, "v":v}</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 返回指定点的HSV颜色, 格式为"H.S.V"</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeGetPixelHSV');">复制代码</div>
                <pre id="codeGetPixelHSV">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim hsv, t()
hsv = zm.GetPixelHSV(100, 200, t)
TracePrint "字符串结果hsv=", hsv
TracePrint "三分量表结果, h=", t["h"], "s=", t["s"], "v=", t["v"]</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>方便快捷获取屏幕上hsv格式的颜色, 适用于一些渐变色判断处理.<br>
V4.2025: 初次加入</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="HSVToRGB" id="HSVToRGB"> <a href="https://zimaoxy.com/m/post/zm.hsvtorgb/" target="_blank">zm.HSVToRGB HSV转RGB</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>将HSV颜色转换成RGB颜色。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.HSVToRGB(HSV[, 是否BGR])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">HSV: 字符串, HSV颜色，格式为“H.S.V”。<br>是否BGR: 布尔型, 可选, true表示返回BGR颜色, false表示返回RGB颜色, 省略默认为false</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，返回十六进制的颜色，格式由参数2决定。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeHSVToRGB');">复制代码</div>
                <pre id="codeHSVToRGB">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

TracePrint zm.HSVToRGB("100.10.20")</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1720: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="IsDisplayDead" id="IsDisplayDead"> <a href="https://zimaoxy.com/m/post/zm.isdisplaydead/" target="_blank">zm.IsDisplayDead 是否卡屏</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>获取指定范围时间内是否出现卡屏, 画面不变化的情况, 如果画面有变化则立即返回</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.IsDisplayDead(x1, y1, x2, y2, 时长[, 相似度][, 判断间隔][, 判断模式])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">x1: 数值型, 卡屏判断范围左上角x坐标<br>y1: 数值型, 卡屏判断范围左上角y坐标<br>x2: 数值型, 卡屏判断范围右下角x坐标<br>y2: 数值型, 卡屏判断范围右下角y坐标<br>时长: 数值型, 限时判断时长, 单位毫秒<br>相似度: 数值型, 可选, 画面变化相似度, 省略默认为`0.8`<br>判断间隔: 数值型, 可选, 每次对比判断的间隔毫秒, 必须大于1, 省略默认为`10`<br>判断模式: 数值型, 可选, 如果判断不准确, 可以更换模式, -1为快速模式, -2为精准模式, 省略默认为`-1`</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">布尔型_ , 画面有变化则立即返回false, 画面一直没有变化则返回true, 出错返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeIsDisplayDead');">复制代码</div>
                <pre id="codeIsDisplayDead">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//在5秒内判断屏幕100,100,200,200范围是否卡屏
Dim isDead = zm.IsDisplayDead(100,100,200,200,5000)
If isDead Then
    TracePrint "出现卡屏了"
Else
    TracePrint "没有卡屏"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V3.1832: 加入命令<br>
V3.1837: 加入判断间隔时间参数, 降低CPU占用<br>
V3.1849: 支持超级缩放<br>
V3.1852: 加入了精准模式功能</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="RGBToBGR" id="RGBToBGR"> <a href="https://zimaoxy.com/m/post/zm.rgbtobgr/" target="_blank">zm.RGBToBGR RGB转BGR</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>RGB格式颜色转换成BGR格式颜色</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.RGBToBGR(RGB)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">RGB: 数值型或字符串, RGB格式的颜色，数值型时表示十进制，字符串时表示十六进制。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，返回转换后的BGR格式颜色</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeRGBToBGR');">复制代码</div>
                <pre id="codeRGBToBGR">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim c = zm.RGBToBGR("FF00AA")
TracePrint c</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1720: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="RGBToColor" id="RGBToColor"> <a href="https://zimaoxy.com/m/post/zm.rgbtocolor/" target="_blank">zm.RGBToColor 合成RGB颜色</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>合成三个RGB颜色分量到十六进制RGB字符串中</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.RGBToColor(r, g, b)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">r: 数值型或字符串, 红色分量，数值型时表示十进制，字符串时表示十六进制。<br>g: 数值型或字符串, 绿色分量，数值型时表示十进制，字符串时表示十六进制。<br>b: 数值型或字符串, 蓝色分量，数值型时表示十进制，字符串时表示十六进制。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，合成后的RGB格式颜色</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeRGBToColor');">复制代码</div>
                <pre id="codeRGBToColor">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim c = zm.RGBToColor(10,20,30)
TracePrint c</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1720: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="RGBToHSV" id="RGBToHSV"> <a href="https://zimaoxy.com/m/post/zm.rgbtohsv/" target="_blank">zm.RGBToHSV RGB转HSV</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>将RGB颜色转换成HSV颜色。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.RGBToHSV(RGB[, 是否BGR])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">RGB: 字符串或数值型, RGB颜色，字符串时是十六进制，数值时是十进制。<br>是否BGR: 布尔型, 可选, true表示参数1格式为BGR颜色, false表示参数1为RGB颜色, 省略默认为false</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，返回“H.S.V”格式的颜色。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeRGBToHSV');">复制代码</div>
                <pre id="codeRGBToHSV">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

TracePrint zm.RGBToHSV("102030")</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1720: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="SnapShot" id="SnapShot"> <a href="https://zimaoxy.com/m/post/zm.snapshot/" target="_blank">zm.SnapShot 无限截图</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>通过每次截图自动生成不同文件名实现不覆盖文件的无限截图功能, 支持自定义图片名规则.</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.SnapShot(截图目录[, 文件名规则][, x1, y1, x2, y2][, 压缩比率])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">截图目录: 字符串, 要存放文件的目录路径, 例如 `"/sdcard/Pictures/"`<br>文件名规则: 字符串, 可选, 自定义文件名规则, $n表示内置递增序号, $d表示当前日期, $t表示当前时间, 省略默认为"$d$t-$n.png"或"$d$t-$n.jpg"<br>x1: 数值型, 可选, 截取范围的左上角x坐标, 省略默认为0, 范围0,0,0,0表示全屏截图<br>y1: 数值型, 可选, 截取范围的左上角y坐标, 省略默认为0, 范围0,0,0,0表示全屏截图<br>x2: 数值型, 可选, 截取范围的右下角x坐标, 省略默认为0, 范围0,0,0,0表示全屏截图<br>y2: 数值型, 可选, 截取范围的右下角y坐标, 省略默认为0, 范围0,0,0,0表示全屏截图<br>压缩比率: 数值型, 可选, 0到100, 数值越大, 文件越小, 省略默认为0, 通过降低画质实现减少文件体积, 本参数仅支持按键IOS或按键安卓3.3.8以上版本</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串: 返回保存图片文件的完整路径</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeSnapShot');">复制代码</div>
                <pre id="codeSnapShot">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim 图片文件夹 = "/sdcard/Pictures/"
Dim 图片路径, 图片名规则

//使用默认规则$d$t-$n.png截图, 产生图片文件名类似于 210311014843-1.png
//如果你无法理解文件名规则参数, 建议省略该参数
For 3
	图片路径 = zm.SnapShot(图片文件夹)
	TracePrint "默认规则", 图片路径
Next

//$n: 会根据文件夹与文件名自动把$n替换成序号, 需注意, 每次启动脚本都是从1开始计数的
图片名规则 = "QQ345911220-$n.png"
For 2
	图片路径 = zm.SnapShot(图片文件夹, 图片名规则)
	TracePrint "$n规则", 图片路径
Next

//$n: 根据文件夹与文件名自动生成序号, 需注意, 每次启动脚本都是从1开始计数的
//$d: 根据当前日期自动提取年月日, 需注意, 年份为缩写两位数, 例如210311表示2021年03月11日
//$t: 根据当前时间自动提取时分秒, 例如205515表示20点55分15秒
//建议根据自己实际情况设置规则, 如果你是1秒内要截图好几次的, 强烈建议带上$n规则
图片名规则 = "紫猫学院-$d-$t-$n.jpg"
For 3
	图片路径 = zm.SnapShot(图片文件夹, 图片名规则, 50) //压缩比50
	TracePrint "复合规则", 图片路径
Next</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>序号会根据图片的完整路径自动安排编号, 例如例子中两个图片名规则不同, 序号各自从1开始.<br>
V4.2111: 初次加入</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="Calculator" id="Calculator"> <a href="https://zimaoxy.com/m/post/zm.calculator/" target="_blank">zm.Calculator 计算器</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>得到数学算式的计算结果.</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.Calculator(算式)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">算式: 字符串, 等待计算的数学算式, 支持加减乘除括号等运算</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数值型_ , 计算结果, 算式参数的计算结果, 出错返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeCalculator');">复制代码</div>
                <pre id="codeCalculator">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim a = zm.Calculator("1+2") //得到结果3

Dim b = zm.Calculator("1 + 2 * (3 - 4) / 2^3 + 8^(1/3)") //得到结果2.75
</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>可配合百度云识别等功能识别算式内容后, 传入计算得到结果.<br>
V4.2022: 初次加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="CheckForUpdates" id="CheckForUpdates"> <a href="https://zimaoxy.com/m/post/zm.checkforupdates/" target="_blank">zm.CheckForUpdates 检查插件更新</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>检查紫猫插件是否有新版，并输出显示.<br><br>每次启动仅首次调用有效.</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.CheckForUpdates()</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">无</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">布尔型_ ，未发现新版返回false，发现新版或检查失败返回true。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeCheckForUpdates');">复制代码</div>
                <pre id="codeCheckForUpdates">
$lizi</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>无</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="CollectGarbage" id="CollectGarbage"> <a href="https://zimaoxy.com/m/post/zm.collectgarbage/" target="_blank">zm.CollectGarbage 清理脚本内存</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>Lua的垃圾回收机制接口, 原型是collectgarbage()函数, 可通过第一个参数实现不同的操作, 默认为释放脚本内存功能</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.CollectGarbage([操作类型[, 附加参数]])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">操作类型: 字符串, 可选, 省略默认为执行一个完整的垃圾回收周期, 详细请百度搜索`lua collectgarbage`<br>附加参数: 字符串, 可选, 改变回收步骤周期等, 详细请百度搜索`lua collectgarbage`</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数值型_ , 返回执行结果, 由参数1决定返回内容</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeCollectGarbage');">复制代码</div>
                <pre id="codeCollectGarbage">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

TracePrint "当前脚本占用内存", zm.GetScriptMemory(), "kb"

Dim a = {"紫猫", "学院", "https://zimaoxy.com"}
TracePrint "创建数组后占用内存", zm.GetScriptMemory(), "kb"

a = Null
TracePrint "删除数组后占用内存", zm.GetScriptMemory(), "kb"

zm.CollectGarbage()

TracePrint "执行清理内存后占用内存", zm.GetScriptMemory(), "kb"</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>不建议频繁调用, 会降低脚本执行效率, 一般在加载大型资源前调用一次, 例如读取很大的一个文件之类的<br>
V3.1852: 初次加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="Execute" id="Execute"> <a href="https://zimaoxy.com/m/post/zm.execute/" target="_blank">zm.Execute 执行shell命令</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>执行shell命令，原理是使用Lua的`os.execute()`内部函数实现。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.Execute(shell命令)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">shell命令: 字符串, 任意有效的shell命令字符串。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，返回shell命令输出结果。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeExecute');">复制代码</div>
                <pre id="codeExecute">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//获取所有已装应用列表
TracePrint zm.Execute("ls /data/data")</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>该命令非常强大，请谨慎使用，更多shell命令请百度搜索`Andriod Shell`。<br>
V1.1730: 初次加入。</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="GetLuaVersion" id="GetLuaVersion"> <a href="https://zimaoxy.com/m/post/zm.getluaversion/" target="_blank">zm.GetLuaVersion 获取Lua版本</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>获取当前lua环境版本。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.GetLuaVersion()</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">无</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，返回当前lua的版本。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeGetLuaVersion');">复制代码</div>
                <pre id="codeGetLuaVersion">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

TracePrint zm.GetLuaVersion()</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1720: 插件加入本命令。</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="GetScriptMemory" id="GetScriptMemory"> <a href="https://zimaoxy.com/m/post/zm.getscriptmemory/" target="_blank">zm.GetScriptMemory 获取脚本占用内存</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>获取当前脚本所占用的内存, 单位kb</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.GetScriptMemory()</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">无</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数值型_ , 返回当前脚本所占内存容量大小, 单位kb</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeGetScriptMemory');">复制代码</div>
                <pre id="codeGetScriptMemory">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

TracePrint zm.GetScriptMemory()        //返回当前内存大小</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V3.1852: 初次加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="GetVersion" id="GetVersion"> <a href="https://zimaoxy.com/m/post/zm.getversion/" target="_blank">zm.GetVersion 获取插件版本</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>获取当前紫猫插件版本。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.GetVersion()</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">无</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，返回当前紫猫插件的版本号。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeGetVersion');">复制代码</div>
                <pre id="codeGetVersion">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

TracePrint zm.GetVersion()</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1720: 插件加入本命令。</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="OpenURL" id="OpenURL"> <a href="https://zimaoxy.com/m/post/zm.openurl/" target="_blank">zm.OpenURL 打开网页</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>使用默认浏览器打开网页, 支持网址包含&字符, 支持IOS</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.OpenURL(网址)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">网址: 字符串, 待打开的网址</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeOpenURL');">复制代码</div>
                <pre id="codeOpenURL">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

zm.OpenURL "zimao.vip" //访问紫猫学院官网</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1802: 加入命令<br>
V2.1829: 函数名由 `zm.OpenWeb()`改为`zm.OpenURL`, 并支持IOS<br>
V3.1852: 解决网址不支持`%`字符的问题</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="PCall" id="PCall"> <a href="https://zimaoxy.com/m/post/zm.pcall/" target="_blank">zm.PCall 保护执行函数</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>以保护模式调用执行函数, 避免由于异常错误导致整个脚本停止结束.<br><br>支持一个错误处理函数与一个必定执行函数, 支持传入任意数量参数.<br><br>可以实现调用按键函数免写可选参数功能. 并且翻译按键错误信息中`'idxxxx'`的准确内容</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.PCall(执行函数名[, 任意数量参数][, 错误处理函数名[, 任意数量参数][, 必定执行函数名[, 任意数量参数] ] ])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">执行函数名: 函数型, 需要保护执行的函数名, 注意这里填写的是函数名, 不要在后面加括号变成调用函数!<br>任意数量参数: 非函数型, 需要传入前面函数的参数, 如果有多个参数要传入, 则直接写多个参数, 用逗号隔开, 支持非函数的任意类型参数<br>错误处理函数名: 函数型, 可选, 如果前面执行函数内部出现异常错误时, 将会执行本处理函数, 如果没有前面执行函数没有出错, 那么就不会执行本处理函数<br>任意数量参数: 非函数型, 可选, 需要传入前面函数的参数, 如果有多个参数要传入, 则直接写多个参数, 用逗号隔开, 支持非函数的任意类型参数<br>必定执行函数名: 函数型, 可选, 不管前面函数执行是否出错, 本函数都将必定会执行一次. 填写本参数前面必须要有错误处理函数.<br>任意数量参数: 非函数型, 可选, 需要传入前面函数的参数, 如果有多个参数要传入, 则直接写多个参数, 用逗号隔开, 支持非函数的任意类型参数</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">任意类型_ , 根据调用的函数自身返回值决定结果.</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codePCall');">复制代码</div>
                <pre id="codePCall">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次
Dim 结果

TracePrint "正确的内容可以正常执行并返回正确结果"
结果 = zm.PCall(乘法, 2, 4)
TracePrint "正确结果 = ", 结果

TracePrint "对乘法函数传入汉字参数会提示异常错误信息, 但是不会停止整个脚本运行"
结果 = zm.PCall(乘法, "紫", "猫")
TracePrint "错误结果 = ", 结果

TracePrint "可加入错误处理函数, 当出错后执行错误处理"
结果 = zm.PCall(乘法, "紫", "猫", 乘法异常处理, "学", "院")
TracePrint "处理结果 = ", 结果

TracePrint "未出现错误, 则不执行错误处理函数"
结果 = zm.PCall(乘法, 2, 4, 乘法异常处理, "学", "院")
TracePrint "处理结果 = ", 结果

TracePrint "可加入必定执行函数, 不管是否出错, 函数必定会被执行"
结果 = zm.PCall(乘法, "紫", "猫", 乘法异常处理, "学", "院", 乘法最终处理)
TracePrint "处理结果 = ", 结果

TracePrint "乘法函数中参数b是可选的, 有默认值, 所以可以不写"
结果 = zm.PCall(乘法, 2)
TracePrint "免写结果 = ", 结果

Function 乘法(a, b)
	b = b or 10
	乘法 = a * b
End Function

Function 乘法异常处理(c, d)
	乘法异常处理 = c & d
End Function

Function 乘法最终处理(x)
	TracePrint "我是最终处理函数, 必定会被执行一次", x
End Function</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>非常强大的异常处理函数, 参考其他语言的try...catch...finally设计.<br>
可以用本函数保护执行可能出错的函数, 并且调用相应的错误处理解决函数.<br>
可以用本函数实现免写可选参数功能.<br>
V4.2025: 初次加入</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="TranslateError" id="TranslateError"> <a href="https://zimaoxy.com/m/post/zm.translateerror/" target="_blank">zm.TranslateError 翻译错误</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>可以将运行时错误内容中的id部分翻译成对应变量名或函数名, 例如 `attempt to index global 'ide7b4abe78cabe5ada6e999a2' (a null value)`, 将翻译并输出 `attempt to index global '紫猫学院' (a number value)`</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.TranslateError(错误文本)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">错误文本: 字符串, 含'idxxxxxx'的错误文本内容, 详见例子</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeTranslateError');">复制代码</div>
                <pre id="codeTranslateError">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim 紫猫学院, a=1, b=2

zm.TranslateError "当前脚本第9行：发生运行时错误！错误代码：2，错误行号：6，错误信息： attempt to index global 'ide7b4abe78cabe5ada6e999a2' (a null value)"
//下面这行代码执行会报错, 可以把错误内容复制粘贴到上面的zm.TranslateErrorID命令中, 记得加双引号
//命令会把错误内容中的'idxxxxxxx'这部分内容翻译成正确错误信息, 本次错误是变量 紫猫学院 不是数组, 无法带下标赋值
紫猫学院(0) = a + b
</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V4.2111: 初次加入, 仅支持'idxxxxxxx'这部分错误翻译</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="Type" id="Type"> <a href="https://zimaoxy.com/m/post/zm.type/" target="_blank">zm.Type 获取数据类型</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>获取参数的数据类型。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.Type(数据)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">数据: 任意类型, 等待获取数据类型的参数。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，返回以下几种可能值： "null"（一个字符串，而不是 null 值）， "number"， "string"， "boolean"， "table"， "function"， "thread"， "userdata"。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeType');">复制代码</div>
                <pre id="codeType">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

TracePrint zm.Type(null)
TracePrint zm.Type(345911220)
TracePrint zm.Type("紫猫")
TracePrint zm.Type({1,2,3})
TracePrint zm.Type(true)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>如果你要判断是否可以转为数值类型，请使用 <a href="https://zimaoxy.com/m/post/isnumeric/" target="_blank">isnumeric</a> 。<br>
V1.1723: 初次加入</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="VarInfo" id="VarInfo"> <a href="https://zimaoxy.com/m/post/zm.varinfo/" target="_blank">zm.VarInfo 获取参数信息</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>获取所有参数的数据类型、长度、值，通常配合按键自带的TracePrint命令调试输出使用，除了普通变量输出外，还支持数组与表的直接输出。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.VarInfo(...)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">参数: 任意类型, 要获取信息的参数，支持多个参数。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，返回每个参数信息合成的字符串，格式如下“【数据类型 长度】值，【数据类型 长度】值...”。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeVarInfo');">复制代码</div>
                <pre id="codeVarInfo">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim a = {"紫猫":345911220,"学院":{"正在", "招生中"},"欢迎加入"}
Dim b = "123", c = 123, d = true, e
TracePrint zm.VarInfo(a,b,c,d,e)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>与 <a href="https://zimaoxy.com/m/post/zm.traceprint/" target="_blank">zm.traceprint</a> 相比，缺少了调试输出功能，但是可以直接使用TracePrint命令输出更加灵活。<br>
V1.1723: 初次加入<br>
V2.1826: 优化返回字符串长度, 最长255, 以保证`TracePrint()`函数能正常输出显示信息<br>
V4.2111: 优化返回字符串长度, 最长65536, 以保证`TracePrint()`函数能正常输出显示信息</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="ThreadStatus" id="ThreadStatus"> <a href="https://zimaoxy.com/m/post/zm.threadstatus/" target="_blank">zm.ThreadStatus 获取线程状态</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>获取多线程的状态，例如运行中，被取消了等等。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.ThreadStatus(线程ID)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">线程ID: userdata, 启动线程后的返回值。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，有以下几种值<br><br><div class="tableStyle"><br><br>返回 | 解释<br>---|---<br>pending | 未启动<br>running | 正在运行中<br>done | 正常结束了<br>waiting | 等待<br>cancelled | 被强制终止了<br>error | 出错了<br><br></div></td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeThreadStatus');">复制代码</div>
                <pre id="codeThreadStatus">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim ThreadID
ThreadID = Thread.Start(threadA)
For 3
    TracePrint zm.ThreadStatus(ThreadID)
    Delay 1000
Next
Thread.Stop ThreadID
For 3
    TracePrint zm.ThreadStatus(ThreadID)
    Delay 1000
Next

Sub threadA()
    For 5
        TracePrint "执行多线程中..."
        Delay 1000
    Next
End Sub</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1724: 初次加入</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="ThreadWait" id="ThreadWait"> <a href="https://zimaoxy.com/m/post/zm.threadwait/" target="_blank">zm.ThreadWait 等待线程</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>暂停当前线程，等待指定线程执行完毕或超时，与  <a href="https://zimaoxy.com/m/post/thread.wait/" target="_blank">thread.wait</a>  相比多了超时参数。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.ThreadWait(线程ID[, 超时时间])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">线程ID: userdata, 启动线程后的返回值。<br>超时时间: 数值型, 可选，等待超时时间，单位毫秒，省略默认为null，表示不限时。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeThreadWait');">复制代码</div>
                <pre id="codeThreadWait">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim ThreadID
ThreadID = Thread.Start(threadA)
zm.ThreadWait ThreadID, 2
For 3
    TracePrint zm.ThreadStatus(ThreadID)
    Delay 1000
Next

Sub threadA()
    For 5
        TracePrint "执行多线程中..."
        Delay 1000
    Next
End Sub</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1738: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="SQLiteAddField" id="SQLiteAddField"> <a href="https://zimaoxy.com/m/post/zm.sqliteaddfield/" target="_blank">zm.SQLiteAddField 追加SQLite3字段</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>追加SQLite3数据表的字段名</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.SQLiteAddField(数据库路径, 表名, 字段名)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">数据库路径: 字符串, 数据库文件所在路径<br>表名: 字符串, 要创建的数据表名<br>字段名: 表, 要追加的字段名，后面可跟数据类型，例如{"id INTEGER"}, 暂时只支持一次添加一个字段</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">布尔值_ ，成功返回true，失败返回false</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeSQLiteAddField');">复制代码</div>
                <pre id="codeSQLiteAddField">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim ret = zm.SQLiteCreateTbl(GetSdcardDir() & "/zimao.db", "student", {"id INTEGER","name TEXT"})
TracePrint ret

ret = zm.SQLiteAddField(GetSdcardDir() & "/zimao.db", "student", {"age INTEGER"})
TracePrint ret</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>若数据库不存在或字段名已存在, 则返回false<br>
V1.1745: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="SQLiteCreateTbl" id="SQLiteCreateTbl"> <a href="https://zimaoxy.com/m/post/zm.sqlitecreatetbl/" target="_blank">zm.SQLiteCreateTbl 创建SQLite3数据表</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>创建SQLite3数据库的数据表，若数据库文件不存在，则自动创建。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.SQLiteCreateTbl(数据库路径, 表名, 字段名)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">数据库路径: 字符串, 数据库文件所在路径<br>表名: 字符串, 要创建的数据表名<br>字段名: 表, 要创建的字段名，后面可跟数据类型，例如{"id INTEGER","name TEXT"}</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">布尔值_ ，成功返回true，失败返回false</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeSQLiteCreateTbl');">复制代码</div>
                <pre id="codeSQLiteCreateTbl">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim ret = zm.SQLiteCreateTbl(GetSdcardDir() & "/zimao.db", "student", {"id INTEGER","name TEXT"})
TracePrint ret</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1738: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="SQLiteDropTbl" id="SQLiteDropTbl"> <a href="https://zimaoxy.com/m/post/zm.sqlitedroptbl/" target="_blank">zm.SQLiteDropTbl 删除SQLite3数据表</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>删除SQLite3数据库的数据表。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.SQLiteDropTbl(数据库路径, 表名)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">数据库路径: 字符串, 数据库文件所在路径<br>表名: 字符串, 要删除的数据表名</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">布尔值_ ，成功返回true，失败返回false</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeSQLiteDropTbl');">复制代码</div>
                <pre id="codeSQLiteDropTbl">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim ret = zm.SQLiteDropTbl(GetSdcardDir() & "/zimao.db", "student")
TracePrint ret</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1738: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="ArrayInsert" id="ArrayInsert"> <a href="https://zimaoxy.com/m/post/zm.arrayinsert/" target="_blank">zm.ArrayInsert 插入数组元素</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>在一维数组的指定位置插入元素。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">数组 = zm.ArrayInsert(一维数组, 待插入值[, 下标位置[, 是否传值调用]])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">一维数组: 数组型, 原一维数组。<br>待插入值: 任意类型, 待插入到数组中的值。<br>下标位置: 数值型, 可选参数，表示插入的下标位置，省略默认为追加到数组末尾。<br>是否传值调用: 布尔型, 可选参数，为true时不修改原数组，false修改原数组，省略默认false。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数组型_ ，返回插入元素后的一维数组，也可使用参数做返回值。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeArrayInsert');">复制代码</div>
                <pre id="codeArrayInsert">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim a = {"紫猫", "学院"}
zm.ArrayInsert a, "编程", 1
TracePrint zm.VarInfo(a)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>目前仅支持一维数组。<br>
V1.1720: 加入命令<br>
V1.1739: 加入传值调用参数</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="ArrayRemove" id="ArrayRemove"> <a href="https://zimaoxy.com/m/post/zm.arrayremove/" target="_blank">zm.ArrayRemove 删除数组元素</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>移除一维数组的某个下标元素。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">数组 = zm.ArrayRemove(一维数组, 下标位置[, 是否传值调用])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">一维数组: 数组型, 原一维数组。<br>下标位置: 数值型, 要删除元素的下标位置<br>是否传值调用: 布尔型, 可选参数，为true时不修改原数组，false修改原数组，省略默认false。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数组型_ ，返回删除指定元素后的数组，也可使用参数做返回值。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeArrayRemove');">复制代码</div>
                <pre id="codeArrayRemove">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim a = {"紫猫", "编程", "学院"}
zm.ArrayRemove a, 1
TracePrint zm.VarInfo(a)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>目前仅支持一维数组。<br>
V1.1720: 加入命令<br>
V1.1739: 加入传值调用参数</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="ArrayRemoveDuplicate" id="ArrayRemoveDuplicate"> <a href="https://zimaoxy.com/m/post/zm.arrayremoveduplicate/" target="_blank">zm.ArrayRemoveDuplicate 数组去重</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>删除一维数组中的重复成员值</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">数组 = zm.ArrayRemoveDuplicate(一维数组[, 是否忽略大小写[, 是否传值调用]])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">一维数组: 数组型, 原一维数组。<br>是否忽略大小写: 布尔型, 可选参数，true为忽略大小写，false为不忽略大小写，省略默认为false。<br>是否传值调用: 布尔型, 可选参数，为true时不修改原数组，false修改原数组，省略默认false。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数组型_ ，返回删除重复成员后的数组，也可使用参数做返回值。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeArrayRemoveDuplicate');">复制代码</div>
                <pre id="codeArrayRemoveDuplicate">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim a = {"紫猫", "编程", "学院", "紫猫", 2, 0, 1, 2}
zm.ArrayRemoveDuplicate a
TracePrint zm.VarInfo(a)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>目前仅支持一维数组。<br>
V1.1750: 加入命令<br>
V1.1803: 去重后顺序不变</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="ArrayReplace" id="ArrayReplace"> <a href="https://zimaoxy.com/m/post/zm.arrayreplace/" target="_blank">zm.ArrayReplace 替换数组元素</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>替换一维数组中的指定元素内容, 错误返回null</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.ArrayReplace(一维数组, 查找内容, 替换内容[, 是否模糊搜索[, 是否忽略大小写[, 替换数量]]])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">一维数组: 数组型, 被查找的一维数组。<br>查找内容: 任意类型, 要查找的内容，请注意数据类型。<br>替换内容: 任意类型, 替换后内容，请注意数据类型。<br>是否模糊搜索: 布尔型, 可选参数，true为模糊匹配搜索，false为完整匹配搜索，省略默认为false。<br>是否忽略大小写: 布尔型, 可选参数，true为忽略大小写，false为不忽略大小写，省略默认为false。<br>替换数量: 数值型, 可选参数，-1为全部替换, 其他为替换次数, 省略默认为-1。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数组型_ ，返回替换后的数组。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeArrayReplace');">复制代码</div>
                <pre id="codeArrayReplace">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim t = {"紫猫", "老师", "QQ是多少"}
Dim tt = zm.ArrayReplace(t, "QQ", "345911220", true)

For i = 0 To UBOUND(tt)
	TracePrint tt(i)
Next</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1820: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="ArraySearch" id="ArraySearch"> <a href="https://zimaoxy.com/m/post/zm.arraysearch/" target="_blank">zm.ArraySearch 搜索数组元素</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>搜索一维数组的成员下标，根据返回个数参数的值决定返回内容。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.ArraySearch(一维数组, 搜索内容[, 是否模糊搜索[, 是否忽略大小写[, 返回个数]]])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">一维数组: 数组型, 被查找的一维数组。<br>搜索内容: 任意类型, 要查找的内容，请注意数据类型。<br>是否模糊搜索: 布尔型, 可选参数，true为模糊匹配搜索，false为完整匹配搜索，省略默认为false。<br>是否忽略大小写: 布尔型, 可选参数，true为忽略大小写，false为不忽略大小写，省略默认为false。<br>返回个数: 数值型, 可选参数，null为返回第一个下标，0为返回所有下标数组，其他数值为返回该个数下标数组，省略默认为null。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui"><div class="tableStyle"><br><br>返回个数参数 | 返回值数据类型 | 返回值解释<br>-------|---------|------<br>null | 数值型 | 返回找到的第一个下标，没找到返回-1<br>0 | 数值型数组 | 返回找到的所有下标，没找到返回长度-1的数组<br>其他大于0的数值 | 数值型数组 | 返回找到的指定个数下标数组，没找到返回长度-1的数组<br><br></div></td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeArraySearch');">复制代码</div>
                <pre id="codeArraySearch">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim a = {"Hello", "紫猫", "编程", "学院", "Hello"}

Dim index = zm.ArraySearch(a, "编程")
TracePrint index '返回数值2

index = zm.ArraySearch(a, "he", true)
TracePrint index '返回数值-1

index = zm.ArraySearch(a, "he", true, true)
TracePrint index '返回数值0

Dim iArr = zm.ArraySearch(a, "He", true, true, 0)
TracePrint zm.VarInfo(iArr) '返回数值型数组{0, 4}</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>目前仅支持一维数组。<br>
V1.1720: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="ArraySort" id="ArraySort"> <a href="https://zimaoxy.com/m/post/zm.arraysort/" target="_blank">zm.ArraySort 数组元素排序</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>对一维数组进行排序，数组元素的数据类型必须一致。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.ArraySort(一维数组[, 是否降序[, 是否转数值[, 是否传值调用]]])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">一维数组: 数组型, 待排序的数组。<br>是否降序: 布尔型, 可选参数，是否按降序排序，省略默认为false。<br>是否转数值: 布尔型, 可选参数，是否将数组元素转换成数值型，省略默认为false。<br>是否传值调用: 布尔型, 可选参数，为true时不修改原数组，false修改原数组，省略默认false。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数组型_ ，返回排序后的数组，也可使用参数做返回值。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeArraySort');">复制代码</div>
                <pre id="codeArraySort">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim a = {1, 0, 2, 4, 3, 8, 5, 9, 7, 6}

zm.ArraySort a
TracePrint zm.VarInfo(a)

zm.ArraySort a, true
TracePrint zm.VarInfo(a)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>目前仅支持一维数组。<br>
如果转数值失败会出错。<br>
V1.1720: 加入命令<br>
V1.1739: 加入传值调用参数</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="Clone" id="Clone"> <a href="https://zimaoxy.com/m/post/zm.clone/" target="_blank">zm.Clone 超级克隆</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>除了可以克隆数组外，还可以克隆表（table），支持深层嵌套的表。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.Clone(原表)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">原表: 数组或表, 准备被克隆的数组或者表。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ ，克隆后的独立数组或表。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeClone');">复制代码</div>
                <pre id="codeClone">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim 表a, 表b, 表c
//对表a进行赋值
表a = {"姓名":"紫猫", "职业":"教师", "QQ":345911220}

//使用等号将表a赋值给表b
表b = 表a

//使用zm.Clone将表a克隆给表c
表c = zm.Clone(表a)

//分别改变3个表的一个键值
表a["姓名"] = "紫猫学院"
表b["职业"] = "编程教学"
表c["QQ"] = "欢迎加入"

//输出3张表的键值
TracePrint "表a键值：", 表a["姓名"], 表a["职业"], 表a["QQ"]
TracePrint "表b键值：", 表b["姓名"], 表b["职业"], 表b["QQ"]
TracePrint "表c键值：", 表c["姓名"], 表c["职业"], 表c["QQ"]</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>只克隆数组或表的值，不复制地址，与 <a href="https://zimaoxy.com/m/post/clone/" target="_blank">clone</a> 相比，多了支持表的深层克隆。<br>
V1.1722: 插件加入本命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="PosExclude" id="PosExclude"> <a href="https://zimaoxy.com/m/post/zm.posexclude/" target="_blank">zm.PosExclude 排除指定范围坐标</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>在二维坐标数组中排除指定范围的坐标, 支持圆形范围和矩形范围</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.PosExclude(原坐标数组, x1, y1[, 半径或x2[, y2]])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">原坐标数组: table, 等待处理的坐标数组, 格式为{ {x,y},{x,y},{xy},...}, 兼容超级图色里的返回找到所有坐标格式<br>x1: 数值型, 表示左上角x坐标或圆心x坐标<br>y1: 数值型, 表示左上角y坐标或圆心y坐标<br>半径或x2: 数值型, 可选, 当不填写参数y2时, 表示圆心范围的半径, 当填写参数y2时表示矩形右下角x坐标<br>y2: 数值型, 可选, 矩形右下角y坐标</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">坐标数组, table_ , 得到排除后剩下的坐标</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codePosExclude');">复制代码</div>
                <pre id="codePosExclude">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//以圆形15,15, 半径10排除坐标, 最终得到{{30,40}}
Dim t1 = zm.PosExclude({{10,20},{30,40}}, 15, 15, 10)

//以范围5,5,25,25排除坐标, 最终得到{{30,40}}
Dim t2 = zm.PosExclude({{10,20},{30,40}}, 5, 5, 25, 25)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>常用于超级图色返回所有坐标的结果处理<br>
V2.1829: 加入命令<br>
V3.1902: 修复返回不正确问题</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="PosInclude" id="PosInclude"> <a href="https://zimaoxy.com/m/post/zm.posinclude/" target="_blank">zm.PosInclude 获取包含范围坐标</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>在二维坐标数组中获取包含范围的坐标, 支持圆形范围和矩形范围</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.PosInclude(原坐标数组, x1, y1[, 半径或x2[, y2]])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">原坐标数组: table, 等待处理的坐标数组, 格式为{ {x,y},{x,y},{xy},...}, 兼容超级图色里的返回找到所有坐标格式<br>x1: 数值型, 表示左上角x坐标或圆心x坐标<br>y1: 数值型, 表示左上角y坐标或圆心y坐标<br>半径或x2: 数值型, 可选, 当不填写参数y2时, 表示圆心范围的半径, 当填写参数y2时表示矩形右下角x坐标<br>y2: 数值型, 可选, 矩形右下角y坐标</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">坐标数组, table_ , 得到包含指定范围的坐标</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codePosInclude');">复制代码</div>
                <pre id="codePosInclude">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//以圆形15,15, 半径10获取坐标, 最终得到{{10,20}}
Dim t1 = zm.PosInclude({{10,20},{30,40}}, 15, 15, 10)

//以范围5,5,25,25获取坐标, 最终得到{{10,20}}
Dim t2 = zm.PosInclude({{10,20},{30,40}}, 5, 5, 25, 25)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>常用于超级图色返回所有坐标的结果处理<br>
V2.1829: 加入命令<br>
V3.1902: 修复返回不正确问题</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="PosSort" id="PosSort"> <a href="https://zimaoxy.com/m/post/zm.possort/" target="_blank">zm.PosSort 坐标排序</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>对二维坐标数组按远近进行排序, 支持升序, 降序</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.PosSort(坐标数组[, x, y][, 是否降序])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">坐标数组: table, 等待排序的坐标数组, 格式为{ {x,y},{x,y},{xy},...}, 传址调用, 兼容超级图色里的返回找到所有坐标格式<br>x: 数值型, 可选, 表示用于比较远近的x坐标, 省略默认为0<br>y: 数值型, 可选, 表示用于比较远近的y坐标, 省略默认为0<br>是否降序: 布尔型, 可选, 填写true表示从远到近, 填写false表示从近到远, 省略为false</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">坐标数组, table_ , 得到排序后的坐标数组</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codePosSort');">复制代码</div>
                <pre id="codePosSort">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//按照与坐标0,0的远近升序, 最终得到{{10,20},{30,25}}
Dim t1 = zm.PosSort({{30,25},{10,20}}) 

//按照与坐标0,0的远近降序, 最终得到{{30,25},{10,20}}
Dim t2 = zm.PosSort({{30,25},{10,20}}, true)

//按照与坐标15,15的远近升序, 最终得到{{10,20},{30,40}}
Dim t3 = zm.PosSort({{10,20},{30,40}}, 15, 15)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>常用于超级图色返回所有坐标的结果处理<br>
V2.1829: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="TableClear" id="TableClear"> <a href="https://zimaoxy.com/m/post/zm.tableclear/" target="_blank">zm.TableClear 清空表</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>将一个数组或者table表清空所有成员</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.TableClear(表)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">表: 表, 待清空的表</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 成功返回长度-1的表, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeTableClear');">复制代码</div>
                <pre id="codeTableClear">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim t = {1, 2, "a":{3, 4}}
Dim tt = zm.TableClear(t)

TracePrint zm.VarInfo(t)
TracePrint zm.VarInfo(tt)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V2.1826: 加入此命令, 注意参数属于传址引用</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="TableIsEmpty" id="TableIsEmpty"> <a href="https://zimaoxy.com/m/post/zm.tableisempty/" target="_blank">zm.TableIsEmpty Table是否为空</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>判断一个table表数据是否为空表{}</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.TableIsEmpty(任意表)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">任意表: 表, 要判断是否为空, 不存在任何成员的表</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">布尔值_ , 为空表返回 `true` , 不为空返回 `false`</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeTableIsEmpty');">复制代码</div>
                <pre id="codeTableIsEmpty">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim t1, t2

t1 = Array() //空表, 也是空数组
t2 = {"紫猫学院":"zimao.vip"} //非空表

TracePrint zm.TableIsEmpty(t1)    //true
TracePrint zm.TableIsEmpty(t2)    //false
TracePrint UBound(t1)    //-1
TracePrint UBound(t2)    //-1
TracePrint t1=Array()    //false
TracePrint t2=Array()    //false</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>因为table的键值对数据无法用Ubound获取长度, 也不能直接与空表{}比较, 而用for each循环判断一遍也太麻烦, 所以才写了本函数<br>
V4.2111: 初次加入</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="TableIsSame" id="TableIsSame"> <a href="https://zimaoxy.com/m/post/zm.tableissame/" target="_blank">zm.TableIsSame 表成员是否相同</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>判断两个表的成员与顺序是否相同, 不考虑地址</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.TableIsSame(表1, 表2)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">表1: 表, 第一个表<br>表2: 表, 第二个表</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">布尔型: 返回比较结果, 相同返回true, 不同返回false</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeTableIsSame');">复制代码</div>
                <pre id="codeTableIsSame">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim t1, t2
t1 = {1, 2, "QQ":345911220}
t2 = {1, 2, "QQ":345911220}

If t1 = t2 Then 
	TracePrint "直接比较结果为相同"
Else 
	TracePrint "直接比较结果为不同"
End If

If zm.TableIsSame(t1, t2) Then 
	TracePrint "插件比较结果为相同"
Else 
	TracePrint "插件比较结果为不同"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V4.2113:<br>
  初次加入<br>
  对比表的成员值, 只要内部成员与顺序相同, 那么结果就是相同的, 特别注意顺序也要相同才可以</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="TableUnpack" id="TableUnpack"> <a href="https://zimaoxy.com/m/post/zm.tableunpack/" target="_blank">zm.TableUnpack 数组解包</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>返回传入参数数组的所有元素, 原型是Lua中的table.unpack(), 目前手机版变量赋值只能接收一个元素, 但可选参数的函数命令可以接收多个元素, 详见示例</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.TableUnpack([数组, ...][, 起始[, 终止]])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">数组: table, 待处理的数组, 支持传入多个数组<br>起始: table, 可选, 截取表的起始位置, 从1开始计算, 省略默认为1<br>终止: table, 可选, 截取表的终止位置, 从1开始计算, -1表示最后一个元素位置, 省略默认为-1</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeTableUnpack');">复制代码</div>
                <pre id="codeTableUnpack">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim t = {"a":"hello", 345911220, true, "紫猫"}
//数组tt只能接受第一个元素, 因为按键语法不支持多个变量返回值
Dim tt = zm.TableUnpack(t)
TracePrint tt

//可以打印输出所有返回值, 因为TracePrint支持多个可选参数
//没有显示键名a的元素, 因为只支持数组内容部分
TracePrint zm.TableUnpack(t)

//可以利用{}语法合并两个数组元素到新的数组中
Dim t1 = {1, 2, 3}
Dim newT = {zm.TableUnpack(t, t1)}
TracePrint zm.VarInfo(newT)

//可以解决超级多点找色或多点比色参数过长问题
Dim 颜色1 = {"0DD200","4|2|FFFFFF,3|7|211003,27|1|1592FF"}
Dim 颜色2 = {"123456","40|27|FFFFFF,31|5|211003"}

//下面这两句代码实现效果完全相同, 注意解包必须是放在最后一个参数
zm.FindMultiColor "显示", zm.TableUnpack(颜色1, 颜色2)
zm.FindMultiColor "0DD200","4|2|FFFFFF,3|7|211003,27|1|1592FF","123456","40|27|FFFFFF,31|5|211003","显示"</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V3.1835: 初次加入</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="DirCopy" id="DirCopy"> <a href="https://zimaoxy.com/m/post/zm.dircopy/" target="_blank">zm.DirCopy 复制文件或目录</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>复制文件或目录, 支持多文件复制, 特别注意本命令与`Dir.Copy()`的参数是有区别的!</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">zm.DirCopy(源路径, 目标路径[, 模式])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">源路径: 字符串_ 或 _表, 等待复制的源文件或文件夹路径, 支持通配符*和?, 如果是table类型, 则表示多个文件<br>目标路径: 字符串, 复制到新的文件或文件夹, 若源路径是多文件, 则该参数必须是文件夹<br>模式: 字符串, 可选, `"-a"`表示普通复制, `"-af"`表示覆盖复制, 更多模式请自行搜索cp命令行, 省略默认为`"-af"`</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeDirCopy');">复制代码</div>
                <pre id="codeDirCopy">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//当目标路径不存在时, 表示复制为目标路径
zm.DirCopy "/sdcard/紫猫学院.txt", "/sdcard/zimaoxy.com.txt"

//当目标路径是已存在的目录时, 表示复制文件到该目录下
//下面代码执行后复制文件所在路径为 /sdcard/紫猫学院/zimaoxy.com.txt
zm.DirCopy "/sdcard/zimaoxy.com.txt", "/sdcard/紫猫学院/"

//源文件可以用通配符*和?, 这种情况目标路径必须是已存在的目录
zm.DirCopy "/sdcard/*.txt", "/sdcard/紫猫学院/"

//源文件可以table数据表示多个文件, 这种情况目标路径必须是已存在的目录
zm.DirCopy {"/sdcard/zimaoxy.com.txt", "/sdcard/紫猫学院.txt"}, "/sdcard/紫猫学院/"</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>基于Linux的`cp`命令行开发<br>
V4.2015<br>
 初次加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="DirCreate" id="DirCreate"> <a href="https://zimaoxy.com/m/post/zm.dircreate/" target="_blank">zm.DirCreate 创建目录</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>创建指定路径的目录, 父目录不存在时, 可强制创建</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">zm.DirCreate(目录路径[, 强制创建])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">目标路径: 字符串, 要创建的目录路径<br>强制创建: 布尔型, 可选, 省略默认为true, 表示父目录不存在时将自动创建父目录</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeDirCreate');">复制代码</div>
                <pre id="codeDirCreate">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

zm.DirCreate "/sdcard/1/2/紫猫学院/教程目录/"</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>基于Linux的`mkdir`命令行开发<br>
V4.2015<br>
 初次加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="DirDelete" id="DirDelete"> <a href="https://zimaoxy.com/m/post/zm.dirdelete/" target="_blank">zm.DirDelete 删除文件或目录</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>删除文件或目录, 支持删除多文件, 特别注意本命令与`Dir.Delete()`的参数是有区别的!</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">zm.DirDelete(路径[, 模式])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">路径: 字符串_ 或 _表, 要删除的源文件或文件夹路径, 支持通配符*和?, 如果是table类型, 则表示多个文件<br>模式: 字符串, 可选, `""`表示普通删除, `"-rf"`表示强制删除, 更多模式请自行搜索rm命令行, 省略默认为`"-rf"`</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeDirDelete');">复制代码</div>
                <pre id="codeDirDelete">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//删除单个文件
zm.DirDelete "/sdcard/紫猫学院.txt"

//删除单个目录
zm.DirDelete "/sdcard/教程目录/"

//可以用通配符*和?
zm.DirDelete "/sdcard/*.txt"

//table数据表示多个文件
zm.DirDelete {"/sdcard/zimaoxy.com.txt", "/sdcard/紫猫学院.txt"}</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>基于Linux的`rm`命令行开发<br>
V4.2015<br>
 初次加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="DirMove" id="DirMove"> <a href="https://zimaoxy.com/m/post/zm.dirmove/" target="_blank">zm.DirMove 移动文件或目录</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>移动文件或目录, 支持多文件移动, 特别注意本命令与`Dir.Move()`的参数是有区别的!</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">zm.DirMove(源路径, 目标路径[, 模式])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">源路径: 字符串_ 或 _表, 等待移动的源文件或文件夹路径, 支持通配符*和?, 如果是table类型, 则表示多个文件<br>目标路径: 字符串, 移动到新的文件或文件夹, 若源路径是多文件, 则该参数必须是文件夹<br>模式: 字符串, 可选, `""`表示普通移动不覆盖, `"-f"`表示覆盖移动, 更多模式请自行搜索mv命令行, 省略默认为`"-f"`</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeDirMove');">复制代码</div>
                <pre id="codeDirMove">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//当目标路径不存在时, 表示移动为目标路径, 同级目录相当于是重命名
zm.DirMove "/sdcard/紫猫学院.txt", "/sdcard/zimaoxy.com.txt"

//当目标路径是已存在的目录时, 表示移动文件到该目录下
//下面代码执行后移动文件所在路径为 /sdcard/紫猫学院/zimaoxy.com.txt
zm.DirMove "/sdcard/zimaoxy.com.txt", "/sdcard/紫猫学院/"

//源文件可以用通配符*和?, 这种情况目标路径必须是已存在的目录
zm.DirMove "/sdcard/*.txt", "/sdcard/紫猫学院/"

//源文件可以table数据表示多个文件, 这种情况目标路径必须是已存在的目录
zm.DirMove {"/sdcard/zimaoxy.com.txt", "/sdcard/紫猫学院.txt"}, "/sdcard/紫猫学院/"</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>基于Linux的`mv`命令行开发<br>
V4.2015<br>
 初次加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="DirScan" id="DirScan"> <a href="https://zimaoxy.com/m/post/zm.dirscan/" target="_blank">zm.DirScan 遍历文件或目录</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>在指定目录路径及子目录中遍历文件或目录, 支持通配符*?, 支持安卓7.1版</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.DirScan(目录路径[, 文件名或目录名[, 遍历类型[, 遍历深度[, 是否区分大小写]]]])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">目录路径: 字符串, 在该目录下遍历文件或目录<br>文件名或目录名: 字符串, 可选, 要找的文件名或目录名, 支持通配符`?*`, 省略默认为`"*"`<br>遍历类型: 整数型, 可选, `1`代表只遍历文件, `2`代表只遍历目录, `3`代表文件与目录都要遍历, 省略默认为`3`<br>遍历深度: 整数型, 可选, 遍历目录深度, `-1`表示无限制, 省略默认为`-1`<br>是否区分大小写: 布尔型, 可选, 省略默认为`false`, 表示不区分大小写</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 成功返回文件目录列表数组, 未找到或失败返回`null`</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeDirScan');">复制代码</div>
                <pre id="codeDirScan">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim t
//获取/sdcard/目录下所有文件与目录, 包括子目录
t = zm.DirScan("/sdcard/", "*")
If t Then 
	For Each v In t
		TracePrint v
	Next	
End If

//获取/sdcard/目录下所有文件, 包括子目录
t = zm.DirScan("/sdcard/", "*", 1)
If t Then 
	For Each v In t
		TracePrint v
	Next	
End If

//获取/sdcard/目录下所有目录, 包括子目录
t = zm.DirScan("/sdcard/", "*", 2)
If t Then 
	For Each v In t
		TracePrint v
	Next	
End If

//获取/sdcard/目录下所有文件和目录, 仅遍历1层
t = zm.DirScan("/sdcard/", "*", 3, 1)
If t Then 
	For Each v In t
		TracePrint v
	Next	
End If

//遍历/sdcard/目录下以.txt结尾的文件, 仅遍历2层
t = zm.DirScan("/sdcard/", "*.txt", 1, 2)
If t Then 
	For Each v In t
		TracePrint v
	Next	
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V4.2015<br>
 初次加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FileBytes" id="FileBytes"> <a href="https://zimaoxy.com/m/post/zm.filebytes/" target="_blank">zm.FileBytes 获取文件字节大小</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>获取文件的字节大小</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FileBytes(文件路径)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">文件路径: 字符串, 要获取大小的文件路径</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数值型_ , 返回文件的字节(b)大小</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFileBytes');">复制代码</div>
                <pre id="codeFileBytes">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim path = "/sdcard/紫猫学院.txt"

zm.FileWrite path, "欢迎加入紫猫学院"

Dim b = zm.FileBytes(path)

TracePrint "文件字节大小为:", b</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>1pb=1024tb, 1tb=1024gb, 1gb=1024mb, 1mb=1024kb, 1kb=1024b<br>
V1.1818: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FileCreate" id="FileCreate"> <a href="https://zimaoxy.com/m/post/zm.filecreate/" target="_blank">zm.FileCreate 创建文件</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>在指定路径下创建一个空白文件, 该目录路径必须存在</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">zm.FileCreate(文件路径)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">文件路径: 字符串, 要创建的空白文件路径</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFileCreate');">复制代码</div>
                <pre id="codeFileCreate">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//请自行打开sdcard根目录查看是否创建成功
zm.FileCreate "/sdcard/紫猫学院.txt"</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>基于Linux的`touch`命令行开发<br>
父目录必须是已存在, 否则无法创建文件<br>
V4.2015<br>
 初次加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FileDeleteLine" id="FileDeleteLine"> <a href="https://zimaoxy.com/m/post/zm.filedeleteline/" target="_blank">zm.FileDeleteLine 删除指定行文本</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>在一个文本文件中删除指定一行内容, 支持倒数行数</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FileDeleteLine(文件路径, 指定行)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">文件路径: 字符串, 要操作的文件路径<br>指定行: 数值型, 表示删除第几行内容, 负数为倒数第几行内容</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 返回删除后的文本数组, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFileDeleteLine');">复制代码</div>
                <pre id="codeFileDeleteLine">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim path = "/sdcard/紫猫学院.txt"

zm.FileWrite path, {"欢迎加入紫猫学院","紫猫老师QQ: 345911220", "学院官网: zimao.vip"}

Dim txts1 = zm.FileDeleteLine(path, 1)
TracePrint zm.VarInfo(txts1)

Dim txts2 = zm.FileDeleteLine(path, -1)
TracePrint zm.VarInfo(txts2)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1818: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FileEncode" id="FileEncode"> <a href="https://zimaoxy.com/m/post/zm.fileencode/" target="_blank">zm.FileEncode 获取文件编码</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>获取一个文件的编码, 可以用于 <a href="https://zimaoxy.com/m/post/zm.fileinit/" target="_blank">zm.fileinit</a> 等命令, 目前仅支持`UTF-8`和`中文编码`(兼容gb2312等)</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FileEncode(文件路径[, 是否设置编码])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">文件路径: 字符串, 要操作的文件路径<br>是否设置编码: 布尔型, 可选, 是否将获取的编码设置为File系列命令的默认编码, 省略默认false<br>检测行数: 数值型, 可选, 检测多少行内容, 省略默认为所有行内容, 行数越小, 检测耗时越小</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 成功返回`"utf-8"`或`"gb18030"`, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFileEncode');">复制代码</div>
                <pre id="codeFileEncode">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim code = zm.FileEncode("/sdcard/测试编码文件.txt", True)
If code Then
  TracePrint "得到并设置文件编码为: ", code
Else
  TracePrint "获取编码失败"
End If

//下面是指定检测行数的功能, 可以缩短识别需要的时间, 但是超出行部分的内容就不做编码判断, 可能会出现误判

Dim qcode = zm.FileEncode("/sdcard/测试编码文件.txt", True, 10)
If qcode Then
  TracePrint "得到并设置文件编码为: ", qcode
Else
  TracePrint "获取编码失败"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本命令目前仅支持`中文`和`utf-8`两种编码, 脚本只关心读取结果不出现乱码, 不在乎正确编码<br>
V3.1832: 加入命令<br>
V3.1837: 由`zm.FileGetEncode()`改名为`zm.FileEncode()`, 且加入是否设置编码可选参数</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FileInit" id="FileInit"> <a href="https://zimaoxy.com/m/post/zm.fileinit/" target="_blank">zm.FileInit 初始化设置File参数</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>初始化设置File系列命令的默认参数内容, 对绝大多数File系列命令有效</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FileInit(属性表)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">属性表: 表, 按照指定格式对表中的键值对进行赋值, 例如填写`{"encode":"电脑"}`可解决电脑文件乱码问题, 更多属性见下面表格<br><br>属性 | 默认值 | 数据类型 | 解释<br>---|-----|------|---<br>encode | "utf-8" | 字符串 | 文件编码, 填写`{"encode":"电脑"}`可解决电脑文件乱码问题<br>replacepath | null | 表 | 解决路径无权限问题, 替换指定路径<br></td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 返回设置成功后的默认参数表</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFileInit');">复制代码</div>
                <pre id="codeFileInit">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

zm.FileInit {"encode":"电脑"}

//在电脑上新建文件, 写入几个中文内容后, 传入设备中读取
Dim path = "/sdcard/紫猫学院电脑文件.txt"

zm.FileWriteAppend path, "\r\n", "听说写入电脑文件的内容会乱码?"

Dim txt = zm.FileRead(path)

TracePrint "不会乱码的内容如下:", txt

//部分系统读写文件失败的情况可以考虑加入以下代码解决
zm.FileInit {"replacepath":{"^/storage/emulated/0/":"/sdcard/"}}
</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>命令原理是内部对字符进行了转码, 电脑对应的是gb18030, 如果你的文件是其他编码格式的, 可以自行填写对应编码<br>
V1.1818: 加入命令<br>
V3.1832: 新增`auto`自动识别编码, 但是会降低读写速度, 不推荐使用.<br>
V3.1852: 加入 `"replacepath":{"^/storage/emulated/0/":"/sdcard/"}` 属性, 解决部分路径无权限问题<br>
V3.1929: 取消默认替换路径, 需自己写替换内容</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FileLinesNumber" id="FileLinesNumber"> <a href="https://zimaoxy.com/m/post/zm.filelinesnumber/" target="_blank">zm.FileLinesNumber 获取文件总行数</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>获取文本文件的总行数</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FileLinesNumber(文件路径)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">文件路径: 字符串, 要操作的文件路径</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数值型_ , 返回文本文件的总行数</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFileLinesNumber');">复制代码</div>
                <pre id="codeFileLinesNumber">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim path = "/sdcard/紫猫学院.txt"

zm.FileWrite path, {"第一行内容", "第二行内容", "第三行内容"}

Dim lines = zm.FileLinesNumber(path)

TracePrint "总行数:", lines</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1818: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FileLoadINI" id="FileLoadINI"> <a href="https://zimaoxy.com/m/post/zm.fileloadini/" target="_blank">zm.FileLoadINI 加载并解析INI</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>对INI文件进行加载并解析成table数据, 支持 <a href="https://zimaoxy.com/m/post/zm.fileinit/" target="_blank">zm.fileinit</a> 设置默认参数</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FileLoadINI(INI路径[, 文件编码][, 自动转换类型])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">INI路径: 字符串, 待加载的INI文件路径<br>文件编码: 字符串, 可选, 设置文件编码解决乱码问题, 省略默认为初始化编码<br>自动转换类型: 字符串, 可选, 将小节名, 键名, 键值进行智能转换成数值型或布尔型, 省略默认false, 表示不转换</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 成功返回解析后的INI数据表, 格式类似于`{小节名1:{键名1:键值1, 键名2:键值2}, 小节名A:{键名A:键值A}, ...}`, 失败返回`null`</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFileLoadINI');">复制代码</div>
                <pre id="codeFileLoadINI">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim data()
data["紫猫学院"] = {"官网":"zimaoxy.com", "报名QQ":345911220}
data["小节名"] = {"键名":"键值"}
Dim path="/sdcard/zimao.ini"

zm.FileSavaINI path, data

Dim iniData = zm.FileLoadINI(path)
TracePrint iniData["紫猫学院"]["官网"]
TracePrint iniData["紫猫学院"]["报名QQ"]
TracePrint iniData["小节名"]["键名"]</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>加载键值读取到`\r`或`\n`时会自动解析为换行符或回车符.<br>
<br>
V4.2039: 初次加入</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FileRead" id="FileRead"> <a href="https://zimaoxy.com/m/post/zm.fileread/" target="_blank">zm.FileRead 读取文本文件</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>读取文件所有内容, 支持设置文件编码</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FileRead(文件路径[, 文件编码])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">文件路径: 字符串, 要操作的文件路径<br>文件编码: 字符串, 可选, 填写"电脑"可以解决电脑文件乱码问题, 也可以填写`"auto"`实现自动识别文件编码, 但是会降低读写速度, 省略默认为初始化编码</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 返回该文件的所有文本内容</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFileRead');">复制代码</div>
                <pre id="codeFileRead">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim path = "/sdcard/紫猫学院.txt"

zm.FileWrite path, {"欢迎加入紫猫学院,", "紫猫老师QQ: 345911220 ", "免费交流QQ群: 7333555"}

Dim txt = zm.FileRead(path)

TracePrint "读取到的内容为:", txt

txt = zm.FileRead("/sdcard/电脑文件.txt", "电脑")

TracePrint "读取到的内容为:", txt</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>文件编码参数与 <a href="https://zimaoxy.com/m/post/zm.fileinit/" target="_blank">zm.fileinit</a> 中的`"encode":"utf-8"`参数相同<br>
V1.1818: 加入命令<br>
V2.1826: 解决读取文件开头出现问号的问题<br>
V3.1832: 新增`auto`自动识别编码, 但是会降低读写速度, 不推荐使用.</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FileReadBinary" id="FileReadBinary"> <a href="https://zimaoxy.com/m/post/zm.filereadbinary/" target="_blank">zm.FileReadBinary 读取二进制文件</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>以二进制读取文件内容</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FileReadBinary(文件路径)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">文件路径: 字符串, 要操作的文件路径</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 返回读取到的二进制内容</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFileReadBinary');">复制代码</div>
                <pre id="codeFileReadBinary">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim 读取路径 = "/sdcard/截图1.png"
Dim 写入路径 = "/sdcard/截图2.png"
SnapShot 读取路径

Dim bin = zm.FileReadBinary(读取路径)

zm.FileWriteBinary 写入路径, bin</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1818: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FileReadBinaryBase64" id="FileReadBinaryBase64"> <a href="https://zimaoxy.com/m/post/zm.filereadbinarybase64/" target="_blank">zm.FileReadBinaryBase64 以Base64读取二进制文件</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>读取文件二进制内容, 并转为Base64编码, 受 <a href="https://zimaoxy.com/m/post/zm.initbase64/" target="_blank">zm.initbase64</a> 影响, 失败返回null</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FileReadBinaryBase64(路径)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">路径: 字符串, 要读取的文件路径</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 返回读取的Base64结果, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFileReadBinaryBase64');">复制代码</div>
                <pre id="codeFileReadBinaryBase64">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim b64 = zm.FileReadBinaryBase64("/sdcard/紫猫.png")

zm.FileWriteBinaryBase64("/sdcard/新紫猫.png", b64)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1745: 加入命令<br>
V1.1818: `zm.ReadFileBase64()` 改为 `zm.FileReadBinaryBase64()`</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FileReadForm" id="FileReadForm"> <a href="https://zimaoxy.com/m/post/zm.filereadform/" target="_blank">zm.FileReadForm 读取文本文件表格</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>按指定分隔符读取文件所有内容保存到二维数组中, 支持设置文件编码</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FileReadForm(文件路径, 分隔符[, 文件编码])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">文件路径: 字符串, 要操作的文件路径<br>分隔符: 字符串_或_数值型, 字符串表示每行文本中的分隔符, 数值型表示按长度分隔<br>文件编码: 字符串, 可选, 填写"电脑"可以解决电脑文件乱码问题, 也可以填写`"auto"`实现自动识别文件编码, 但是会降低读写速度, 省略默认为初始化编码</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">二维数组_ , 返回每一行被分隔后的二维数组文本</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFileReadForm');">复制代码</div>
                <pre id="codeFileReadForm">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim path = "/sdcard/紫猫学院.txt"
zm.FileWrite path, {"帐号1====密码1====大区1", "帐号2====密码2====大区2", "帐号3====密码3====大区3"}

Dim txts = zm.FileReadForm(path, "====")
TracePrint zm.VarInfo(txts)

For Each v In txts
	TracePrint v[1], v[2], v[3]
Next</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>参数分隔符与 <a href="https://zimaoxy.com/m/post/zm.split/" target="_blank">zm.split</a> 相同<br>
若需设置文件编码, 请使用 <a href="https://zimaoxy.com/m/post/zm.fileinit/" target="_blank">zm.fileinit</a> 进行设置<br>
V1.1818: 加入命令<br>
V2.1826: 解决读取文件开头出现问号的问题<br>
V3.1832: 新增`auto`自动识别编码, 但是会降低读写速度, 不推荐使用.</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FileReadLine" id="FileReadLine"> <a href="https://zimaoxy.com/m/post/zm.filereadline/" target="_blank">zm.FileReadLine 读取指定行文本</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>读取指定行文本内容, 支持倒数行数, 超出行数返回null, 支持设置文件编码</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FileReadLine(文本路径, 指定行[, 文件编码])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">文件路径: 字符串, 要操作的文件路径<br>指定行: 数值型, 表示读取第几行内容, 负数为倒数第几行内容, 填`0`表示随机一行<br>文件编码: 字符串, 可选, 填写"电脑"可以解决电脑文件乱码问题, 也可以填写`"auto"`实现自动识别文件编码, 但是会降低读写速度, 省略默认为初始化编码</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 返回指定行的文本内容, 失败返回`null`</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFileReadLine');">复制代码</div>
                <pre id="codeFileReadLine">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim path = "/sdcard/紫猫学院.txt"
zm.FileWrite path, {"欢迎加入紫猫学院,", "紫猫老师QQ: 345911220 ", "免费交流QQ群: 7333555"}

Dim txt = zm.FileReadLine(path, 1)
TracePrint "读取到的内容为:", txt

txt = zm.FileReadLine(path, -1)
TracePrint "读取到的内容为:", txt

txt = zm.FileReadLine(path, 0)
TracePrint "读取到的内容为:", txt</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>读取超出最大行或最小行将会返回`null`<br>
若需设置文件编码, 请使用 <a href="https://zimaoxy.com/m/post/zm.fileinit/" target="_blank">zm.fileinit</a> 进行设置<br>
V1.1818: 加入命令<br>
V2.1826: 解决读取文件开头出现问号的问题<br>
V3.1832: 新增`auto`自动识别编码, 但是会降低读写速度, 不推荐使用.<br>
V4.2118: 加入随机读取一行功能</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FileReadLines" id="FileReadLines"> <a href="https://zimaoxy.com/m/post/zm.filereadlines/" target="_blank">zm.FileReadLines 读取文本数组</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>读取文件所有内容保存到一维数组中, 支持设置文件编码</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FileReadLines(文件路径[, 文件编码])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">文件路径: 字符串, 要操作的文件路径<br>文件编码: 字符串, 可选, 填写"电脑"可以解决电脑文件乱码问题, 也可以填写`"auto"`实现自动识别文件编码, 但是会降低读写速度, 省略默认为初始化编码</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">一维数组_ , 返回文件每一行内容保存到一维数组中</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFileReadLines');">复制代码</div>
                <pre id="codeFileReadLines">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim path = "/sdcard/紫猫学院.txt"
zm.FileWrite path, {"欢迎加入紫猫学院,", "紫猫老师QQ: 345911220 ", "免费交流QQ群: 7333555"}

Dim txt = zm.FileReadLines(path)
For i = 0 To UBOUND(txt)
	TracePrint txt(i)
Next</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>若需设置文件编码, 请使用 <a href="https://zimaoxy.com/m/post/zm.fileinit/" target="_blank">zm.fileinit</a> 进行设置<br>
V1.1818: 加入命令<br>
V2.1826: 解决读取文件开头出现问号的问题<br>
V3.1832: 新增`auto`自动识别编码, 但是会降低读写速度, 不推荐使用.</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FileReplaceLine" id="FileReplaceLine"> <a href="https://zimaoxy.com/m/post/zm.filereplaceline/" target="_blank">zm.FileReplaceLine 替换指定行文本</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>替换指定行文本, 支持 <a href="https://zimaoxy.com/m/post/zm.fileinit/" target="_blank">zm.fileinit</a> 默认参数</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FileReplaceLine(文件路径, 指定行, 文本内容, ...)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">文件路径: 字符串, 要操作的文件路径<br>指定行: 数值型, 表示替换第几行内容, 负数为倒数第几行内容<br>文本内容: 字符串_或_表, 支持一个数组参数或者多个字符串参数, 如果内容是一个数组参数, 则表示换行写入每个元素, 如果内容是多个字符串参数, 则表示不换行依次写入每个字符串</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 返回替换后的每一行文本数组</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFileReplaceLine');">复制代码</div>
                <pre id="codeFileReplaceLine">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim path = "/sdcard/紫猫学院.txt"
zm.FileWrite path, {"欢迎加入紫猫学院,", "紫猫老师QQ: 345911220 ", "QQ群号是多少?"}

Dim txts = zm.FileReplaceLine(path, -1, "免费交流群: 7333555")

TracePrint zm.VarInfo(zm.FileReadLines(path))</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>若需设置文件编码, 请使用 <a href="https://zimaoxy.com/m/post/zm.fileinit/" target="_blank">zm.fileinit</a> 进行设置<br>
V1.1818: 加入命令<br>
V3.1832: 新增`auto`自动识别编码, 但是会降低读写速度, 不推荐使用.</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FileSaveINI" id="FileSaveINI"> <a href="https://zimaoxy.com/m/post/zm.filesaveini/" target="_blank">zm.FileSaveINI 保存INI文件</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>将INI结构的数据保存到文件中, 支持 <a href="https://zimaoxy.com/m/post/zm.fileinit/" target="_blank">zm.fileinit</a> 设置默认参数</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FileSaveINI(INI路径, INI数据[, 文件编码])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">INI路径: 字符串, 待保存的INI文件路径<br>INI数据: 表, INI的数据内容, 格式类似于`{小节名1:{键名1:键值1, 键名2:键值2}, 小节名A:{键名A:键值A}, ...}`<br>文件编码: 字符串, 可选, 设置文件编码解决乱码问题, 省略默认为初始化编码</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFileSaveINI');">复制代码</div>
                <pre id="codeFileSaveINI">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim data()
data["紫猫学院"] = {"官网":"zimaoxy.com", "报名QQ":345911220}
data["小节名"] = {"键名":"键值"}
Dim path="/sdcard/zimao.ini"

zm.FileSavaINI path, data

Dim iniData = zm.FileLoadINI(path)
TracePrint iniData["紫猫学院"]["官网"]
TracePrint iniData["紫猫学院"]["报名QQ"]
TracePrint iniData["小节名"]["键名"]</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>当键值里出现换行符或回车符时会自动转为`\r`或`\n`字符串进行保存.<br>
<br>
V4.2039: 初次加入</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FileWrite" id="FileWrite"> <a href="https://zimaoxy.com/m/post/zm.filewrite/" target="_blank">zm.FileWrite 覆盖写入文本</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>覆盖写入文本内容到文件中, 支持 <a href="https://zimaoxy.com/m/post/zm.fileinit/" target="_blank">zm.fileinit</a> 默认参数</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FileWrite(文件路径, 文本内容, ...)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">文件路径: 字符串, 要操作的文件路径<br>文本内容: 字符串_或_表, 支持一个数组参数或者多个字符串参数, 如果内容是一个数组参数, 则表示换行写入每个元素, 如果内容是多个字符串参数, 则表示不换行依次写入每个字符串</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 成功返回文本数组, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFileWrite');">复制代码</div>
                <pre id="codeFileWrite">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim path = "/sdcard/紫猫学院.txt"

zm.FileWrite path, "欢迎加入紫猫学院,", "紫猫老师QQ: 345911220 ", "免费交流群: 7333555"
TracePrint zm.VarInfo(zm.FileReadLines(path))

zm.FileWrite path, {"欢迎加入紫猫学院,", "紫猫老师QQ: 345911220 ", "免费交流群: 7333555"}
TracePrint zm.VarInfo(zm.FileReadLines(path))</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>若需设置文件编码, 请使用 <a href="https://zimaoxy.com/m/post/zm.fileinit/" target="_blank">zm.fileinit</a> 进行设置<br>
注意本命令是覆盖写入, 即会清空文件所有内容, 重新写入新的内容<br>
V1.1818: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FileWriteAppend" id="FileWriteAppend"> <a href="https://zimaoxy.com/m/post/zm.filewriteappend/" target="_blank">zm.FileWriteAppend 追加写入文本</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>追加写入文本内容到文件中, 写完自动换行, 支持 <a href="https://zimaoxy.com/m/post/zm.fileinit/" target="_blank">zm.fileinit</a> 默认参数</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FileWriteAppend(文件路径, 文本内容, ...)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">文件路径: 字符串, 要操作的文件路径<br>文本内容: 字符串_或_表, 支持一个数组参数或者多个字符串参数, 如果内容是一个数组参数, 则表示换行写入每个元素, 如果内容是多个字符串参数, 则表示不换行依次写入每个字符串</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">布尔值_ , 成功返回`true`, 失败返回`null`</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFileWriteAppend');">复制代码</div>
                <pre id="codeFileWriteAppend">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim path = "/sdcard/紫猫学院.txt"

zm.FileWrite path, {"欢迎加入紫猫学院,", "紫猫老师QQ: 345911220 ", "免费交流群: 7333555"}

zm.FileWriteAppend path, "追加1"

zm.FileWriteAppend path, "追加2"

TracePrint zm.VarInfo(zm.FileReadLines(path))</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>若需设置文件编码, 请使用 <a href="https://zimaoxy.com/m/post/zm.fileinit/" target="_blank">zm.fileinit</a> 进行设置<br>
注意本命令是追加写入, 即保留原内容, 在末尾追加新内容, 写完会自动换行<br>
V1.1818: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FileWriteBinary" id="FileWriteBinary"> <a href="https://zimaoxy.com/m/post/zm.filewritebinary/" target="_blank">zm.FileWriteBinary 写入二进制文件</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>覆盖写入二进制到文件中</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FileWriteBinary(文件路径, 二进制文本)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">文件路径: 字符串, 要操作的文件路径<br>二进制文本: 字符串, 待写入的二进制内容</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">布尔值_ , 成功返回true, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFileWriteBinary');">复制代码</div>
                <pre id="codeFileWriteBinary">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim 读取路径 = "/sdcard/截图1.png"
Dim 写入路径 = "/sdcard/截图2.png"
SnapShot 读取路径

Dim bin = zm.FileReadBinary(读取路径)

zm.FileWriteBinary 写入路径, bin</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1818: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FileWriteBinaryBase64" id="FileWriteBinaryBase64"> <a href="https://zimaoxy.com/m/post/zm.filewritebinarybase64/" target="_blank">zm.FileWriteBinaryBase64 覆盖写入Base64解密二进制</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>将内容进行Base64解密, 并以二进制写入文件中, 受 <a href="https://zimaoxy.com/m/post/zm.initbase64/" target="_blank">zm.initbase64</a> 影响, 失败返回null</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FileWriteBinaryBase64(路径, Base64文本)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">路径: 字符串, 要写入的文件路径<br>Base64文本: 字符串, 待解密的Base64文本内容</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">布尔型_ , 返回是否成功, 出错返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFileWriteBinaryBase64');">复制代码</div>
                <pre id="codeFileWriteBinaryBase64">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim b64 = zm.FileReadBinaryBase64("/sdcard/紫猫.png")

zm.FileWriteBinaryBase64("/sdcard/新紫猫.png", b64)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1821: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FileWriteLine" id="FileWriteLine"> <a href="https://zimaoxy.com/m/post/zm.filewriteline/" target="_blank">zm.FileWriteLine 插入指定行文本</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>追加写入到指定行, 支持 <a href="https://zimaoxy.com/m/post/zm.fileinit/" target="_blank">zm.fileinit</a> 默认参数</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FileWriteLine(文件路径, 指定行, 文本内容, ...)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">文件路径: 字符串, 要操作的文件路径<br>指定行: 数值型, 表示插入第几行内容, 负数为倒数第几行, 0为末尾新增一行, 不能超出最大行<br>文本内容: 字符串_或_表, 支持一个数组参数或者多个字符串参数, 如果内容是一个数组参数, 则表示换行写入每个元素, 如果内容是多个字符串参数, 则表示不换行依次写入每个字符串</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 返回插入后的所有内容一维数组</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFileWriteLine');">复制代码</div>
                <pre id="codeFileWriteLine">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim path = "/sdcard/紫猫学院.txt"

zm.FileWrite path, {"欢迎加入紫猫学院,", "紫猫老师QQ: 345911220 ", "免费交流群: 7333555"}

zm.FileWriteLine path, 2, "好好学习, 天天向上"

TracePrint zm.VarInfo(zm.FileReadLines(path))</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>若需设置文件编码, 请使用 <a href="https://zimaoxy.com/m/post/zm.fileinit/" target="_blank">zm.fileinit</a> 进行设置<br>
注意本命令是追加写入, 即保留原内容, 在指定行加入新内容, 原有内容向下移动<br>
V1.1818: 加入命令<br>
V3.1902: 修复插入第一行出错问题</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="RemoveLastTempFile" id="RemoveLastTempFile"> <a href="https://zimaoxy.com/m/post/zm.removelasttempfile/" target="_blank">zm.RemoveLastTempFile 已失效</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>从1.1813版本开始移除本命令, 请勿使用!<br>从1.1813版本开始移除本命令, 请勿使用!<br>从1.1813版本开始移除本命令, 请勿使用!<br><br>删除由  <a href="https://zimaoxy.com/m/post/zm.tempfile/" target="_blank">zm.tempfile</a>  最近一次生成的临时文件</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.RemoveLastTempFile()</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">无</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeRemoveLastTempFile');">复制代码</div>
                <pre id="codeRemoveLastTempFile">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim p = zm.TempFile()
TracePrint "临时文件路径：", p

File.Write p, "欢迎加入紫猫编程学院"
TracePrint "读取临时文件：", File.Read(p)

//删除上一次的临时文件
zm.RemoveLastTempFile</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>从1.1813版本开始移除本命令, 请勿使用!<br>
从1.1813版本开始移除本命令, 请勿使用!<br>
从1.1813版本开始移除本命令, 请勿使用!<br>
<br>
V1.1730: 初次加入。<br>
V1.1813: 移除本命令, 请勿使用。</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FileTemp" id="FileTemp"> <a href="https://zimaoxy.com/m/post/zm.filetemp/" target="_blank">zm.FileTemp 生成一个临时文件路径</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>随机生成一个不重复的临时文件路径名，当你执行写文件等保存文件操作后，才会真正生成文件。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FileTemp([文件名])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">文件名: 字符串, 可选, 指定文件名, 省略默认为随机文件名</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，返回生成的路径，失败返回null。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFileTemp');">复制代码</div>
                <pre id="codeFileTemp">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim p = zm.FileTemp()
TracePrint "临时文件路径：", p

File.Write p, "欢迎加入紫猫编程学院"
TracePrint "读取临时文件：", File.Read(p)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>该命令是生成路径名，并非真实文件，需要你对该路径执行保存文件之类的操作后才会真正出现文件。<br>
V1.1720: 加入命令<br>
V1.1818: `zm.TempFile()` 改为 `zm.FileTemp()`</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="ClearBOM" id="ClearBOM"> <a href="https://zimaoxy.com/m/post/zm.clearbom/" target="_blank">zm.ClearBOM 清除BOM字符串</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>清除读取记事本内容时产生的问号BOM字符串。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.ClearBOM(文本)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">文本: 字符串, 待清除BOM问号字符的文本内容</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 返回清除后的文本内容.</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeClearBOM');">复制代码</div>
                <pre id="codeClearBOM">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim text = File.Read("/sdcard/utf8文本")
TracePrint text   //假设读取的text开头有问号内容, 这个问号就是BOM字符串
Dim newText = zm.ClearBOM(text)
TracePrint newText   //清理后就不会有问号内容了

//另外如果直接用紫猫插件的文件读写命令, 内置默认清除BOM字符串.</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V3.1929: 初次加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="LTrim" id="LTrim"> <a href="https://zimaoxy.com/m/post/zm.ltrim/" target="_blank">zm.LTrim 删除前导字符</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>从左边开始删除指定的字符，直到出现非指定字符为止。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.LTrim(原字符串[, 前导字符])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">原字符串: 字符串, 原来的字符串内容<br>前导字符: 字符串, 可选，要删除的字符，省略默认为"\r\n \t"</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，返回删除前导后的内容。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeLTrim');">复制代码</div>
                <pre id="codeLTrim">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//删除左边的空格和a
Dim s = zm.LTrim("  abc abc", " a")
zm.TracePrint s</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1730: 初次加入。</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="RegExMatch" id="RegExMatch"> <a href="https://zimaoxy.com/m/post/zm.regexmatch/" target="_blank">zm.RegExMatch 正则匹配</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>Lua的正则匹配（也叫模式匹配），获取匹配成功的结果并保存到数组中。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.RegExMatch(源字符串, 正则表达式[, 返回表])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">源字符串: 字符串, 待匹配查找的字符串内容<br>正则表达式: 字符串, 匹配模式，与Javascript或Perl等正则不同，详见 <a href="https://zimaoxy.com/m/post/pattern-matching/" target="_blank">pattern-matching</a> <br>返回表: 表, 可选参数, 只能填写数据类型为数组的变量, 匹配失败返回最大下标为-1的数组</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串数组_ ，返回匹配成功的结果保存到数组中，失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeRegExMatch');">复制代码</div>
                <pre id="codeRegExMatch">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim ret() //返回表参数, 可以省略该参数
Dim s = "紫猫老师QQ:345911220, Email:345911220@qq.com"
Dim data = zm.RegExMatch(s, "%d+", ret)
If data then
    For i = 0 to Ubound(data)
        TracePrint "返回结果: " & data(i)
    Next

    //若填写了返回表参数, 则可以取出结果
    For i = 0 to Ubound(ret)
        TracePrint "返回表: " & ret(i)
    Next
Else
    TracePrint "未匹配到数据"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>从1.1750起, 失败返回值由长度-1的数组改为null<br>
V1.1738: 加入命令<br>
V1.1739: 修复`.*`出现死循环的BUG<br>
V1.1750: 失败返回null, 加入返回参数<br>
V3.1929: 修复正则匹配部分规则失效问题</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="RegExMatchEx" id="RegExMatchEx"> <a href="https://zimaoxy.com/m/post/zm.regexmatchex/" target="_blank">zm.RegExMatchEx 正则子匹配</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>捕获子匹配结果，并保存到二维数组中。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.RegExMatchEx(源字符串, 正则表达式[, 返回表])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">源字符串: 字符串, 待匹配查找的字符串内容<br>正则表达式: 字符串, 匹配模式，必须含有子匹配，与Javascript或Perl等正则不同，详见 <a href="https://zimaoxy.com/m/post/pattern-matching/" target="_blank">pattern-matching</a> <br>返回表: 表, 可选参数, 只能填写数据类型为数组的变量, 匹配失败返回最大下标为-1的数组</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串数组_ ，返回捕获的子匹配结果保存到二维数组中，失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeRegExMatchEx');">复制代码</div>
                <pre id="codeRegExMatchEx">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim ret()
Dim s = "紫猫老师QQ:345911220, Email:345911220@qq.com"
Dim data = zm.RegExMatchEx(s, "QQ:(%d+).-Email:(%w-@%w-%.%w+)", ret)
If data then
    For Each v in data
        TracePrint "返回本轮匹配结果："
        For Each vv in v
            TracePrint vv
        Next
    Next

    //若填写了返回表参数, 则可以取出结果
    For Each v in ret
        TracePrint "返回本轮表的结果："
        For Each vv in v
            TracePrint vv
        Next
    Next
Else
    TracePrint "未捕获到数据"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>从1.1750起, 失败返回值由长度-1的数组改为null<br>
V1.1738: 加入命令<br>
V1.1739: 修复`.*`出现死循环的BUG<br>
V1.1745: 修复无法获取多个匹配结果的问题<br>
V1.1750: 失败返回null, 加入返回参数<br>
V3.1929: 修复正则匹配部分规则失效问题</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="RegExMatchExSingle" id="RegExMatchExSingle"> <a href="https://zimaoxy.com/m/post/zm.regexmatchexsingle/" target="_blank">zm.RegExMatchExSingle 单个正则子匹配</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>根据序号捕获子匹配单个结果，若要所有结果请使用 <a href="https://zimaoxy.com/m/post/zm.regexmatchex/" target="_blank">zm.regexmatchex</a> </td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.RegExMatchExSingle(源字符串, 正则表达式[, 序号])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">源字符串: 字符串, 待匹配查找的字符串内容<br>正则表达式: 字符串, 匹配模式，必须含有子匹配, 与Javascript或Perl等正则不同, 详见 <a href="https://zimaoxy.com/m/post/pattern-matching/" target="_blank">pattern-matching</a> <br>序号: 数值型, 可选参数, 返回首个指定序号的子匹配结果, 省略默认为1</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 成功返回捕获第一个指定序号的子匹配结果, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeRegExMatchExSingle');">复制代码</div>
                <pre id="codeRegExMatchExSingle">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim s = "紫猫老师QQ:345911220, Email:345911220@qq.com"
Dim data = zm.RegExMatchExSingle (s, "QQ:(%d+).-Email:(%w-@%w-%.%w+)")
TracePrint "捕获第1个子匹配结果", data

data = zm.RegExMatchExSingle (s, "QQ:(%d+).-Email:(%w-@%w-%.%w+)", 2)
TracePrint "捕获第2个子匹配结果", data</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V3.1849: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="RegExMatchSingle" id="RegExMatchSingle"> <a href="https://zimaoxy.com/m/post/zm.regexmatchsingle/" target="_blank">zm.RegExMatchSingle 单个正则匹配</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>Lua的正则匹配（也叫模式匹配），获取匹配成功的指定结果，若要返回所有结果请使用 <a href="https://zimaoxy.com/m/post/zm.regexmatch/" target="_blank">zm.regexmatch</a> </td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.RegExMatchSingle(源字符串, 正则表达式[, 序号])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">源字符串: 字符串, 待匹配查找的字符串内容<br>正则表达式: 字符串, 匹配模式，与Javascript或Perl等正则不同，详见 <a href="https://zimaoxy.com/m/post/pattern-matching/" target="_blank">pattern-matching</a> <br>序号: 数值型, 可选参数, 返回首个指定序号的匹配结果, 省略默认为1</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，返回匹配成功的指定序号结果，失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeRegExMatchSingle');">复制代码</div>
                <pre id="codeRegExMatchSingle">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim s = "紫猫老师QQ:345911220, 公开交流群:7333555"
Dim data
data = zm.RegExMatchSingle(s, "%d+")
TracePrint "第1个结果", data

data = zm.RegExMatchSingle(s, "%d+", 2)
TracePrint "第2个结果", data

data = zm.RegExMatchSingle(s, "%d+", 3)
TracePrint "第3个结果", data</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V3.1849: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="RegExReplace" id="RegExReplace"> <a href="https://zimaoxy.com/m/post/zm.regexreplace/" target="_blank">zm.RegExReplace 正则替换</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>对源字符串进行模式匹配并替换内容。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.RegExReplace(源字符串, 正则表达式, 替换内容[, 替换次数])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">源字符串: 字符串, 待匹配查找的字符串内容<br>正则表达式: 字符串, 匹配模式, 与Javascript或Perl等正则不同, 详见 <a href="https://zimaoxy.com/m/post/pattern-matching/" target="_blank">pattern-matching</a> <br>替换内容: 字符串或表, 字符串表示替换后的内容; table表示以匹配结果为键名, 从表中查找对应的键值替换<br>替换次数: 数值型, 可选, 匹配成功后替换的次数, 省略默认为null, 表示全替换</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，返回模式匹配替换后的内容。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeRegExReplace');">复制代码</div>
                <pre id="codeRegExReplace">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim s = "紫猫老师QQ:12345"
Dim data = zm.RegExReplace(s, "%d+", "345911220")
TracePrint "替换后结果为：", data
```

```qscript 例子2
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim t = {"name":"紫猫", "QQ":345911220}
Dim s = "姓名:$name, QQ号:$QQ"
Dim data = zm.RegExReplace(s, "$(%w+)", t)
TracePrint "table替换后结果为：", data</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1738: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="RTrim" id="RTrim"> <a href="https://zimaoxy.com/m/post/zm.rtrim/" target="_blank">zm.RTrim 删除后导字符</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>从右边开始删除指定的字符，直到出现非指定字符为止。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.RTrim(原字符串[, 后导字符])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">原字符串: 字符串, 原来的字符串内容<br>后导字符: 字符串, 可选，要删除的字符，省略默认为"\r\n \t"</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，返回删除后导字符后的内容。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeRTrim');">复制代码</div>
                <pre id="codeRTrim">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//删除右边的空格和a
Dim s = zm.RTrim("  abc cba ", " a")
zm.TracePrint s</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1730: 初次加入。</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="Split" id="Split"> <a href="https://zimaoxy.com/m/post/zm.split/" target="_blank">zm.Split 超级分割</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>按指定分隔符或长度对原内容进行分割, 支持模式匹配, 返回分割后的一维数组。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.Split(原内容, 分隔符[, 模式匹配[, 转数值型] ])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">原内容: 字符串, 待分割的原字符串内容<br>分隔符: 字符串_或_数值型, 当字符串型时表示按此分隔符进行分割数组, 当数值型时表示按此长度进行分割数组<br>模式匹配: 布尔型, 可选, true表示开启模式匹配, 省略默认为false<br>转换类型: 布尔型, 可选, true表示开启智能转换数据类型, 省略默认为false</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 返回分割后的一维数组</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeSplit');">复制代码</div>
                <pre id="codeSplit">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//按字符串分割数组
Dim a = zm.Split("1,2,3,4,5", ",")
For i = 0 To UBOUND(a)
	TracePrint a(i)
Next

//按长度分割数组
Dim b = zm.Split("紫猫编程学院", 1)
For i = 0 To UBOUND(b)
	TracePrint b(i)
Next

//按模式匹配分割数组
Dim c = zm.Split("这234句话里45645646有605数字", "%d+", true)
For i = 0 To UBOUND(c)
	TracePrint c(i)
Next

//开启智能转换数据类型, 分割后, 1,3成员是数值型, a,b成员是字符串型, true是布尔型
Dim d = zm.Split("1,true,a,3,b", ",", false, true)
For i = 0 To UBOUND(d)
	TracePrint "值:", d(i), ", 类型:", zm.Type(d(i))
Next</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>匹配模式，与Javascript或Perl等正则不同，详见 <a href="https://zimaoxy.com/m/post/pattern-matching/" target="_blank">pattern-matching</a> <br>
V1.1816: 加入命令<br>
V4.2039: 新增智能转换数据类型可选参数</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="Trim" id="Trim"> <a href="https://zimaoxy.com/m/post/zm.trim/" target="_blank">zm.Trim 删除前后导字符</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>分别从左右两边开始删除指定的字符，每边直到出现非指定字符为止。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.Trim(原字符串[, 前后导字符])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">原字符串: 字符串, 原来的字符串内容<br>前后导字符: 字符串, 可选，要删除的字符，省略默认为"\r\n \t"</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，返回删除前后导字符后的内容。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeTrim');">复制代码</div>
                <pre id="codeTrim">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//删除右边的空格和a
Dim s = zm.Trim("  abc cba ", " a")
zm.TracePrint s</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1730: 初次加入。</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="GetNetworkTime" id="GetNetworkTime"> <a href="https://zimaoxy.com/m/post/zm.getnetworktime/" target="_blank">zm.GetNetworkTime 获取精准网络时间</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>内置淘宝, 苏宁, qq等多个获取网络时间接口</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.GetNetworkTime([格式[, 接口] ])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">格式: 数值型_ 或 _字符串, 可选, 表示返回的格式, 当数值型时, 0表示返回时间戳数值, 1表示返回"年-月-日 时:分:秒", 2表示返回"年月日时分秒",$n 当字符串时表示自定义格式化, 与DateTime.Format()的第一个参数格式相同, 省略默认为0<br>接口: 数值型, 可选, 取值-1到5, 省略默认为0, 其中0时表示随机接口, 1为淘宝接口, 2为苏宁接口, 3为香港接口, 4为按键自身接口, 5为腾讯接口, -1表示遍历所有接口且成功立即返回</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数值型_ 或 _字符串_ , 成功返回时间戳或格式化时间字符串, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeGetNetworkTime');">复制代码</div>
                <pre id="codeGetNetworkTime">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim t = zm.GetNetworkTime()
TracePrint "网络时间戳:", t

Dim t2 = zm.GetNetworkTime(1)
TracePrint "字符串时间:", t2

Dim t3 = zm.GetNetworkTime(0, -1)
TracePrint "遍历接口时间:", t3</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>比 <a href="https://zimaoxy.com/m/post/getnetworktime/" target="_blank">getnetworktime</a> 更加精准稳定快速<br>
V3.1832: 加入命令<br>
V4.2015: 更新部分接口<br>
V4.2025: 取消内置失败时循环获取功能, 加入`接口`参数<br>
V4.2111: <br>
  新增腾讯接口<br>
  新增-1接口, 表示遍历所有接口, 成功立即返回</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="TimeAdd" id="TimeAdd"> <a href="https://zimaoxy.com/m/post/zm.timeadd/" target="_blank">zm.TimeAdd 时间计算</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>计算时间加减后的数值, 例如一天后的时间, 3年前的时间等, 数值单位由参数3决定</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.TimeAdd([时间, ]数值[, 单位])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">时间: 数值型_或_字符串, 可选, 待计算的时间, 字符串时支持"2017年7月23日 23:29:31", "2017-07-23 23:29:38"等格式, 数值时表示时间戳, 省略默认为当前时间<br>数值: 数值型, 表示要加减的具体数值, 支持正负数<br>单位: 字符串, 可选, 表示数值的计算单位, 可填写["年", "月", "日", "天", "时", "分", "秒"]或["Y", "m", "d", "H", "M", "S"], 省略默认为"秒"</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数值型_ , 返回加减计算后的时间戳结果, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeTimeAdd');">复制代码</div>
                <pre id="codeTimeAdd">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//计算15天后的时间日期
TracePrint zm.TimeAdd("2019年8月3日 14:03:26", 15, "日")

//计算当前时间往后20个月的时间
TracePrint zm.TimeAdd(20, "月")</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>月份加减时要注意, 比如3月31日加1个月将会得到5月1日, 并非4月30日.<br>
V3.1832: 加入命令<br>
V4.2015: 采用归一化计算日期, 时间更加准确</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="TimeDiff" id="TimeDiff"> <a href="https://zimaoxy.com/m/post/zm.timediff/" target="_blank">zm.TimeDiff 计算时间差</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>计算时间1减去时间2的时间差, 返回单位以第3个参数为准</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.TimeDiff(时间1[, 时间2][, 单位][, 是否取整])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">时间1: 数值型_或_字符串, 第1个时间, 字符串时支持"2017年7月23日 23:29:31", "2017-07-23 23:29:38"等格式, 数值时表示时间戳<br>时间2: 数值型_或_字符串, 可选, 第2个时间, 字符串时支持"2017年7月23日 23:29:31", "2017-07-23 23:29:38"等格式, 数值时表示时间戳, 省略默认为当前时间<br>单位: 字符串, 可选, 表示计算返回的时间单位, 可填写["年", "月", "日", "天", "时", "分", "秒"]或["Y", "m", "d", "H", "M", "S"], 省略默认为"秒"<br>是否取整: 布尔型, 可选, 表示返回值是否只保留整数, 省略默认为false</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数值型_ , 成功返回两者时间差, 单位由参数3决定, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeTimeDiff');">复制代码</div>
                <pre id="codeTimeDiff">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//计算参数1减去参数2, 返回单位秒数
TracePrint zm.TimeDiff("2019年8月3日 14:03:26", "2018-08-03 22:06:04")

//计算2018-12-01 00:00:00减去当前时间, 返回单位天数, 并取整
TracePrint zm.TimeDiff("2018-12-01", "日", true)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>一个月约为30.4天, 一年为365天<br>
V3.1832: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="Timestamp" id="Timestamp"> <a href="https://zimaoxy.com/m/post/zm.timestamp/" target="_blank">zm.Timestamp 转时间戳</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>将时间格式的字符串转换成时间戳，支持`2017年7月23日 23:29:31`，`2017-07-23 23:29:38`等格式。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.Timestamp([时间])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">时间: 字符串, 可选, 任意有效时间格式的字符串, 支持`年-月-日 时:分:秒`等格式, 省略默认为当前时间</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数值型_ ，返回Unix时间戳，即从1970年1月1日到指定时间的总秒数，失败返回0。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeTimestamp');">复制代码</div>
                <pre id="codeTimestamp">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

TracePrint zm.Timestamp("2017-07-23 23:29:38")</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>只要格式是年月日时分秒的顺序，并且每个之间都有分隔字符，即可转换成时间戳。<br>
V1.1730: 初次加入<br>
V3.1832: 参数`时间`改为可选参数, 省略默认为当前时间</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="ConvBase" id="ConvBase"> <a href="https://zimaoxy.com/m/post/zm.convbase/" target="_blank">zm.ConvBase 任意进制转换</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>2到62进制任意转换。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.ConvBase(原数值, 原进制, 目标进制)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">原数值: 数值型或字符串, 待转换的原数值。<br>原进制: 数值型, 原来的进制，取值2至62。<br>目标进制: 数值型, 转换的目标进制，取值2至62。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，转换后的内容。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeConvBase');">复制代码</div>
                <pre id="codeConvBase">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim s = zm.ConvBase(100, 2, 10)
TracePrint s '返回4

s = zm.ConvBase(100, 10, 16)
TracePrint s '返回64</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>支持2到62进制的任意类型转换，错误进制返回长度为0的字符串。<br>
V1.1813: 加入命令<br>
V2.1826: 为统一编码函数名字规范, 由`zm.BaseConver()`改为`zm.ConvBase()`</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="ConvCoding" id="ConvCoding"> <a href="https://zimaoxy.com/m/post/zm.convcoding/" target="_blank">zm.ConvCoding 转换任意编码</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>使用iconv进行编码转换, 常用于将gb2312的网页源码转换为utf8编码内容</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.ConvCoding(转换内容, 原来编码, 目标编码)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">转换内容: 字符串, 待转换的字符串内容<br>原来编码: 字符串, 转换前的编码, 常见有gb2312, gbk, utf-8等<br>目标编码: 字符串, 转换后的编码, 常见有gb2312, gbk, utf-8等</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 转换成功后的字符串内容</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeConvCoding');">复制代码</div>
                <pre id="codeConvCoding">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//用电脑上的记事本写入一些中文内容后, 将该文件传到手机上测试
Dim 转码前内容 = File.Read("/sdcard/Pictures/文本.txt")
TracePrint 转码前内容
Dim 转码后内容 = zm.ConvCoding(转码前内容, "gb2312", "utf-8")
TracePrint 转码后内容</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1813: 插件加入本命令。</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="ConvCP1252ToUTF8" id="ConvCP1252ToUTF8"> <a href="https://zimaoxy.com/m/post/zm.convcp1252toutf8/" target="_blank">zm.ConvCP1252ToUTF8 CP1252转UTF8</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>将CP1252转为UTF8</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.ConvCP1252ToUTF8(CP1252码)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">CP1252码: 字符串, 要转换的CP1252码</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 返回UTF8字符串</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeConvCP1252ToUTF8');">复制代码</div>
                <pre id="codeConvCP1252ToUTF8">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//ISO-8859-1里的欧元符号
Dim str1252 = "1\128"
TracePrint str1252
//以UTF8输出欧元符号
Dim strutf8 = zm.ConvCP1252ToUTF8(str1252)
TracePrint strutf8
//UTF8转为CP1252
Dim str1252_2 = zm.ConvUTF8ToCP1252(strutf8)
TracePrint str1252_2</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1805: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="ConvUnicodeToUTF16" id="ConvUnicodeToUTF16"> <a href="https://zimaoxy.com/m/post/zm.convunicodetoutf16/" target="_blank">zm.ConvUnicodeToUTF16 Unicode转UTF16</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>将Unicode字符串转为以`\uXXXX`表示的UTF16字符串, 常用于获取emoji代码</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.ConvUnicodeToUTF16(unicode值)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">unicode值: 数值型或字符串, 要转换的Unicode值, 数值型表示十进制, 字符串型表示十六进制</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 返回以`\uXXXX`表示的UTF16字符串</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeConvUnicodeToUTF16');">复制代码</div>
                <pre id="codeConvUnicodeToUTF16">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

TracePrint zm.ConvUnicodeToUTF16("1F601") //显示\ud83d\ude01
TracePrint zm.ConvUnicodeToUTF16(128513) //显示\ud83d\ude01
TracePrint zm.ConvUnicodeToUTF16(&H1F601) //显示\ud83d\ude01</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>emoji整理网址: <https://apps.timwhitlock.info/emoji/tables/unicode><br>
V1.1802: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="ConvUnicodeToUTF8" id="ConvUnicodeToUTF8"> <a href="https://zimaoxy.com/m/post/zm.convunicodetoutf8/" target="_blank">zm.ConvUnicodeToUTF8 Unicode转UTF8</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>将Unicode转为UTF8</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.ConvUnicodeToUTF8(unicode值)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">unicode值: 数值型或字符串, 要转换的Unicode值, 数值型表示十进制, 字符串型表示十六进制</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 返回UTF8字符串</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeConvUnicodeToUTF8');">复制代码</div>
                <pre id="codeConvUnicodeToUTF8">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim 笑脸 = zm.ConvUnicodeToUTF8(&H1F601)
UI.NewLayout "layout1"
UI.AddTextView "layout1", "emoji", 笑脸
UI.Show "layout1"
TracePrint zm.ConvUTF8ToUnicode(笑脸)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>emoji整理网址: <https://apps.timwhitlock.info/emoji/tables/unicode><br>
V1.1805: 加入命令<br>
V3.1929: 现在支持 \uXXXX 格式的连续字符串内容转码</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="ConvUTF8ToCP1252" id="ConvUTF8ToCP1252"> <a href="https://zimaoxy.com/m/post/zm.convutf8tocp1252/" target="_blank">zm.ConvUTF8ToCP1252 UTF8转CP1252</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>将UTF8转为CP1252</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.ConvUTF8ToCP1252(UTF8)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">UTF8: 字符串, 要转换的UTF8字符串</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 返回CP1252字符串</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeConvUTF8ToCP1252');">复制代码</div>
                <pre id="codeConvUTF8ToCP1252">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//ISO-8859-1里的欧元符号
Dim str1252 = "1\128"
TracePrint str1252
//以UTF8输出欧元符号
Dim strutf8 = zm.ConvCP1252ToUTF8(str1252)
TracePrint strutf8
//UTF8转为CP1252
Dim str1252_2 = zm.ConvUTF8ToCP1252(strutf8)
TracePrint str1252_2</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1805: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="ConvUTF8ToUnicode" id="ConvUTF8ToUnicode"> <a href="https://zimaoxy.com/m/post/zm.convutf8tounicode/" target="_blank">zm.ConvUTF8ToUnicode UTF8转Unicode</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>将UTF8转为Unicode</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.ConvUTF8ToUnicode(UTF8)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">UTF8: 字符串, 要转换的UTF8</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数值型_ , 返回Unicode码</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeConvUTF8ToUnicode');">复制代码</div>
                <pre id="codeConvUTF8ToUnicode">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim 笑脸 = zm.ConvUnicodeToUTF8(&H1F601)
UI.NewLayout "layout1"
UI.AddTextView "layout1", "emoji", 笑脸
UI.Show "layout1"
TracePrint zm.ConvUTF8ToUnicode(笑脸)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1805: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="DecodeAES" id="DecodeAES"> <a href="https://zimaoxy.com/m/post/zm.decodeaes/" target="_blank">zm.DecodeAES AES解密</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>对数据进行标准AES解密, 支持AES128,AES196和AES256, 能对通过 <a href="https://zimaoxy.com/m/post/zm.encodeaes/" target="_blank">zm.encodeaes</a> 加密的结果进行解密还原。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.DecodeAES(密文, 密钥[, 高级属性])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">明文: 字符串, 待解密的密文内容。<br>密钥: 字符串, 用于解密的密钥。<br>高级属性: 表, 可选参数，用于设置加解密模式等选项，格式为{"属性名":"属性值",...}，详见下方表。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，返回解密后的结果，失败为null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeDecodeAES');">复制代码</div>
                <pre id="codeDecodeAES">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim text = "紫猫", pwd = "m.zimaoxy.com"
Dim s, v
s = zm.EncodeAES(text, pwd)
TracePrint "对明文", text, "使用密钥", pwd, "进行AES-ECB加密结果", s
v = zm.DecodeAES(s, pwd)
TracePrint "对密文", s, "使用密钥", pwd, "进行AES-ECB解密结果", v

s = zm.EncodeAES(text, pwd, {"cipherout":64})
TracePrint "对明文", text, "使用密钥", pwd, "进行AES加密输出Base64结果", s
v = zm.DecodeAES(s, pwd, {"cipherout":64})
TracePrint "对十六进制密文", s, "使用密钥", pwd, "进行AES解密输出Base64结果", v

s = zm.EncodeAES(text, pwd, {"mode":"cbc","iv":"1234567890abcdef"})
TracePrint "对明文", text, "使用密钥", pwd, "进行AES-CBC加密结果", s
v = zm.DecodeAES(s, pwd, {"mode":"cbc","iv":"1234567890abcdef"})
TracePrint "对十六进制密文", s, "使用密钥", pwd, "进行AES-CBC解密结果", v</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1723b: 初次加入<br>
V2.1828: <br>
  彻底解决加解密出错失败的问题<br>
  改为使用封装 https://github.com/somesocks/lua-lockbox 的代码, 不兼容旧版加解密结果!<br>
V3.1831:<br>
  修改为标准AES加解密, 注意不兼容上版本的加解密结果!<br>
  对密钥长度加入限制<br>
  修复解密结果包含`\0`字符的问题</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="DecodeBase64" id="DecodeBase64"> <a href="https://zimaoxy.com/m/post/zm.decodebase64/" target="_blank">zm.DecodeBase64 快速Base64文本解密</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>对一串文本内容进行快速Base64解密, 可通过 <a href="https://zimaoxy.com/m/post/zm.initbase64/" target="_blank">zm.initbase64</a> 设置模式</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.DecodeBase64(密文)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">密文: 字符串, 待解密的加密内容</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 返回Base64解密后的内容</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeDecodeBase64');">复制代码</div>
                <pre id="codeDecodeBase64">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim 原文 = "紫猫编程学院"
Dim 密文 = zm.EncodeBase64(原文)
TracePrint "Base64加密结果:", 密文

Dim 解密 = zm.DecodeBase64(密文)
If 解密 = 原文 Then 
	TracePrint "解密成功"
Else 
	TracePrint "解密失败"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>Base64模式可以通过 <a href="https://zimaoxy.com/m/post/zm.initbase64/" target="_blank">zm.initbase64</a> 来设置, 支持URL安全Base64加解密<br>
文件Base64解密请使用 <a href="https://zimaoxy.com/m/post/zm.decodebase64file/" target="_blank">zm.decodebase64file</a> <br>
V1.1821: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="DecodeBase64File" id="DecodeBase64File"> <a href="https://zimaoxy.com/m/post/zm.decodebase64file/" target="_blank">zm.DecodeBase64File 快速Base64文件解密</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>对一个文件进行快速Base64解密, 可通过 <a href="https://zimaoxy.com/m/post/zm.initbase64/" target="_blank">zm.initbase64</a> 设置模式</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.DecodeBase64File(加密文件路径, 解密保存路径)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">加密文件路径: 字符串, Base64文件路径, 文件必须存在<br>解密保存路径: 字符串, 解密文件保存的路径</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeDecodeBase64File');">复制代码</div>
                <pre id="codeDecodeBase64File">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//准备文件
Dim 原文件路径 = GetTempDir() & "紫猫编程学院.txt"
zm.FileWrite 原文件路径, "欢迎加入紫猫学院"

//文件加密
Dim 加密文件路径 = GetTempDir() & "加密.txt"
zm.EncodeBase64File 原文件路径, 加密文件路径
TracePrint "加密后的内容:", zm.FileRead(加密文件路径)

//文件解密
Dim 解密文件路径 = GetTempDir() & "解密.txt"
zm.DecodeBase64File 加密文件路径, 解密文件路径

//读取内容判断加解密是否成功
If zm.FileRead(解密文件路径) = "欢迎加入紫猫学院" Then 
	TracePrint "加解密成功"
Else 
	TracePrint "加解密结果不一致"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>Base64模式可以通过 <a href="https://zimaoxy.com/m/post/zm.initbase64/" target="_blank">zm.initbase64</a> 来设置, 支持URL安全Base64加解密<br>
文本Base64解密请使用 <a href="https://zimaoxy.com/m/post/zm.decodebase64/" target="_blank">zm.decodebase64</a> <br>
V1.1821: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="DecodeDES" id="DecodeDES"> <a href="https://zimaoxy.com/m/post/zm.decodedes/" target="_blank">zm.DecodeDES DES解密</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>对数据进行标准DES解密, 支持DES和DES3, 可以对 <a href="https://zimaoxy.com/m/post/zm.encodedes/" target="_blank">zm.encodedes</a> 结果解密。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.DecodeDES(密文, 密钥[, 高级属性])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">密文: 字符串, 待解密的密文内容。<br>密钥: 字符串, 用于解密的密钥。<br>高级属性: 表, 可选参数，用于设置加解密模式等选项，格式为{"属性名":"属性值",...}，详见下方表。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，返回解密后的结果，失败为null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeDecodeDES');">复制代码</div>
                <pre id="codeDecodeDES">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim text = "紫猫", pwd = "12345678"
Dim s, v
s = zm.EncodeDES(text, pwd)
TracePrint "对明文", text, "使用密钥", pwd, "进行DES-ECB加密结果", s
v = zm.DecodeDES(s, pwd)
TracePrint "对密文", s, "使用密钥", pwd, "进行DES-ECB解密结果", v

s = zm.EncodeDES(text, pwd, {"cipherout":64})
TracePrint "对明文", text, "使用密钥", pwd, "进行DES加密输出Base64结果", s
v = zm.DecodeDES(s, pwd, {"cipherout":64})
TracePrint "对十六进制密文", s, "使用密钥", pwd, "进行DES解密输出Base64结果", v

s = zm.EncodeDES(text, pwd, {"mode":"cbc","block":"des3","iv":"abcdefgh"})
TracePrint "对明文", text, "使用密钥", pwd, "进行DES3-CBC加密结果", s
v = zm.DecodeDES(s, pwd, {"mode":"cbc","block":"des3","iv":"abcdefgh"})
TracePrint "对十六进制密文", s, "使用密钥", pwd, "进行DES3-CBC解密结果", v</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V2.1828: <br>
  初次加入<br>
  封装 https://github.com/somesocks/lua-lockbox 的代码<br>
V3.1831: 加入密钥长度限制</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="DecodeTEA" id="DecodeTEA"> <a href="https://zimaoxy.com/m/post/zm.decodetea/" target="_blank">zm.DecodeTEA TEA解密</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>对数据进行TEA解密, 支持TEA和XTEA, 可以对 <a href="https://zimaoxy.com/m/post/zm.encodetea/" target="_blank">zm.encodetea</a> 结果解密。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.DecodeTEA(密文, 密钥[, 高级属性])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">密文: 字符串, 待解密的密文内容。<br>密钥: 字符串, 用于解密的密钥。<br>高级属性: 表, 可选参数，用于设置加解密模式等选项，格式为{"属性名":"属性值",...}，详见下方表。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，返回解密后的结果，失败为null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeDecodeTEA');">复制代码</div>
                <pre id="codeDecodeTEA">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim text = "紫猫", pwd = "m.zimaoxy.com"
Dim s, v
s = zm.EncodeTEA(text, pwd)
TracePrint "对明文", text, "使用密钥", pwd, "进行TEA-ECB加密结果", s
v = zm.DecodeTEA(s, pwd)
TracePrint "对密文", s, "使用密钥", pwd, "进行TEA-ECB解密结果", v

s = zm.EncodeTEA(text, pwd, {"cipherout":64})
TracePrint "对明文", text, "使用密钥", pwd, "进行TEA加密输出Base64结果", s
v = zm.DecodeTEA(s, pwd, {"cipherout":64})
TracePrint "对十六进制密文", s, "使用密钥", pwd, "进行TEA解密输出Base64结果", v

s = zm.EncodeTEA(text, pwd, {"mode":"cbc","block":"xtea","iv":"abcdefgh"})
TracePrint "对明文", text, "使用密钥", pwd, "进行XTEA-CBC加密结果", s
v = zm.DecodeTEA(s, pwd, {"mode":"cbc","block":"xtea","iv":"abcdefgh"})
TracePrint "对十六进制密文", s, "使用密钥", pwd, "进行XTEA-CBC解密结果", v</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V2.1828: <br>
  初次加入<br>
  封装 https://github.com/somesocks/lua-lockbox 的代码<br>
V3.1831: 加入密钥长度限制</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="DecodeURL" id="DecodeURL"> <a href="https://zimaoxy.com/m/post/zm.decodeurl/" target="_blank">zm.DecodeURL URL解码</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>对 <a href="https://zimaoxy.com/m/post/zm.encodeurl/" target="_blank">zm.encodeurl</a> 产生的密文进行解密还原。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.DecodeURL(密文)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">密文: 字符串, 经过URL编码的字符串内容。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，返回URL解码后的内容。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeDecodeURL');">复制代码</div>
                <pre id="codeDecodeURL">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim urls = zm.EncodeURL("紫猫")
TracePrint "对紫猫进行URL编码，得到", urls
Dim data = zm.DecodeURL(urls)
TracePrint "对", urls, "进行URL解码，得到", data</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>+会被转为空格，保留数字、英文和`-_.~`。<br>
仅支持3.2.1版本以上的按键。<br>
V1.1723b: 初次加入</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="EncodeAES" id="EncodeAES"> <a href="https://zimaoxy.com/m/post/zm.encodeaes/" target="_blank">zm.EncodeAES AES加密</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>高级加密标准（英语：Advanced Encryption Standard，缩写：AES），是美国联邦政府采用的一种区块加密标准。属于对称加密的一种，能通过 <a href="https://zimaoxy.com/m/post/zm.decodeaes/" target="_blank">zm.decodeaes</a> 进行解密还原, 支持AES128,AES196和AES256。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.EncodeAES(明文, 密钥[, 高级属性])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">明文: 字符串, 待加密的明文内容。<br>密钥: 字符串, 用于加密的密钥。<br>高级属性: 表, 可选参数，用于设置加解密模式等选项，格式为{"属性名":"属性值",...}，详见下方表。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，返回加密后的结果，失败为null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeEncodeAES');">复制代码</div>
                <pre id="codeEncodeAES">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim text = "紫猫", pwd = "m.zimaoxy.com"
Dim s, v
s = zm.EncodeAES(text, pwd)
TracePrint "对明文", text, "使用密钥", pwd, "进行AES-ECB加密结果", s
v = zm.DecodeAES(s, pwd)
TracePrint "对密文", s, "使用密钥", pwd, "进行AES-ECB解密结果", v

s = zm.EncodeAES(text, pwd, {"cipherout":64})
TracePrint "对明文", text, "使用密钥", pwd, "进行AES加密输出Base64结果", s
v = zm.DecodeAES(s, pwd, {"cipherout":64})
TracePrint "对十六进制密文", s, "使用密钥", pwd, "进行AES解密输出Base64结果", v

s = zm.EncodeAES(text, pwd, {"mode":"cbc","iv":"1234567890abcdef"})
TracePrint "对明文", text, "使用密钥", pwd, "进行AES-CBC加密结果", s
v = zm.DecodeAES(s, pwd, {"mode":"cbc","iv":"1234567890abcdef"})
TracePrint "对十六进制密文", s, "使用密钥", pwd, "进行AES-CBC解密结果", v</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1723b: 初次加入<br>
V2.1828: <br>
  彻底解决加解密出错失败的问题<br>
  改为使用封装 https://github.com/somesocks/lua-lockbox 的代码, 不兼容旧版加解密结果!<br>
V3.1831:<br>
  修改为标准AES加解密, 注意不兼容上版本的加解密结果!<br>
  对密钥长度加入限制<br>
  修复解密结果包含`\0`字符的问题</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="EncodeBase64" id="EncodeBase64"> <a href="https://zimaoxy.com/m/post/zm.encodebase64/" target="_blank">zm.EncodeBase64 快速Base64文本加密</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>对一串文本内容进行快速Base64加密, 可通过 <a href="https://zimaoxy.com/m/post/zm.initbase64/" target="_blank">zm.initbase64</a> 设置加密模式</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.EncodeBase64(原文)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">原文: 字符串, 待加密的原文本内容</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 返回Base64加密后的内容</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeEncodeBase64');">复制代码</div>
                <pre id="codeEncodeBase64">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim 原文 = "紫猫编程学院"
Dim 密文 = zm.EncodeBase64(原文)
TracePrint "Base64加密结果:", 密文

Dim 解密 = zm.DecodeBase64(密文)
If 解密 = 原文 Then 
	TracePrint "解密成功"
Else 
	TracePrint "解密失败"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>Base64模式可以通过 <a href="https://zimaoxy.com/m/post/zm.initbase64/" target="_blank">zm.initbase64</a> 来设置, 支持URL安全Base64加密<br>
加密后的文本可以用 <a href="https://zimaoxy.com/m/post/zm.decodebase64/" target="_blank">zm.decodebase64</a> 进行解密<br>
文件Base64加密请使用 <a href="https://zimaoxy.com/m/post/zm.encodebase64file/" target="_blank">zm.encodebase64file</a> <br>
V1.1821: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="EncodeBase64File" id="EncodeBase64File"> <a href="https://zimaoxy.com/m/post/zm.encodebase64file/" target="_blank">zm.EncodeBase64File 快速Base64文件加密</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>对一个文件进行快速Base64加密, 可通过 <a href="https://zimaoxy.com/m/post/zm.initbase64/" target="_blank">zm.initbase64</a> 设置模式</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.EncodeBase64File(原文件路径, 加密保存路径)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">原文件路径: 字符串, 待加密的文件路径, 文件必须存在<br>加密保存路径: 字符串, 加密文件保存的路径</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeEncodeBase64File');">复制代码</div>
                <pre id="codeEncodeBase64File">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//准备文件
Dim 原文件路径 = GetTempDir() & "紫猫编程学院.txt"
zm.FileWrite 原文件路径, "欢迎加入紫猫学院"

//文件加密
Dim 加密文件路径 = GetTempDir() & "加密.txt"
zm.EncodeBase64File 原文件路径, 加密文件路径
TracePrint "加密后的内容:", zm.FileRead(加密文件路径)

//文件解密
Dim 解密文件路径 = GetTempDir() & "解密.txt"
zm.DecodeBase64File 加密文件路径, 解密文件路径

//读取内容判断加解密是否成功
If zm.FileRead(解密文件路径) = "欢迎加入紫猫学院" Then 
	TracePrint "加解密成功"
Else 
	TracePrint "加解密结果不一致"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>Base64模式可以通过 <a href="https://zimaoxy.com/m/post/zm.initbase64/" target="_blank">zm.initbase64</a> 来设置, 支持URL安全Base64加解密<br>
文本Base64加密请使用 <a href="https://zimaoxy.com/m/post/zm.encodebase64/" target="_blank">zm.encodebase64</a> <br>
V1.1821: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="EncodeDES" id="EncodeDES"> <a href="https://zimaoxy.com/m/post/zm.encodedes/" target="_blank">zm.EncodeDES DES加密</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>对数据进行标准DES加密, 支持DES和DES3。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.EncodeDES(明文, 密钥[, 高级属性])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">明文: 字符串, 待加密的明文内容。<br>密钥: 字符串, 用于加密的密钥。<br>高级属性: 表, 可选参数，用于设置加解密模式等选项，格式为{"属性名":"属性值",...}，详见下方表。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，返回加密后的结果，失败为null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeEncodeDES');">复制代码</div>
                <pre id="codeEncodeDES">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim text = "紫猫", pwd = "12345678"
Dim s, v
s = zm.EncodeDES(text, pwd)
TracePrint "对明文", text, "使用密钥", pwd, "进行DES-ECB加密结果", s
v = zm.DecodeDES(s, pwd)
TracePrint "对密文", s, "使用密钥", pwd, "进行DES-ECB解密结果", v

s = zm.EncodeDES(text, pwd, {"cipherout":64})
TracePrint "对明文", text, "使用密钥", pwd, "进行DES加密输出Base64结果", s
v = zm.DecodeDES(s, pwd, {"cipherout":64})
TracePrint "对十六进制密文", s, "使用密钥", pwd, "进行DES解密输出Base64结果", v

s = zm.EncodeDES(text, pwd, {"mode":"cbc","block":"des3","iv":"abcdefgh"})
TracePrint "对明文", text, "使用密钥", pwd, "进行DES3-CBC加密结果", s
v = zm.DecodeDES(s, pwd, {"mode":"cbc","block":"des3","iv":"abcdefgh"})
TracePrint "对十六进制密文", s, "使用密钥", pwd, "进行DES3-CBC解密结果", v</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V2.1828: <br>
  初次加入<br>
  封装 https://github.com/somesocks/lua-lockbox 的代码<br>
V3.1831: 加入密钥长度限制</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="EncodeHMAC" id="EncodeHMAC"> <a href="https://zimaoxy.com/m/post/zm.encodehmac/" target="_blank">zm.EncodeHMAC HMAC签名</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>计算消息的HMAC签名结果, 支持md2,md4,md5,sha1,sha224,sha256,ripemd128,ripemd160算法</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.EncodeHMAC(消息, 密钥[, 算法[, 返回格式]])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">消息: 字符串, 待计算的消息内容<br>密钥: 字符串, 用于计算的密钥<br>算法: 字符串, 可选, 省略默认为sha1算法, 可填写md2,md4,md5,sha1,sha224,sha256,ripemd128,ripemd160<br>返回格式: number, 可选, 表示返回值内容, 省略默认为16, 0为原生二进制数据字符串, 2为字节数组, 16为十六进制字符串, 64为原生内容base64编码</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 返回HMAC签名结果, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeEncodeHMAC');">复制代码</div>
                <pre id="codeEncodeHMAC">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim m = "紫猫学院", key = "zimaoxy.com"

Dim hmac = zm.EncodeHMAC(m, key)

TracePrint "hmac-sha1签名的十六进制结果为:", hmac</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V2.1828: <br>
  初次加入<br>
  封装 https://github.com/somesocks/lua-lockbox 的代码<br>
V2.1829: 算法参数与返回格式参数可以乱序</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="EncodeMD5" id="EncodeMD5"> <a href="https://zimaoxy.com/m/post/zm.encodemd5/" target="_blank">zm.EncodeMD5 MD5计算</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>对数据进行MD5计算, 支持MD2,MD4和MD5</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.EncodeMD5(数据[, 算法])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">数据: 字符串, 待计算的原始数据<br>算法: 字符串, 可选, 省略默认为md5, 可填写md2, md4, md5</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 返回计算结果</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeEncodeMD5');">复制代码</div>
                <pre id="codeEncodeMD5">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim s = "紫猫"

TracePrint "md5:", zm.EncodeMD5(s)
TracePrint "md4:", zm.EncodeMD5(s, "md4")
TracePrint "md2:", zm.EncodeMD5(s, "md2")</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V2.1828: <br>
  初次加入<br>
  封装 https://github.com/somesocks/lua-lockbox 的代码</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="EncodeMD5File" id="EncodeMD5File"> <a href="https://zimaoxy.com/m/post/zm.encodemd5file/" target="_blank">zm.EncodeMD5File 计算文件MD5值</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>计算一个文件的MD5值。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.EncodeMD5File(文件路径)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">文件路径: 字符串, 要计算MD5值的文件路径</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，返回指定文件的MD5值。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeEncodeMD5File');">复制代码</div>
                <pre id="codeEncodeMD5File">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim p = GetTempDir() & "Plugin/File.lua"
Dim md5 = zm.EncodeMD5File(p)
TracePrint md5</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1730: 初次加入。</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="EncodeRIPEMD" id="EncodeRIPEMD"> <a href="https://zimaoxy.com/m/post/zm.encoderipemd/" target="_blank">zm.EncodeRIPEMD RIPEMD计算</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>对数据进行RIPEMD计算, 支持RIPEMD128和RIPEMD160</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.EncodeRIPEMD(数据[, 算法])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">数据: 字符串, 待计算的原始数据<br>算法: 字符串, 可选, 省略默认为ripemd128, 可填写ripemd128, ripemd160</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 返回计算结果</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeEncodeRIPEMD');">复制代码</div>
                <pre id="codeEncodeRIPEMD">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim s = "紫猫"

TracePrint "ripemd128:", zm.EncodeRIPEMD(s)
TracePrint "ripemd160:", zm.EncodeRIPEMD(s, "ripemd160")</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V2.1828: <br>
  初次加入<br>
  封装 https://github.com/somesocks/lua-lockbox 的代码</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="EncodeRsaSign" id="EncodeRsaSign"> <a href="https://zimaoxy.com/m/post/zm.encodersasign/" target="_blank">zm.EncodeRsaSign RSA签名</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>对数据使用私钥进行RSA签名, 返回签名结果</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">签名结果 = zm.EncodeRsaSign(数据, 私钥)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">数据: 字符串, 待签名的数据内容<br>私钥: 字符串, 使用的RSA私钥</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 返回签名后的文本数据</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeEncodeRsaSign');">复制代码</div>
                <pre id="codeEncodeRsaSign">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

'通过一些网站或其他方式生成RSA公钥与私钥, 请勿照抄例子的密钥对
Dim 数据 = "紫猫学院 http://zimaoxy.com/"

Dim 公钥 = "-----BEGIN PUBLIC KEY-----\n" &_
"MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC6tcUS8HFLG1fSthJwMvQsMbsY\n" &_
"2sSqTpSTfHrJzF9mVa/O6fLAZWMuWpi1QBWFy6GDDONMn5Rw0Dkg9jG3Okxojxqu\n" &_
"2bZnXflW6FbuDPG1kWj80DNuKXmGKQ3HpqLuk89Zn3LjS0jAYAQM2Z/Xdad+JM4u\n" &_
"9peQQ8WwiTff7rj6owIDAQAB\n" &_
"-----END PUBLIC KEY-----\n"

Dim 私钥 = "-----BEGIN PRIVATE KEY-----\n" &_
"MIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBALq1xRLwcUsbV9K2\n" &_
"EnAy9CwxuxjaxKpOlJN8esnMX2ZVr87p8sBlYy5amLVAFYXLoYMM40yflHDQOSD2\n" &_
"Mbc6TGiPGq7Ztmdd+VboVu4M8bWRaPzQM24peYYpDcemou6Tz1mfcuNLSMBgBAzZ\n" &_
"n9d1p34kzi72l5BDxbCJN9/uuPqjAgMBAAECgYBrIM5xvnoS0R6D7SoJLINDNEmY\n" &_
"yjVbTnkbYqoFTXlTe0jDnSJG2CWfPCYwoRN4UE1cpzFoDowaaq7MxdXivtWFkbIw\n" &_
"D1nxLexZ85ocNb5NSKIIh76THttZJtqkN42F1mJyaPjtTrv1HEpAzcE0NApNWsoa\n" &_
"vTRwAsJn/RQtASbSeQJBAOQUasteKjTwKG32y617eP1YKLlN2Yur0ovpty8gUf9g\n" &_
"3wPDxUp3jpTK/8hhOdHf44I9c+daC4Tir73mebsie28CQQDRkOerEiWzce4G/mFE\n" &_
"EeaPZm5FX8OYY1O6omf2JaAyCnbol2O4Ffn5P8GZ2mxXc79j/zvpbXqs4jVSOTk7\n" &_
"j6oNAkBgPLE3MHt0rOUSSTF1+QR7OaitT8j8YzrK6Inv655NuI1BZGip3DqgU+uL\n" &_
"nGKuSN8RhGaUdu0nXBM1eLtil9EnAkEAzjB1T+LWBz1kRatJRfEa2SKeAlHbn3ay\n" &_
"7eFWyl9ww2t6XRR+v6OXxH3PXTIEAPNYbum0J9JYrfsPHWxB/HE4jQJAeZCtTRUQ\n" &_
"Kw699c31ERDde8l8wgO7j+VHvxcvabk+IGA6ktM6Z/Hsiy2Y2TZ+kwM6vIdftJPs\n" &_
"XdiEBtyEVQFQig==\n" &_
"-----END PRIVATE KEY-----\n"

Dim 签名结果 = zm.EncodeRsaSign(数据, 私钥)
TracePrint 签名结果

Dim 验证结果 = zm.EncodeRsaVerifySign(数据, 签名结果, 公钥)
TracePrint 验证结果</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>请自行通过其他途径生成密钥对.<br>
V4.2015<br>
 初次加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="EncodeRsaVerifySign" id="EncodeRsaVerifySign"> <a href="https://zimaoxy.com/m/post/zm.encodersaverifysign/" target="_blank">zm.EncodeRsaVerifySign RSA签名验证</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>对RSA签名数据使用公钥进行验证对比是否一致</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.EncodeRsaVerifySign(源数据, 签名数据, 公钥)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">源数据: 字符串, 待验证的源数据内容<br>签名数据: 字符串, 由RSA私钥签名后的数据内容<br>公钥: 字符串, 用于验证的RSA公钥</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">布尔型_ , 验证通过返回true, 验证不通过返回false</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeEncodeRsaVerifySign');">复制代码</div>
                <pre id="codeEncodeRsaVerifySign">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

'通过一些网站或其他方式生成RSA公钥与私钥, 请勿照抄例子的密钥对
Dim 数据 = "紫猫学院 http://zimaoxy.com/"

Dim 公钥 = "-----BEGIN PUBLIC KEY-----\n" &_
"MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC6tcUS8HFLG1fSthJwMvQsMbsY\n" &_
"2sSqTpSTfHrJzF9mVa/O6fLAZWMuWpi1QBWFy6GDDONMn5Rw0Dkg9jG3Okxojxqu\n" &_
"2bZnXflW6FbuDPG1kWj80DNuKXmGKQ3HpqLuk89Zn3LjS0jAYAQM2Z/Xdad+JM4u\n" &_
"9peQQ8WwiTff7rj6owIDAQAB\n" &_
"-----END PUBLIC KEY-----\n"

Dim 私钥 = "-----BEGIN PRIVATE KEY-----\n" &_
"MIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBALq1xRLwcUsbV9K2\n" &_
"EnAy9CwxuxjaxKpOlJN8esnMX2ZVr87p8sBlYy5amLVAFYXLoYMM40yflHDQOSD2\n" &_
"Mbc6TGiPGq7Ztmdd+VboVu4M8bWRaPzQM24peYYpDcemou6Tz1mfcuNLSMBgBAzZ\n" &_
"n9d1p34kzi72l5BDxbCJN9/uuPqjAgMBAAECgYBrIM5xvnoS0R6D7SoJLINDNEmY\n" &_
"yjVbTnkbYqoFTXlTe0jDnSJG2CWfPCYwoRN4UE1cpzFoDowaaq7MxdXivtWFkbIw\n" &_
"D1nxLexZ85ocNb5NSKIIh76THttZJtqkN42F1mJyaPjtTrv1HEpAzcE0NApNWsoa\n" &_
"vTRwAsJn/RQtASbSeQJBAOQUasteKjTwKG32y617eP1YKLlN2Yur0ovpty8gUf9g\n" &_
"3wPDxUp3jpTK/8hhOdHf44I9c+daC4Tir73mebsie28CQQDRkOerEiWzce4G/mFE\n" &_
"EeaPZm5FX8OYY1O6omf2JaAyCnbol2O4Ffn5P8GZ2mxXc79j/zvpbXqs4jVSOTk7\n" &_
"j6oNAkBgPLE3MHt0rOUSSTF1+QR7OaitT8j8YzrK6Inv655NuI1BZGip3DqgU+uL\n" &_
"nGKuSN8RhGaUdu0nXBM1eLtil9EnAkEAzjB1T+LWBz1kRatJRfEa2SKeAlHbn3ay\n" &_
"7eFWyl9ww2t6XRR+v6OXxH3PXTIEAPNYbum0J9JYrfsPHWxB/HE4jQJAeZCtTRUQ\n" &_
"Kw699c31ERDde8l8wgO7j+VHvxcvabk+IGA6ktM6Z/Hsiy2Y2TZ+kwM6vIdftJPs\n" &_
"XdiEBtyEVQFQig==\n" &_
"-----END PRIVATE KEY-----\n"

Dim 签名结果 = zm.EncodeRsaSign(数据, 私钥)
TracePrint 签名结果

Dim 验证结果 = zm.EncodeRsaVerifySign(数据, 签名结果, 公钥)
TracePrint 验证结果</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>请自行通过其他途径生成密钥对.<br>
V4.2015<br>
 初次加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="EncodeSHA" id="EncodeSHA"> <a href="https://zimaoxy.com/m/post/zm.encodesha/" target="_blank">zm.EncodeSHA SHA计算</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>对数据进行SHA签名计算, 支持SHA1,SHA224和SHA256</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.EncodeSHA(数据[, 算法])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">数据: 字符串, 待计算的原始数据<br>算法: 字符串, 可选, 签名使用的算法, 省略默认为sha1, 可填写sha1, sha224, sha256</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 返回计算结果</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeEncodeSHA');">复制代码</div>
                <pre id="codeEncodeSHA">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim s = "紫猫"

TracePrint "sha1:", zm.EncodeSHA(s)
TracePrint "sha224:", zm.EncodeSHA(s, "sha224")
TracePrint "sha256:", zm.EncodeSHA(s, "sha256")</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V2.1828: <br>
  初次加入<br>
  封装 https://github.com/somesocks/lua-lockbox 的代码</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="EncodeTEA" id="EncodeTEA"> <a href="https://zimaoxy.com/m/post/zm.encodetea/" target="_blank">zm.EncodeTEA TEA加密</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>对数据进行TEA加密, 支持TEA和XTEA。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.EncodeTEA(明文, 密钥[, 高级属性])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">明文: 字符串, 待加密的明文内容。<br>密钥: 字符串, 用于加密的密钥。<br>高级属性: 表, 可选参数，用于设置加解密模式等选项，格式为{"属性名":"属性值",...}，详见下方表。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，返回加密后的结果，失败为null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeEncodeTEA');">复制代码</div>
                <pre id="codeEncodeTEA">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim text = "紫猫", pwd = "m.zimaoxy.com"
Dim s, v
s = zm.EncodeTEA(text, pwd)
TracePrint "对明文", text, "使用密钥", pwd, "进行TEA-ECB加密结果", s
v = zm.DecodeTEA(s, pwd)
TracePrint "对密文", s, "使用密钥", pwd, "进行TEA-ECB解密结果", v

s = zm.EncodeTEA(text, pwd, {"cipherout":64})
TracePrint "对明文", text, "使用密钥", pwd, "进行TEA加密输出Base64结果", s
v = zm.DecodeTEA(s, pwd, {"cipherout":64})
TracePrint "对十六进制密文", s, "使用密钥", pwd, "进行TEA解密输出Base64结果", v

s = zm.EncodeTEA(text, pwd, {"mode":"cbc","block":"xtea","iv":"abcdefgh"})
TracePrint "对明文", text, "使用密钥", pwd, "进行XTEA-CBC加密结果", s
v = zm.DecodeTEA(s, pwd, {"mode":"cbc","block":"xtea","iv":"abcdefgh"})
TracePrint "对十六进制密文", s, "使用密钥", pwd, "进行XTEA-CBC解密结果", v</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V2.1828: <br>
  初次加入<br>
  封装 https://github.com/somesocks/lua-lockbox 的代码<br>
V3.1831: 加入密钥长度限制</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="EncodeURL" id="EncodeURL"> <a href="https://zimaoxy.com/m/post/zm.encodeurl/" target="_blank">zm.EncodeURL URL编码</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>对参数进行URL编码，常用于网址参数中，例如`紫猫`编码后就是`%E7%B4%AB%E7%8C%AB`。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.EncodeURL(明文)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">明文: 字符串, 待编码的内容。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，返回URL编码后的内容。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeEncodeURL');">复制代码</div>
                <pre id="codeEncodeURL">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim urls = zm.EncodeURL("紫猫")
TracePrint "对紫猫进行URL编码，得到", urls
Dim data = zm.DecodeURL(urls)
TracePrint "对", urls, "进行URL解码，得到", data</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>空格会被转为+，保留数字、英文和`-_.~`。<br>
仅支持3.2.1版本以上的按键。<br>
V1.1723b: 初次加入</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="InitBase64" id="InitBase64"> <a href="https://zimaoxy.com/m/post/zm.initbase64/" target="_blank">zm.InitBase64 初始化Base64模式</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>初始化设置Base64的加解密模式, 支持URL安全Base64, 默认为标准Base64, 已集成到 <a href="https://zimaoxy.com/m/post/zm.init/" target="_blank">zm.init</a> 中</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.InitBase64([字符表[, 填充符]])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">字符表: 数值型_或_字符串, 可选, 省略默认为标准Base64加解密, 数值1为base64标准加解密, 数值2为base64url安全加解密, 数值3为base64noterm标准无填充加解密, 填写长度64的不重复字符串时表示自定义编码表<br>填充符: 字符串, 可选, 省略默认为标准Base64加解密, 末尾填充字符</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeInitBase64');">复制代码</div>
                <pre id="codeInitBase64">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//默认为标准Base64加解密
//zm.InitBase64
TracePrint zm.EncodeBase64("紫猫学院zimaoxy.com")
TracePrint "紫猫学院zimaoxy.com" = zm.DecodeBase64("57Sr54yr5a2m6ZmiemltYW94eS5jb20=")

//使用URL安全Base64加解密, 对所有base64相关命令生效
zm.InitBase64 2
TracePrint zm.EncodeBase64("紫猫学院zimaoxy.com")
TracePrint "紫猫学院zimaoxy.com" = zm.DecodeBase64("57Sr54yr5a2m6ZmiemltYW94eS5jb20")

//自定义字符表编码与填充符
Dim 字符表编码 = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!"
Dim 填充符 = "%"
zm.InitBase64 字符表编码, 填充符
TracePrint zm.EncodeBase64("紫猫学院zimaoxy.com")
TracePrint "紫猫学院zimaoxy.com" = zm.DecodeBase64("vxIhvuohvQscwPcYUcbjOMzuUIvZRsq%")</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>该命令已集成到 <a href="https://zimaoxy.com/m/post/zm.init/" target="_blank">zm.init</a> 中<br>
对所有的Base64系列命令有影响<br>
V1.1821: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="GetGateway" id="GetGateway"> <a href="https://zimaoxy.com/m/post/zm.getgateway/" target="_blank">zm.GetGateway 获取默认网关地址</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>获取默认网关地址。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.GetGateway()</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">无</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，返回当前默认网关地址。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeGetGateway');">复制代码</div>
                <pre id="codeGetGateway">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

TracePrint zm.GetGateway()</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1805: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="GetIPNet" id="GetIPNet"> <a href="https://zimaoxy.com/m/post/zm.getipnet/" target="_blank">zm.GetIPNet 获取外网IP</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>获取外网IP地址等信息, 根据参数决定返回内容</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.GetIPNet([返回格式[, 接口[, 缓存 ] ] ])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">返回格式: 数值型, 可选, 填写0表示只返回ip地址字符串, 填写大于0的数字表示返回详细信息表, 包括省份等内容, 不同数字代表不同接口的返回值, 省略默认为0<br>接口: 数值型, 可选, 仅在`返回格式`为0时有效, 0时表示随机接口, 大于0时表示指定接口, 不同数值代表不同接口, 省略默认为0<br>缓存: 布尔型, 可选, 是否强制获取最新数据, `true`是刷新缓存获取最新数据, `false`是以接口自身设定为准, 省略默认为`false`</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ 或 _表_ , 返回ip或详细信息表, 由参数返回格式决定返回内容, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeGetIPNet');">复制代码</div>
                <pre id="codeGetIPNet">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//强烈建议使用默认参数直接获取ip, 内置数十个接口, 保证稳定性
Dim ip = zm.GetIPNet()
TracePrint "我的ip是:", ip

//不同接口的返回值格式与内容均有所不同, 由于部分接口可能不稳定, 故不推荐使用此方法
Dim ipt
For i = 1 to 7
  ipt = zm.GetIPNet(i)
  If ipt Then
    TracePrint "接口", i, zm.VarInfo(ipt)
  Else
    TracePrint "接口", i, "获取ip失败"
  End If
Next</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1818: 加入命令<br>
V3.1833: 增加多个接口, 提高获取ip稳定性<br>
V4.2015: 更新部分接口<br>
V4.2025: 取消内置失败时循环获取功能, 加入`接口`参数<br>
v4.2118: 加入是否强制刷新缓存参数</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="HttpDownload" id="HttpDownload"> <a href="https://zimaoxy.com/m/post/zm.httpdownload/" target="_blank">zm.HttpDownload 下载文件</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>以HTTP协议的Get方法下载文件, 支持提交cookie与头信息</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.HttpDownload([对象][网址][,保存路径][,提交cookie][,请求头信息][,自定义])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象: table, 可选, 若填写对象将忽略其他参数, 格式为{"url":"网址", "path":"保存路径", "cookie":"cookie字符串或文件", "header":{"头信息1", "头信息2"}, "customize":"自定义curl参数"}<br>网址: string, 可选, 与对象参数二选一填写, 文件的下载地址<br>保存路径: string, 可选, 文件的保存路径, 省略为当前路径下的默认文件名<br>提交cookie: string, 可选, 要提交的cookie字符串或者cookie文件路径, 省略为""<br>请求头信息: string&#124;table, 可选, 要提交的头信息, 多个头信息可用一维数组传入, 省略为""<br>自定义: string, 可选, curl的高级参数, 一般不需要填写, 省略默认为""</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeHttpDownload');">复制代码</div>
                <pre id="codeHttpDownload">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

zm.HttpDownload "http://m.anjian.com/download/MobileAnjian3.2.9.apk", "/sdcard/anjian.apk"</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>ios设备需要安装cURL（来自Cydia/Telesphoreo）后使用本命令<br>
V1.1813: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="HttpGet" id="HttpGet"> <a href="https://zimaoxy.com/m/post/zm.httpget/" target="_blank">zm.HttpGet 获取网页源码</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>以Http协议的Get方法获取网页源码, 支持提交cookie与头信息, 可保存当前cookie文件</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.HttpGet([对象][网址][,网页编码][,保存cookie][,提交cookie][,请求头信息][,自定义])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象: table, 可选, 若填写对象将忽略其他参数, 格式为 `{"url":"网址","code":"网页编码", "setcookie":"保存cookie文件路径", "cookie":"发送cookie字符串或文件", "header":{"头信息名1":"头信息值1", "头信息名2":"头信息值2"}, "customize":"自定义curl参数"}`<br>网址: string, 可选, 与对象参数二选一, 要获取网页源码的网址<br>网页编码: string, 可选, 省略默认为"UTF-8", 可通过右击查看网页源码中的charset获知正确编码<br>保存cookie: string, 可选, 省略默认为"", 表示保存cookie的路径, 可用 <a href="https://zimaoxy.com/m/post/zm.filetemp/" target="_blank">zm.filetemp</a> 生成路径保存<br>提交cookie: string, 可选, 省略默认为"", 要提交的cookie字符串或者cookie文件路径<br>请求头信息: string&#124;table, 可选, 要提交的头信息, 多个头信息可用一维数组传入, 省略为""<br>自定义: string, 可选, curl的高级参数, 一般不需要填写, 省略默认为""</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 获取的网页源码内容</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeHttpGet');">复制代码</div>
                <pre id="codeHttpGet">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

TracePrint zm.HttpGet("www.baidu.com")</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1813: 加入命令<br>
V3.1837: 内置10秒超时<br>
V4.2039: 头信息参数兼容格式 `"header":{"头信息名1":"头信息值1", "头信息名2":"头信息值2"}`</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="HttpPost" id="HttpPost"> <a href="https://zimaoxy.com/m/post/zm.httppost/" target="_blank">zm.HttpPost 提交网页数据</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>以Http协议的Post方法提交数据并获取网页源码, 支持提交cookie与头信息, 可保存当前cookie文件</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.HttpPost([对象][网址][,提交数据][,网页编码][,保存cookie][,提交cookie][,请求头信息][,自定义])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象: table, 可选, 若填写对象将忽略其他参数, 格式为`{"url":"网址","data":"提交数据","code":"网页编码", "setcookie":"保存cookie文件路径", "cookie":"发送cookie字符串或文件", "header":{"头信息名1":"头信息值1", "头信息名2":"头信息值2"}, "customize":"自定义curl参数"}`<br>网址: string, 可选, 与对象参数二选一, 要获取网页源码的网址<br>提交数据: string, 可选, 省略默认为"", 包含中文或空格之类时, 建议先使用 <a href="https://zimaoxy.com/m/post/zm.encodeurl/" target="_blank">zm.encodeurl</a> 进行编码转换后传入<br>网页编码: string, 可选, 省略默认为"UTF-8", 可通过右击查看网页源码中的charset获知正确编码<br>保存cookie: string, 可选, 省略默认为"", 表示保存cookie的路径, 可用 <a href="https://zimaoxy.com/m/post/zm.filetemp/" target="_blank">zm.filetemp</a> 生成路径保存<br>提交cookie: string, 可选, 省略默认为"", 要提交的cookie字符串或者cookie文件路径<br>请求头信息: string&#124;table, 可选, 要提交的头信息, 多个头信息可用一维数组传入, 省略为""<br>自定义: string, 可选, curl的高级参数, 一般不需要填写, 省略默认为""</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 获取的网页源码内容</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeHttpPost');">复制代码</div>
                <pre id="codeHttpPost">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

TracePrint zm.HttpPost("www.baidu.com")</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1813: 加入命令<br>
V3.1837: 强制post提交, 内置10秒超时<br>
V4.2039: 头信息参数兼容格式 `"header":{"头信息名1":"头信息值1", "头信息名2":"头信息值2"}`</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="NetDataCount" id="NetDataCount"> <a href="https://zimaoxy.com/m/post/zm.netdatacount/" target="_blank">zm.NetDataCount 网络数据行数</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>从数据表中获取数据总数量</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.NetDataCount([数据表名])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">数据表名: 字符串, 可选, 省略默认为初始化的数据表名, 数据表必须存在</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数值型_ , 返回数据表的总行数</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeNetDataCount');">复制代码</div>
                <pre id="codeNetDataCount">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

zm.NetDataInit "http://192.168.1.100/sql.php", "测试脚本", "QQ345911220"

zm.NetDataSet "等级", 99
zm.NetDataSet "昵称", "紫猫"
zm.NetDataSet "VIP", True

Dim 总数量 = zm.NetDataCount()
TracePrint "一共有", 总数量, "个数据"</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本功能是使用POST提交至PHP网站的数据库操作, 实现多设备共享网络数据, 所以需要自行搭建网站程序才可使用, 具体搭建方法见教程帖子 >> [https://zimaoxy.com/b/t-2876-1-1.html](https://zimaoxy.com/b/t-2876-1-1.html)<br>
<br>
脚本开头必须先调用一次 <a href="https://zimaoxy.com/m/post/zm.netdatainit/" target="_blank">zm.netdatainit</a> <br>
V1.1818: 加入命令<br>
V3.1903: 大幅度提高执行效率<br>
V4.2113: <br>
  更新 `sql.php` 与 `medoo.php` 程序, 对旧版有影响, 请参考上面教程帖子操作<br>
  全新的环境搭建教程</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="NetDataDel" id="NetDataDel"> <a href="https://zimaoxy.com/m/post/zm.netdatadel/" target="_blank">zm.NetDataDel 删除网络数据</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>从数据表中删除指定共享网络数据, 仅删除一个变量数据, 不会清空所有数据</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.NetDataDel(键名[, 数据表名])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">键名: 字符串, 类似于变量名, 区分大小写<br>数据表名: 字符串, 可选, 从指定数据表中删除共享数据, 数据表必须存在, 省略默认为初始化时的数据表名</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeNetDataDel');">复制代码</div>
                <pre id="codeNetDataDel">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//初始化创建表, 并且不清空以前数据
zm.NetDataInit "http://192.168.1.100/sql.php", "测试脚本", "QQ345911220"

zm.NetDataSet "等级", 99
zm.NetDataSet "昵称", "紫猫"
zm.NetDataSet "VIP", True

Dim VIP = zm.NetDataGet("VIP")
TracePrint zm.VarInfo(VIP)

zm.NetDataDel "VIP"

Dim 检查删除结果 = zm.NetDataGet("VIP")
TracePrint 检查删除结果</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本功能是使用POST提交至PHP网站的数据库操作, 实现多设备共享网络数据, 所以需要自行搭建网站程序才可使用, 具体搭建方法见教程帖子 >> [https://zimaoxy.com/b/t-2876-1-1.html](https://zimaoxy.com/b/t-2876-1-1.html)<br>
<br>
脚本开头必须先调用一次 <a href="https://zimaoxy.com/m/post/zm.netdatainit/" target="_blank">zm.netdatainit</a> <br>
V1.1816: 加入命令<br>
V3.1903: 大幅度提高执行效率<br>
V4.2113: <br>
  更新 `sql.php` 与 `medoo.php` 程序, 对旧版有影响, 请参考上面教程帖子操作<br>
  全新的环境搭建教程</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="NetDataGet" id="NetDataGet"> <a href="https://zimaoxy.com/m/post/zm.netdataget/" target="_blank">zm.NetDataGet 获取网络数据</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>从数据表中获取网络共享数据</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.NetDataGet(键名[, 数据表名][, 是否删除])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">键名: 字符串, 类似于变量名, 区分大小写<br>数据表名: 字符串, 可选, 从指定数据表中获取共享数据, 数据表必须存在, 省略默认为初始化时的数据表名<br>是否删除: 布尔型, 可选, 表示获取后是否直接删除该键名, 省略默认为false</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_或_数值型_或_布尔型_或_表_ , 返回键值内容, 该数据类型与写入时相同</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeNetDataGet');">复制代码</div>
                <pre id="codeNetDataGet">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//初始化创建表, 并且不清空以前数据
zm.NetDataInit "http://192.168.1.100/sql.php", "测试脚本", "QQ345911220"

zm.NetDataSet "等级", 99
zm.NetDataSet "昵称", "紫猫"
zm.NetDataSet "VIP", True

Dim 等级 = zm.NetDataGet("等级")
Dim 昵称 = zm.NetDataGet("昵称")
Dim VIP = zm.NetDataGet("VIP", True)

TracePrint zm.VarInfo(等级)
TracePrint zm.VarInfo(昵称)
TracePrint zm.VarInfo(VIP)

Dim 检查删除结果 = zm.NetDataGet("VIP")
TracePrint 检查删除结果</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本功能是使用POST提交至PHP网站的数据库操作, 实现多设备共享网络数据, 所以需要自行搭建网站程序才可使用, 具体搭建方法见教程帖子 >> [https://zimaoxy.com/b/t-2876-1-1.html](https://zimaoxy.com/b/t-2876-1-1.html)<br>
<br>
脚本开头必须先调用一次 <a href="https://zimaoxy.com/m/post/zm.netdatainit/" target="_blank">zm.netdatainit</a> <br>
V1.1816: 加入命令<br>
V1.1818: 支持table<br>
V2.1826: 解决写入成功, 读取失败的问题<br>
V3.1903: 大幅度提高执行效率<br>
V4.2113: <br>
  更新 `sql.php` 与 `medoo.php` 程序, 对旧版有影响, 请参考上面教程帖子操作<br>
  全新的环境搭建教程<br>
<br>
</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="NetDataGetRows" id="NetDataGetRows"> <a href="https://zimaoxy.com/m/post/zm.netdatagetrows/" target="_blank">zm.NetDataGetRows 获取多行网络数据</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>从数据表中获取指定行数的数据, 数据表名与是否删除参数顺序可以打乱</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.NetDataGetRows(行数[, 起始行][, 数据表名][, 是否删除])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">行数: 数值型, 从指定数据表中获取多少行数据<br>起始行: 数值型, 可选, 表示从第几行开始获取, 省略默认为1<br>数据表名: 字符串, 可选, 从指定数据表中获取共享数据, 数据表必须存在, 省略默认为初始化时的数据表名<br>是否删除: 布尔型, 可选, 表示获取后是否直接删除这些数据, 省略默认为false</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 返回二维表, 格式{ {"id":id,"key":key,"value":value}, ...}, 失败返回`null`</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeNetDataGetRows');">复制代码</div>
                <pre id="codeNetDataGetRows">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//初始化创建表, 并且清空以前数据
zm.NetDataInit "http://192.168.1.100/sql.php", "测试脚本", "QQ345911220", True

zm.NetDataSet "帐号1", "密码1"
zm.NetDataSet "帐号2", "密码2"
zm.NetDataSet "帐号3", "密码3"
zm.NetDataSet "帐号4", "密码4"
zm.NetDataSet "帐号5", "密码5"

//从第一行开始获取1行数据, 并且删除
Dim 帐号密码 = zm.NetDataGetRows(1, True)
TracePrint "帐号是: ", 帐号密码[1]["key"]
TracePrint "密码是: ", 帐号密码[1]["value"]

//从第2行开始获取3行数据
Dim 多个帐号密码 = zm.NetDataGetRows(3, 2)
For Each k , v In 多个帐号密码
	TracePrint "帐号是: ", v["key"]
	TracePrint "密码是: ", v["value"]
Next</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本功能是使用POST提交至PHP网站的数据库操作, 实现多设备共享网络数据, 所以需要自行搭建网站程序才可使用, 具体搭建方法见教程帖子 >> [https://zimaoxy.com/b/t-2876-1-1.html](https://zimaoxy.com/b/t-2876-1-1.html)<br>
<br>
脚本开头必须先调用一次 <a href="https://zimaoxy.com/m/post/zm.netdatainit/" target="_blank">zm.netdatainit</a> <br>
V1.1816: 加入命令<br>
V3.1903: 大幅度提高执行效率<br>
V4.2113: <br>
  更新 `sql.php` 与 `medoo.php` 程序, 对旧版有影响, 请参考上面教程帖子操作<br>
  全新的环境搭建教程</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="NetDataInit" id="NetDataInit"> <a href="https://zimaoxy.com/m/post/zm.netdatainit/" target="_blank">zm.NetDataInit 初始化网络数据</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>初始化共享网络数据, 创建指定数据表, 实现网络通信功能, 需要网站程序配合, 搭建方法详见后面的备注</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.NetDataInit([网址][, 数据表名[, 通信密钥]][, 是否清空][, 超时时间])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">网址: 字符串, 可选, 网站程序sql.php的网址<br>数据表名: 字符串, 可选, 用于存放变量数据的表<br>通信密钥: 字符串, 可选, 填写安装时的通信密钥<br>是否清空: 布尔型, 可选, 清空指定数据表下所有变量数据, 不会删除数据表, 省略默认为false, 表示不清空<br>超时时间: 数值型, 可选, 修改NetData系列所有命令内置超时时间</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeNetDataInit');">复制代码</div>
                <pre id="codeNetDataInit">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//例子1 初始化创建表, 并且不清空以前数据
zm.NetDataInit "http://192.168.1.100/sql.php", "测试脚本", "QQ345911220"

zm.NetDataSet "等级", 99
zm.NetDataSet "昵称", "紫猫"
zm.NetDataSet "VIP", True

Dim 等级 = zm.NetDataGet("等级")
Dim 昵称 = zm.NetDataGet("昵称")
Dim VIP = zm.NetDataGet("VIP", True)

TracePrint zm.VarInfo(等级)
TracePrint zm.VarInfo(昵称)
TracePrint zm.VarInfo(VIP)

Dim 检查删除结果 = zm.NetDataGet("VIP")
TracePrint 检查删除结果

//例子2 清空以前数据并初始化
zm.NetDataInit "http://192.168.1.100/sql.php", "测试脚本", "QQ345911220" True</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本功能是使用POST提交至PHP网站的数据库操作, 实现多设备共享网络数据, 所以需要自行搭建网站程序才可使用, 具体搭建方法见教程帖子 >> [https://zimaoxy.com/b/t-2876-1-1.html](https://zimaoxy.com/b/t-2876-1-1.html)<br>
<br>
V1.1816: 加入命令<br>
V3.1903: 大幅度提高执行效率<br>
V4.2113: <br>
  新增 `通信密钥` 参数, 加强网站安全性<br>
  更新 `sql.php` 与 `medoo.php` 程序, 对旧版有影响, 请参考上面教程帖子操作<br>
  全新的环境搭建教程</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="NetDataQuery" id="NetDataQuery"> <a href="https://zimaoxy.com/m/post/zm.netdataquery/" target="_blank">zm.NetDataQuery 执行SQL语句</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>执行SQL语句, 需要一定SQL语法知识</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.NetDataQuery(SQL)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">SQL: 字符串, 要执行的SQL语句</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 执行SQL后的返回结果。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeNetDataQuery');">复制代码</div>
                <pre id="codeNetDataQuery">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//初始化创建表, 并且不清空以前数据
zm.NetDataInit "http://192.168.1.100/sql.php", "测试脚本", "QQ345911220"

zm.NetDataSet "等级", 99
zm.NetDataSet "昵称", "紫猫"
zm.NetDataSet "VIP", True

Dim 结果 = zm.NetDataQuery("SELECT * FROM `测试脚本`")
TracePrint 结果</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本功能是使用POST提交至PHP网站的数据库操作, 实现多设备共享网络数据, 所以需要自行搭建网站程序才可使用, 具体搭建方法见教程帖子 >> [https://zimaoxy.com/b/t-2876-1-1.html](https://zimaoxy.com/b/t-2876-1-1.html)<br>
<br>
脚本开头必须先调用一次 <a href="https://zimaoxy.com/m/post/zm.netdatainit/" target="_blank">zm.netdatainit</a> <br>
V1.1816: 加入命令<br>
V3.1903: 大幅度提高执行效率<br>
V4.2113: <br>
  更新 `sql.php` 与 `medoo.php` 程序, 对旧版有影响, 请参考上面教程帖子操作<br>
  全新的环境搭建教程</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="NetDataSet" id="NetDataSet"> <a href="https://zimaoxy.com/m/post/zm.netdataset/" target="_blank">zm.NetDataSet 设置网络数据</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>往数据表中添加或修改共享网络数据</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.NetDataSet(键名, 键值[, 数据表名])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">键名: 字符串, 类似于变量名, 区分大小写<br>键值: 字符串_或_数值型_或_布尔型_或_表, 存放的数据, 类似于变量值<br>数据表名: 字符串, 可选, 往指定数据表中设置共享数据, 数据表必须存在, 省略默认为初始化时的数据表名</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeNetDataSet');">复制代码</div>
                <pre id="codeNetDataSet">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//初始化创建表, 并且不清空以前数据
zm.NetDataInit "http://192.168.1.100/sql.php", "测试脚本", "QQ345911220"

zm.NetDataSet "昵称", "紫猫"
zm.NetDataSet "等级", 99
zm.NetDataSet "VIP", True</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>本功能是使用POST提交至PHP网站的数据库操作, 实现多设备共享网络数据, 所以需要自行搭建网站程序才可使用, 具体搭建方法见教程帖子 >> [https://zimaoxy.com/b/t-2876-1-1.html](https://zimaoxy.com/b/t-2876-1-1.html)<br>
<br>
脚本开头必须先调用一次 <a href="https://zimaoxy.com/m/post/zm.netdatainit/" target="_blank">zm.netdatainit</a> <br>
V1.1816: 加入命令<br>
V1.1818: 支持table<br>
V3.1903: 大幅度提高执行效率<br>
V4.2113: <br>
  更新 `sql.php` 与 `medoo.php` 程序, 对旧版有影响, 请参考上面教程帖子操作<br>
  全新的环境搭建教程<br>
</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="TCPClose" id="TCPClose"> <a href="https://zimaoxy.com/m/post/zm.tcpclose/" target="_blank">zm.TCPClose 关闭TCP连接</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>关闭TCP连接。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.TCPClose()</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">无</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数值型_ ，返回1表示关闭成功, 返回2表示当前无连接, 返回null表示关闭失败。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeTCPClose');">复制代码</div>
                <pre id="codeTCPClose">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//连接192.168.1.100:12345的TCP服务端
Dim isConn = zm.TCPConnect("192.168.1.100", 12345)
If isConn Then 
    //发送数据到服务端
    TracePrint zm.TCPSend("QQ345911220", 15)
    //接收数据
    TracePrint zm.TCPReceive(60)
    //关闭TCP连接
    TracePrint zm.TCPClose()
Else 
    TracePrint "TCP连接失败"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1805: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="TCPConnect" id="TCPConnect"> <a href="https://zimaoxy.com/m/post/zm.tcpconnect/" target="_blank">zm.TCPConnect 连接TCP服务端</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>连接TCP服务端。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.TCPConnect(目标IP, 目标端口[, 超时时间])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">目标IP: 字符串, 要连接的TCP服务端IP地址<br>目标端口: 数值型, 要连接的TCP服务端端口<br>超时时间: 数值型, 可选, 单位秒, 默认为10秒</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数值型_ ，返回1表示连接成功, 返回null表示连接失败。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeTCPConnect');">复制代码</div>
                <pre id="codeTCPConnect">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//连接192.168.1.100:12345的TCP服务端
Dim isConn = zm.TCPConnect("192.168.1.100", 12345)
If isConn Then 
    //发送数据到服务端
    TracePrint zm.TCPSend("QQ345911220", 15)
    //接收数据
    TracePrint zm.TCPReceive(60)
    //关闭TCP连接
    TracePrint zm.TCPClose()
Else 
    TracePrint "TCP连接失败"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1805: 加入命令<br>
V3.1849: 修复使用TCP功能后无法启动多线程的问题（可能会导致超时参数失效）。</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="TCPReceive" id="TCPReceive"> <a href="https://zimaoxy.com/m/post/zm.tcpreceive/" target="_blank">zm.TCPReceive 接收TCP数据</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>接收TCP数据，此命令为阻塞命令！</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.TCPReceive([超时时间[, 接收模式]])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">超时时间: 数值型, 可选, 单位秒, 默认为10秒<br>接收模式: 字符串, 可选, 支持`*a`和`*l`两种模式, 省略默认为`*l`</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，成功返回字符串数据内容, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeTCPReceive');">复制代码</div>
                <pre id="codeTCPReceive">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//连接192.168.1.100:12345的TCP服务端
Dim isConn = zm.TCPConnect("192.168.1.100", 12345)
If isConn Then 
    //发送数据到服务端
    TracePrint zm.TCPSend("QQ345911220", 15)
    //接收数据
    TracePrint zm.TCPReceive(60)
    //关闭TCP连接
    TracePrint zm.TCPClose()
Else 
    TracePrint "TCP连接失败"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1805: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="TCPSend" id="TCPSend"> <a href="https://zimaoxy.com/m/post/zm.tcpsend/" target="_blank">zm.TCPSend 发送TCP数据</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>发送TCP数据</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.TCPSend(数据[, 超时时间[, 追加换行符]])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">数据: 字符串, 要发送的数据内容, 注意, 末尾会默认加上`\n`字符<br>超时时间: 数值型, 可选, 单位秒, 默认为10秒<br>追加换行符: 布尔型, 可选, 消息末尾是否追加换行符, 默认为true</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数值型_ ，成功返回大于0的数据长度, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeTCPSend');">复制代码</div>
                <pre id="codeTCPSend">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//连接192.168.1.100:12345的TCP服务端
Dim isConn = zm.TCPConnect("192.168.1.100", 12345)
If isConn Then 
    //发送数据到服务端
    TracePrint zm.TCPSend("QQ345911220", 15)
    //接收数据
    TracePrint zm.TCPReceive(60)
    //关闭TCP连接
    TracePrint zm.TCPClose()
Else 
    TracePrint "TCP连接失败"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1805: 加入命令<br>
V4.2015: 加入`追加换行符`可选参数</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="UDPBind" id="UDPBind"> <a href="https://zimaoxy.com/m/post/zm.udpbind/" target="_blank">zm.UDPBind 绑定UDP</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>绑定UDP</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.UDPBind(IP, 端口[, 超时时间])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">IP: 字符串, 要绑定的IP地址<br>端口: 数值型, 要绑定的端口<br>超时时间: 数值型, 可选, 单位秒, 默认为10秒</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数值型_ ，成功返回大于0的数值, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeUDPBind');">复制代码</div>
                <pre id="codeUDPBind">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//往192.168.1.100:12345发送数据
TracePrint zm.UDPSend("QQ345911220", "192.168.1.100", 12345)
//绑定192.168.1.101:12345
Dim isBind = zm.UDPBind("192.168.1.101", 12345, 15)
If isBind Then 
    //接收数据
    TracePrint zm.UDPReceive(60)
    //关闭UDP
    TracePrint zm.UDPClose()
Else 
    TracePrint "UDP绑定失败"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1805: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="UDPClose" id="UDPClose"> <a href="https://zimaoxy.com/m/post/zm.udpclose/" target="_blank">zm.UDPClose 关闭UDP</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>关闭UDP</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.UDPClose()</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">无</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数值型_ ，返回`1`表示关闭成功, 返回`2`表示没有找到绑定, 返回`null`表示失败</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeUDPClose');">复制代码</div>
                <pre id="codeUDPClose">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//往192.168.1.100:12345发送数据
TracePrint zm.UDPSend("QQ345911220", "192.168.1.100", 12345)
//绑定192.168.1.101:12345
Dim isBind = zm.UDPBind("192.168.1.101", 12345, 15)
If isBind Then 
    //接收数据
    TracePrint zm.UDPReceive(60)
    //关闭UDP
    TracePrint zm.UDPClose()
Else 
    TracePrint "UDP绑定失败"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1805: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="UDPReceive" id="UDPReceive"> <a href="https://zimaoxy.com/m/post/zm.udpreceive/" target="_blank">zm.UDPReceive 接收UDP数据</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>接收UDP数据, 注意, 此命令为阻塞命令</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.UDPReceive([超时时间])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">超时时间: 数值型, 可选, 单位秒, 默认为10秒</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ ，成功返回{数据内容, 来源IP, 来源端口}, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeUDPReceive');">复制代码</div>
                <pre id="codeUDPReceive">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//往192.168.1.100:12345发送数据
TracePrint zm.UDPSend("QQ345911220", "192.168.1.100", 12345)
//绑定192.168.1.101:12345
Dim isBind = zm.UDPBind("192.168.1.101", 12345, 15)
If isBind Then 
    //接收数据
    TracePrint zm.UDPReceive(60)
    //关闭UDP
    TracePrint zm.UDPClose()
Else 
    TracePrint "UDP绑定失败"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1805: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="UDPSend" id="UDPSend"> <a href="https://zimaoxy.com/m/post/zm.udpsend/" target="_blank">zm.UDPSend 发送UDP数据</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>发送UDP数据</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.UDPSend(数据, IP, 端口)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">数据: 字符串, 要发送的数据内容<br>IP: 字符串, 目标IP地址<br>端口: 数值型, 目标端口</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数值型_ ，成功返回大于0的数值, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeUDPSend');">复制代码</div>
                <pre id="codeUDPSend">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//往192.168.1.100:12345发送数据
TracePrint zm.UDPSend("QQ345911220", "192.168.1.100", 12345)
//绑定192.168.1.101:12345
Dim isBind = zm.UDPBind("192.168.1.101", 12345, 15)
If isBind Then 
    //接收数据
    TracePrint zm.UDPReceive(60)
    //关闭UDP
    TracePrint zm.UDPClose()
Else 
    TracePrint "UDP绑定失败"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1805: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="GetUIValue" id="GetUIValue"> <a href="https://zimaoxy.com/m/post/zm.getuivalue/" target="_blank">zm.GetUIValue 读取UI控件值</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>读取UI动态界面控件的值, 与 <a href="https://zimaoxy.com/m/post/ui.getvalue/" target="_blank">ui.getvalue</a> 相比, 本命令直接以(数值型/布尔型/字符串)形式返回结果</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.GetUIValue(控件名)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">控件名: 字符串, UI界面的控件名</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数值型/布尔型/字符串_ , 由控件决定对应的数据类型, 返回控件值</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeGetUIValue');">复制代码</div>
                <pre id="codeGetUIValue">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

'创建一个名称为"layout1"的布局控件
UI.NewLayout ("layout1")
'以下例子为分别创建文字框、输入框、按钮等控件并使用获取GetValue它们的值
UI.AddTextView("layout1", "文字框1", "姓名：") 
Dim 内容= zm.GetUIValue("文字框1")
TracePrint 内容
UI.AddEditText("layout1", "输入框1", "请在此输入内容") 
Dim 内容2= zm.GetUIValue("输入框1")
TracePrint 内容2
UI.AddButton("layout1", "按钮1", "这是个按钮") 
Dim 内容3= zm.GetUIValue("按钮1")
TracePrint 内容3
UI.AddRadioGroup("layout1","单选框1",{"1小瓶", "2中瓶", "3大瓶"},0)
Dim 内容4= zm.GetUIValue("单选框1")
TracePrint 内容4
UI.AddCheckBox("layout1", "多选框1","多选框选项1", false)
Dim 内容5= zm.GetUIValue("多选框1")
TracePrint 内容5
UI.NewRow("layout1", "new_row_1")
Dim SpinnerTable = {"湖南", "湖北", "广东", "广西"}
UI.AddSpinner("layout1", "下拉框1", SpinnerTable, 0)
Dim 内容6= zm.GetUIValue("下拉框1")
TracePrint 内容6
'显示名称为："layout1" 的布局控件
UI.Show ("layout1")</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1804: 加入命令<br>
V1.1805: 命令名改为`zm.GetUIValue()`</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="CmpColorEx" id="CmpColorEx"> <a href="https://zimaoxy.com/m/post/zm.cmpcolorex/" target="_blank">zm.CmpColorEx 超级多点比色</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>比  <a href="https://zimaoxy.com/m/post/cmpcolorex/" target="_blank">cmpcolorex</a>  更加强大的命令, 具体特色如下<br><br>- 支持多组多点比色数据, 并且返回找到的序号, 详见示例<br>- 参数太多, 写的累? 所有参数都是可选的, 使你的代码更加简洁清晰<br>- 参数太多, 顺序记不住? 除了对象参数只能填写第一个外, 其他参数大部分可以打乱顺序随便写<br>- 省略参数的默认值不理想? 可使用  <a href="https://zimaoxy.com/m/post/zm.setcmpcolorex/" target="_blank">zm.setcmpcolorex</a>  来自定义修改<br>- 担心一次对比不到颜色? 自由设置限时循环对比时间, 提高成功率<br>- 画面变化太大, 颜色相似度不好设置? 智能颜色相似度帮你全自动查找<br>- 对比点存在误差, 需要忽略一定数量的点? 数量相似度解决此问题<br>- 脚本出错找不到问题? 开启日志输出显示参数, 所有问题一目了然<br>- 找到后想等画面消失再继续下一步操作吗? 等待消失参数帮你解决这个烦恼<br>- 支持命令返回值与参数返回值, 你想怎么写, 就怎么写, 返回值中有序号, 坐标, 颜色<br>- 支持对象参数写法, 将所有参数保存到一张表里, 直接传入该表<br>- 支持重写, 即传入对象参数后, 再写其他参数将会覆盖对应的对象数据<br>- 需要防检测点击功能? 推荐使用 <a href="https://zimaoxy.com/m/post/zm.cmpcolorextap/" target="_blank">zm.cmpcolorextap</a> <br>- 需要遍历多个对象数组? 推荐使用 <a href="https://zimaoxy.com/m/post/zm.cmpcolorextable/" target="_blank">zm.cmpcolorextable</a> </td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.CmpColorEx([对象][颜色组, ...][, 颜色相似度[, 智能颜色相似度[, 颜色相似度步长]]][, 数量相似度][, 对比超时][, 是否点击][, 点击坐标][, 显示日志][, 输出行号][, 备注][, 等待消失][, 消失超时][, 参数返回值])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象: 表, 可选, 把所有参数放入一个table中传入, 若后面跟有其他参数, 则会对应覆盖对象数据<br>颜色组: 字符串, 可选, 需要对比的点xy坐标和16进制颜色, **支持填写多组不同的颜色组**, 格式与 <a href="https://zimaoxy.com/m/post/cmpcolorex/" target="_blank">cmpcolorex</a> 参数相同, 都是(X坐标&#124;Y坐标&#124;16进制颜色), 多个颜色用“&#124;”号分隔, 需要偏色用“`-`”号分隔, 多个点信息用“`,`”号分隔, 比如"100&#124;200&#124;FFFFFF&#124;123456-000000,300&#124;500&#124;FFFFFF"<br>颜色相似度: 数值型, 可选, 对比查找的颜色相似度小数, 省略默认为`0.9`, 取值范围`[0, 1.0]`, 越高越相似<br>智能颜色相似度: 数值型, 可选, 与颜色相似度组成组成智能相似计算范围, 适合图色变化大的情况, 省略默认取值与`颜色相似度`相同, 取值范围`[0, 1.0]`, 越高越相似<br>颜色相似度步长: 数值型, 可选, 智能颜色相似度调节变化间隔, 必须写在`颜色相似度`和`智能颜色相似度`后面, 省略默认为`0.05`, 取值范围`[0, 1.0]`<br>数量相似度: 字符串, 可选, 一组颜色组中符合条件的颜色数量比值, 注意是字符串数据类型, 省略默认为`"1.0"`, 取值范围`["0", "1.0"]`, 越高越相似<br>对比超时: 数值型, 可选, 限时对比时间, 单位毫秒, 如果一次找不到, 可以限时循环查找, 省略默认为`1`<br>是否点击: 布尔型, 可选, 是否需要对比成功后自动点击该组的第一个点坐标, 支持`[true, false]`这两个值, 省略默认为`false`<br>点击坐标: 字符串, 可选, 点击修改后的坐标, 格式`"±x,±y,t"`, 省略为对比成功组的第一点坐标, `t`是可选的, 表示点击后延时毫秒, 例如`"100,100"`表示固定点击坐标100,100, `"+10,-10"`表示偏移点击对比成功组的第一点坐标的x+10,y-10位置, `"10,10,2000"`表示点击10,10坐标后延时2000毫秒, 该参数会受 <a href="https://zimaoxy.com/m/post/zm.settap/" target="_blank">zm.settap</a> 影响<br>显示日志: 字符串, 可选, 输出调试日志信息, 省略默认为"隐藏", 支持 `["显示","显示找到", "显示没找到","隐藏","show", "showfind", "shownofind","hide"]` 这几个值<br>输出行号: 字符串, 可选, 格式为`"_"`开头后跟行号, 比如`"_10"`表示第10行代码, 输出调试信息窗口显示第几行代码, 需开启显示日志才有效<br>备注: 字符串, 可选, 格式为`"@"`开头后跟内容, 在调试日志信息中加入该内容, 比如`"@拾取屠龙刀"`, 若连续两个`"@@"`则表示在浮窗中显示信息, 需要开启显示日志才有效<br>等待消失: 数值型, 可选, 填写`-1`禁用或`-2`启用, `-2`表示找到后或点击后继续查找, 直到找不到或消失超时, 省略默认为`-1`, 启用后返回值将有`miss`键名, 值为`true`时表示成功消失, 值为`false`表示未消失<br>消失超时: 数值型, 可选, 填写`负数`, 表示等待消失的超时时间, 单位毫秒, 注意必须填写负数, 不可填-1和-2, 省略默认为`-2000`<br>参数返回值: 表, 可选, 只能传入数组变量名, 用于保存查找结果, 格式与命令返回值相同</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">table_ , 返回符合要求的第一个点坐标并保存到表中, 格式为`{id, x, y, name, "id":id, "x":x, "y":y, "name":name, "miss":miss}`, 对比失败或出错返回`null`</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeCmpColorEx');">复制代码</div>
                <pre id="codeCmpColorEx">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim ret
//--------------------例子1--------------------//
//表示对比两组多点比色数据, 分别是"205|177|0CBB00,228|169|FFFFFF"和"61|340|3DC3EE"
//支持无限添加多点比色数据, 按顺序比较, 只要有一组对比成功, 就返回结果
//不填写相似度情况下, 省略默认相似度为0.9
ret = zm.CmpColorEx("205|177|0CBB00,228|169|FFFFFF", "61|340|3DC3EE")
If ret Then
    TracePrint "对比颜色成功"
Else
    TracePrint "对比颜色失败"
End If

//--------------------例子2--------------------//
//如何对比动态变化的画面?
//原理:用抓抓截图后, 图片是静止不变的, 多次截图可以获取到不同的画面
//     说明所谓的动态图其实就是由一些静止不动的画面来回切换实现的
//     那么对每一次截图采集一些多点比色数据, 然后让脚本循环多次比较这些数据
//     只要任何一组数据对比成功, 都可以认为是找到这个动态图了
//     所以可以使用本命令的无限添加多点比色数据与设置超时时间来实现
//     想提高查找速度的话, 建议提高相似度, 增加多点比色数据
//下面代码实现在5000毫秒内不断循环比较两组多点比色数据, 任何一组对比成功了, 就立即返回该组数据的第一个坐标
//超过5000毫秒没对比成功, 就返回null
ret = zm.CmpColorEx("205|177|0CBB00,228|169|FFFFFF", "61|340|3DC3EE", 5000)
If ret Then
    TracePrint "对比颜色成功, 序号=" & ret(0), "x=" & ret(1), "y=" & ret(2), "name=" & ret(3)
Else
    TracePrint "对比颜色失败"
End If

//--------------------例子3--------------------//
Dim 返回数组()
//参数返回值必须是任意数组的变量名, 注意括号写法
//除对象参数外, 大部分参数都可以打乱顺序填写, 只要数据类型与格式正确即可
//下面代码实现以(0.8)的颜色相似度比较两组多点比色数据, 并把返回结果保存在数组变量(返回数组)中
If zm.CmpColorEx(0.8, "205|177|0CBB00,228|169|FFFFFF", 返回数组, "61|340|3DC3EE") Then
    TracePrint "对比颜色成功, 序号=" & 返回数组["id"], "x=" & 返回数组["x"], "y=" & 返回数组["y"], "name=" & 返回数组["name"]
Else
    TracePrint "对比颜色失败"
End If

//--------------------例子4--------------------//
//有时候颜色的相似度不好取值, 那么可以借助智能相似度实现判断
//下面这段代码中就表示从高相似度1.0到低相似度0.7, 以每次减少0.1的值进行循环对比
//只要对比成功了, 就立即返回结果, 需注意, 相似度步长必须写在两个颜色相似度后面
ret = zm.CmpColorEx("205|177|0CBB00,228|169|FFFFFF", "61|340|3DC3EE", 0.7, 1.0, 0.1)
If ret Then
    TracePrint "对比颜色成功, 序号=" & ret(0), "x=" & ret(1), "y=" & ret(2), "name=" & ret(3)
Else
    TracePrint "对比颜色失败"
End If

//--------------------例子5--------------------//
//请注意这个例子中的参数("0.7"), 这是指数量相似度, 必须是字符串数据类型
//数量相似度是指多点比色数据中符合条件点的比例, "0.7"即70%以上个点符合条件
//例如下面这组多点比色数据一共有4个点, 那么对比时, 只要有4*0.7=2.8个点以上符合条件, 就可以返回对比成功
ret = zm.CmpColorEx("5|7|0CBB00,2|1|FFFFFF,4|3|3DC3EE,1|3|354311", "0.7")
If ret Then
    TracePrint "对比颜色成功, 序号=" & ret(0), "x=" & ret(1), "y=" & ret(2), "name=" & ret(3)
Else
    TracePrint "对比颜色失败"
End If

//--------------------例子6--------------------//
//写代码过程中的调试输出信息是非常重要的, 但是每次都要专门写一次TracePrint也挺麻烦
//所以可以直接把输出信息写在参数里, 让它自动输出详细内容
//加入参数("显示")或("show")就表示要输出结果, 没有这个参数就不会输出内容
//加入参数("@内容")就表示输出的备注信息, 因为这个输出是不带行号的, 所以备注信息很有必要输出显示
//加入参数("_行数")表示在带上输出行号, 不过代码改动, 行号变化后, 这里也要重新修改, 比较麻烦, 不如备注来的方便
ret = zm.CmpColorEx("205|177|0CBB00,228|169|FFFFFF", "61|340|3DC3EE", "显示", "@怪物", "_72")
If ret Then
    TracePrint "对比颜色成功"
Else
    TracePrint "对比颜色失败"
End If

//--------------------例子7--------------------//
//对比成功后可能会需要点击操作, 那么加入参数(true)就可以实现点击返回的坐标
//但是由于对比和点击是由两个动作组成, 所以更加推荐使用zm.CmpColorExTap()命令来实现这个功能
//省略点击坐标参数情况下, 默认点击的坐标是对比成功的颜色组第一个点
//比如第一组颜色对比成功, 那么点击就是(205,177), 如果是第二组, 那么就是点击(61,340)
//如果加入点击坐标参数("100,-20,3000"), 那么点击坐标将发生改变, 以返回坐标(205,177)为例
//实际点击坐标是(100,177-20=157), 并且点击后延时3000毫秒
//更多关于点击坐标参数格式请查看参数信息里的内容
ret = zm.CmpColorEx("205|177|0CBB00,228|169|FFFFFF", "61|340|3DC3EE", True, "100,-20,3000")
If ret Then
    TracePrint "对比颜色成功"
Else
    TracePrint "对比颜色失败"
End If


//--------------------例子8--------------------//
//有时候需要判断对比成功后, 过一段时间画面消失, 也就是对比失败这个过程
//那么可以通过等待消失和消失超时参数来实现
//下面代码中, 参数(-2)表示开启等待消失功能, 参数(-5000)表示在5000毫秒内不断判断对比是否失败
//如果对比失败, 就表示画面消失了, 立即返回结果
//其中返回的坐标依旧是对比成功点的坐标, 而是否消失的结果保存在键名("miss")中
//要注意的是只有先对比成功后, 才会进入等待消失, 如果一开始就对比失败, 那就不会去等待消失了
ret = zm.CmpColorEx("205|177|0CBB00,228|169|FFFFFF", "61|340|3DC3EE", -2, -5000)
If ret Then
    TracePrint "对比颜色成功, 序号=" & ret(0), "x=" & ret(1), "y=" & ret(2), "name=" & ret(3)
    TracePrint "画面是否消失 = ", ret["miss"]
Else
    TracePrint "对比颜色失败"
End If

//--------------------例子9--------------------//
//可选参数都可以组合起来实现, 大部分参数可以乱序填写, 下面代码意思如下:
//以颜色相似度为(0.8), 数量相似度("0.7")的设置
//比较两组多点比色数据, 分别是"205|177|0CBB00,228|169|FFFFFF"和"61|340|3DC3EE"
//限时在2000毫秒内循环比较, 找到任何一个后退出循环查找
//并将对比成功颜色组的序号和第一个点坐标保存在数组变量(ret)与(返回数组)中
//比如"205|177|0CBB00,228|169|FFFFFF"对比成功则返回序号0, 坐标(205,177)
//而如果是"61|340|3DC3EE"对比成功, 则返回序号1, 坐标(61,340)
//同时开启日志的输出("显示")功能, 输出备注("@紫猫Boss"), 对比结果与其他参数信息
ret = zm.CmpColorEx("205|177|0CBB00,228|169|FFFFFF", "61|340|3DC3EE", 0.8, "0.7", 2000, "显示", "@紫猫Boss", 返回数组)
If ret Then
    TracePrint "对比颜色成功"
Else
    TracePrint "对比颜色失败"
End If

//--------------------例子10--------------------//
//脚本变量的管理是一个难题, 每组图色数据都是独立的, 为了方便代码结构的管理
//可以把所有参数放到一个表中, 表中的数据一样可以打乱顺序任意填写或省略
//这个表就是对象参数, 它必须填写在第一个参数位置
//如果参数对象后面还有参数, 比如("_133"), 则表示重写对象里的("_36"), 使日志输出显示在46行
//注意, 多点比色数据不会被覆盖重写, 只会被追加, 相当于所有的多点比色数据都会被用来查找
//如果你有多组不同的对象参数需要遍历, 那么推荐使用zm.CmpColorExTable()
Dim 史莱姆 = {"205|177|0CBB00,228|169|FFFFFF", "61|340|3DC3EE", 0.8, 2000, "显示", "@怪物1", 返回数组, "_39"}
zm.CmpColorEx 史莱姆, "_134", "11|140|1542EE"

//--------------------例子11--------------------//
Dim IXYs()
//设置默认参数返回值IXYs, 若命令不填写参数返回值, 则默认保存在该变量中
//设置默认日志输出为显示状态, 后面所有超级多点比色相关命令都默认输出调试信息
//更多修改默认设置详见 zm.SetCmpColorEx() 命令帮助
zm.SetCmpColorEx {"ret":IXYs, "showlog":"显示"}
If zm.CmpColorEx("205|177|0CBB00,228|169|FFFFFF") Then
    TracePrint "可以用以下3种格式获取返回值"
    TracePrint "对比颜色成功, 序号" & IXYs(0), "x=" & IXYs(1), "y=" & IXYs(2)
    TracePrint "对比颜色成功, 序号" & IXYs[1], "x=" & IXYs[2], "y=" & IXYs[3]
    TracePrint "对比颜色成功, 序号" & IXYs["id"], "x=" & IXYs["x"], "y=" & IXYs["y"]
Else
    TracePrint "对比颜色失败"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>该命令用法灵活多变, 更多用法请大家自行摸索, 灵活使用输出日志可以事半功倍<br>
多点比色颜色组数据请通过抓抓进行获取<br>
偏色是微调，指对RBG三色分别确定取色范围。颜色相似度是粗调，指对颜色整体做百分比判断。<br>
数量相似度是指颜色组对比成功点的比例, 例如 `"1|1|3DC3EE,2|2|346AFF,3|3|1592FF,4|4|1592FF,5|5|231209,6|6|241306,7|7|201004,8|8|241306,9|9|241306"` 这组多点比色数据有9个点, 如果数量相似度填写`"0.8"`就意味着对比成功条件是`0.8*9=7.2`个点以上符合要求, 而点的个数肯定是整数, 所以就是必须要8个点或9个点才能算对比成功<br>
V3.1830: 加入命令<br>
V4.2042: 日志参数 `showlog` 加入 `["显示找到","显示没找到","showfind","shownofind"]` 选项</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="CmpColorExTable" id="CmpColorExTable"> <a href="https://zimaoxy.com/m/post/zm.cmpcolorextable/" target="_blank">zm.CmpColorExTable 超级多点比色遍历</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>与 <a href="https://zimaoxy.com/m/post/zm.cmpcolorex/" target="_blank">zm.cmpcolorex</a> 类似, 参数只有一个对象数组, 可实现多个对象的遍历对比</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.CmpColorExTable(对象table)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象table: table, 把 <a href="https://zimaoxy.com/m/post/zm.cmpcolorex/" target="_blank">zm.cmpcolorex</a> 的对象参数放入table数组中, 实现多个对象的遍历对比</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">table_ , 找到返回结果保存到表中, 格式为`{"success":找到数量, "fail":没找到数量, "键名":{id, x, y, name, "id":id, "x":x, "y":y, "name":name}, ...}`, 全部没找到或失败返回`null`</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeCmpColorExTable');">复制代码</div>
                <pre id="codeCmpColorExTable">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//将多个对象放入打怪table中, 每个对象都有各自的键名与各自的参数键值
Dim 打怪(), Boss坐标()
打怪["史莱姆"] = {"61|340|3DC3EE,91|344|346AFF,472|154|1592FF", true}
打怪["黑龙"] = {"421|237|241306,438|261|241306", 0.8, true}
打怪["紫猫BOSS"] = {"295|290|241306", Boss坐标} //这个不点击

//遍历打怪table, 返回每个对象成员的结果
Dim t = zm.CmpColorExTable(打怪)
If t Then
    TracePrint zm.VarInfo(t)
    TracePrint "找到了", t["success"], "个对象"
    TracePrint "没找到", t["fail"], "个对象"
    //在确认有找到的情况下, 可以单独判断某个对象是否有找到, 包括获取该对象的坐标结果等
    If t["史莱姆"] Then
        TracePrint "找到史莱姆, 坐标为", t["史莱姆"]["x"], t["史莱姆"]["y"]
    End If
Else
    TracePrint "所有对象都没有找到"
End If

//对象参数中的返回数组参数依旧可以拿出来单独判断使用
If Boss坐标(0) > -1 Then
    TracePrint "找到紫猫BOSS"
Else
    TracePrint "没有找到紫猫BOSS"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>该命令与 <a href="https://zimaoxy.com/m/post/zm.cmpcolorex/" target="_blank">zm.cmpcolorex</a> 类似, 唯一区别在于参数只有一个对象table<br>
V3.1830: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="CmpColorExTap" id="CmpColorExTap"> <a href="https://zimaoxy.com/m/post/zm.cmpcolorextap/" target="_blank">zm.CmpColorExTap 超级多点比色点击</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>与 <a href="https://zimaoxy.com/m/post/zm.cmpcolorex/" target="_blank">zm.cmpcolorex</a> 类似, 区别在于本命令内置对比成功后点击, 无需`是否点击`参数, 由于对比与点击是两个动作组成, 为方便代码阅读理解, 故新增本命令</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.CmpColorExTap([对象][颜色组, ...][, 颜色相似度[, 智能颜色相似度[, 颜色相似度步长]]][, 数量相似度][, 对比超时][, 点击坐标][, 显示日志][, 输出行号][, 备注][, 等待消失][, 消失超时][, 参数返回值])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象: 表, 可选, 把所有参数放入一个table中传入, 若后面跟有其他参数, 则会对应覆盖对象数据<br>颜色组: 字符串, 可选, 需要对比的点xy坐标和16进制颜色, 格式为(X坐标&#124;Y坐标&#124;16进制颜色), 多个颜色用“&#124;”号分隔, 需要偏色用“`-`”号分隔, 多个点信息用“`,`”号分隔, 比如"100&#124;200&#124;FFFFFF&#124;123456-000000,300&#124;500&#124;FFFFFF", 支持填写多组不同的颜色组<br>颜色相似度: 数值型, 可选, 对比查找的颜色相似度小数, 省略默认为`0.9`, 取值范围`[0, 1.0]`, 越高越相似<br>智能颜色相似度: 数值型, 可选, 与颜色相似度组成组成智能相似计算范围, 适合图色变化大的情况, 省略默认取值与`颜色相似度`相同, 取值范围`[0, 1.0]`, 越高越相似<br>颜色相似度步长: 数值型, 可选, 智能颜色相似度调节变化间隔, 必须写在`颜色相似度`和`智能颜色相似度`后面, 省略默认为`0.05`, 取值范围`[0, 1.0]`<br>数量相似度: 字符串, 可选, 一组颜色组中符合条件的颜色数量比值, 注意是字符串数据类型, 省略默认为`"1.0"`, 取值范围`["0", "1.0"]`, 越高越相似<br>对比超时: 数值型, 可选, 限时对比时间, 单位毫秒, 如果一次找不到, 可以限时循环查找, 省略默认为`1`<br>点击坐标: 字符串, 可选, 点击修改后的坐标, 格式`"±x,±y,t"`, 省略为对比成功组的第一点坐标, `t`是可选的, 表示点击后延时毫秒, 例如`"100,100"`表示固定点击坐标100,100, `"+10,-10"`表示偏移点击对比成功组的第一点坐标的x+10,y-10位置, `"10,10,2000"`表示点击10,10坐标后延时2000毫秒, 该参数会受 <a href="https://zimaoxy.com/m/post/zm.settap/" target="_blank">zm.settap</a> 影响<br>显示日志: 字符串, 可选, 输出调试日志信息, 省略默认为"隐藏", 支持 `["显示","显示找到", "显示没找到","隐藏","show", "showfind", "shownofind","hide"]` 这几个值<br>输出行号: 字符串, 可选, 格式为`"_"`开头后跟行号, 比如`"_10"`表示第10行代码, 输出调试信息窗口显示第几行代码, 需开启显示日志才有效<br>备注: 字符串, 可选, 格式为`"@"`开头后跟内容, 在调试日志信息中加入该内容, 比如`"@拾取屠龙刀"`, 若连续两个`"@@"`则表示在浮窗中显示信息, 需要开启显示日志才有效<br>等待消失: 数值型, 可选, 填写`-1`禁用或`-2`启用, `-2`表示找到后或点击后继续查找, 直到找不到或消失超时, 省略默认为`-1`, 启用后返回值将有`miss`键名, 值为`true`时表示成功消失, 值为`false`表示未消失<br>消失超时: 数值型, 可选, 填写`负数`, 表示等待消失的超时时间, 单位毫秒, 注意必须填写负数, 不可填-1和-2, 省略默认为`-2000`<br>参数返回值: 表, 可选, 只能传入数组变量名, 用于保存查找结果, 格式与命令返回值相同</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">table_ , 返回符合要求的第一个点坐标并保存到表中, 格式为{id, x, y, name, "id":id, "x":x, "y":y, "name":name, "miss":miss}, 对比失败或出错返回`null`</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeCmpColorExTap');">复制代码</div>
                <pre id="codeCmpColorExTap">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim ret
//省略点击坐标参数情况下, 默认点击的坐标是对比成功的颜色组第一个点
//比如"205|177|0CBB00,228|169|FFFFFF"对比成功, 那么点击的坐标就是(205,117)
ret = zm.CmpColorExTap("205|177|0CBB00,228|169|FFFFFF", "61|340|3DC3EE")
If ret Then
    TracePrint "对比颜色成功, 执行点击操作"
Else
    TracePrint "对比颜色失败"
End If

//如果加入点击坐标参数("100,-20,3000"), 那么点击坐标将发生改变, 以返回坐标(205,177)为例
//实际点击坐标是(100,177-20=157), 并且点击后延时3000毫秒
//更多关于点击坐标参数格式请查看参数信息里的内容
ret = zm.CmpColorExTap("205|177|0CBB00,228|169|FFFFFF", "61|340|3DC3EE", "100,-20,3000")
If ret Then
    TracePrint "对比颜色成功"
Else
    TracePrint "对比颜色失败"
End If

//其他更多例子见zm.CmpColorEx*()命令, 本命令除了强制点击外, 无其他区别</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>内置找到后点击坐标, 无法取消, 建议需要点击操作的超级图色使用本命令, 方便代码阅读理解<br>
该命令用法灵活多变, 更多用法请大家自行摸索, 灵活使用输出日志可以事半功倍<br>
多点比色颜色组数据请通过抓抓进行获取<br>
偏色是微调，指对RBG三色分别确定取色范围。颜色相似度是粗调，指对颜色整体做百分比判断。<br>
数量相似度是指颜色组对比成功点的比例, 例如 `"1|1|3DC3EE,2|2|346AFF,3|3|1592FF,4|4|1592FF,5|5|231209,6|6|241306,7|7|201004,8|8|241306,9|9|241306"` 这组多点比色数据有9个点, 如果数量相似度填写`"0.8"`就意味着对比成功条件是`0.8*9=7.2`个点以上符合要求, 而点的个数肯定是整数, 所以就是必须要8个点或9个点才能算对比成功<br>
V3.1830: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FindCmpPC" id="FindCmpPC"> <a href="https://zimaoxy.com/m/post/zm.findcmppc/" target="_blank">zm.FindCmpPC 超级查找对比图色</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>集成  <a href="https://zimaoxy.com/m/post/zm.findmulticolor/" target="_blank">zm.findmulticolor</a>  ,  <a href="https://zimaoxy.com/m/post/findpic/" target="_blank">findpic</a>  ,  <a href="https://zimaoxy.com/m/post/cmpcolorex/" target="_blank">cmpcolorex</a>  和  <a href="https://zimaoxy.com/m/post/findcolor/" target="_blank">findcolor</a>  四大命令功能, 根据传入的图色数据参数格式智能分配命令使用. 一些特色功能或注意事项如下:<br><br>- 注意: `图色数据` 参数中请不要填写找图偏色参数<br>- 注意: `方向` 参数是字符串内容, 不是按键自带的数值型<br>- 注意: 依次按 `多点找色, 找图, 多点比色, 找色` 的顺序进行查找比较, 一旦查找比较成功, 立即返回结果<br>- 注意: `图色数据` 参数支持多个参数, 若出现不同类型的图色数据, 请使用一维数组 `{}` 分类传入, 内部会自动合并到同一个分类下<br>- 注意: `查找超时` 参数遇到多个不同类型的图色数据时, 每种数据都将独立计算一次超时时间<br>- 注意: 默认参数是通过  <a href="https://zimaoxy.com/m/post/zm.setfindmulticolor/" target="_blank">zm.setfindmulticolor</a>  ,  <a href="https://zimaoxy.com/m/post/zm.setfindpic/" target="_blank">zm.setfindpic</a>  ,  <a href="https://zimaoxy.com/m/post/zm.setcmpcolorex/" target="_blank">zm.setcmpcolorex</a>  ,  <a href="https://zimaoxy.com/m/post/zm.setfindcolor/" target="_blank">zm.setfindcolor</a>  分别修改的<br>- 注意: 返回值table中的 `fun` 键值对里存放对应找到函数名, `id` 键值对存放该函数下的第几个数据<br>- 注意: 填写 `对象` 参数后, 最好别再写别的参数<br>- 参数太多, 写的累? 除了对象与图色数据二选一必选外, 其他参数都是可选的, 使你的代码更加简洁清晰<br>- 参数太多, 顺序记不住? 除了对象与范围是固定顺序外, 其他参数全部可以打乱顺序随便写<br>- 省略参数的默认值不理想? 可以自定义修改<br>- 担心一次找不到图色数据? 自由设置限时循环查找时间, 提高成功率<br>- 画面变化太大, 相似度不好设置? 智能相似度帮你全自动查找<br>- 查找方向的数值总是记不住? 直接用中文 `"左上","中心","右上","左下","右下",...` 来代替<br>- 脚本出错找不到问题? 开启日志输出显示参数, 所有问题一目了然<br>- 找到后想等画面消失再继续下一步操作吗? 等待消失参数帮你解决这个烦恼<br>- 支持命令返回值与参数返回值, 你想怎么写, 就怎么写<br>- 返回值中有序号, 坐标等内容<br>- 支持对象参数写法, 将所有参数保存到一张表里, 直接传入该表<br>- 需要防检测点击功能? 推荐使用 <a href="https://zimaoxy.com/m/post/zm.findcmppctap/" target="_blank">zm.findcmppctap</a> <br>- 需要遍历多个对象数组? 推荐使用 <a href="https://zimaoxy.com/m/post/zm.findcmppctable/" target="_blank">zm.findcmppctable</a> </td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FindCmpPC([对象][x1, y1, x2, y2, ][图色数据][, 方向][, 相似度[, 智能相似度[, 相似度步长]]][, 查找超时][, 是否点击][, 点击坐标][, 显示日志][, 输出行号][, 备注][, 等待消失][, 消失超时][, 参数返回值])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象: 表, 可选, 把所有参数放入一个table中传入, 若填写本参数后, 建议不要再跟其他参数<br>x1: 数值型, 可选, 查找范围的左上角x坐标, 省略默认为0<br>y1: 数值型, 可选, 查找范围的左上角y坐标, 省略默认为0<br>x2: 数值型, 可选, 查找范围的右下角x坐标, 省略默认为0<br>y2: 数值型, 可选, 查找范围的右下角y坐标, 省略默认为0<br>图色数据: 字符串_ 或 _表, 可选, 可填写找图的图片路径, 找色的颜色值, 多点找色或多点比色的颜色数据, 若填写多个不同类型数据, 请用 `{}` 一维数组分开传入, 详见下面例子<br>方向: 字符串, 可选, 从指定方向开始查找, 省略默认为`"左上"`, 支持`["左上","中心","右上","左下","右下","上左","上右","下左","下右"]`这几个值<br>相似度: 数值型, 可选, 对比查找的相似度小数, 省略默认为`0.9`, 取值范围`[0, 1.0]`, 越高越相似<br>智能相似度: 数值型, 可选, 与相似度组成组成智能相似计算范围, 适合图色变化大的情况, 省略默认取值与`相似度`相同, 取值范围`[0, 1.0]`, 越高越相似<br>相似度步长: 数值型, 可选, 智能相似度调节变化间隔, 必须写在`相似度`后面, 省略默认为`0.05`, 取值范围`[0, 1.0]`<br>超时时间: 数值型, 可选, 最大查找耗时, 单位毫秒, 如果一次找不到, 可以限时循环查找, 省略默认为`1`<br>是否点击: 布尔型, 可选, 是否需要找到后自动点击该坐标, 支持`[true, false]`这两个值, 省略默认为`false`<br>点击坐标: 字符串, 可选, 点击修改后的坐标, 格式`"±x,±y,t"`, 省略为找到的坐标, `t`是可选的, 表示点击后延时毫秒, 例如`"100,100"`表示固定点击坐标100,100, `"+10,-10"`表示偏移点击找到的x+10,y-10位置, `"10,10,2000"`表示点击10,10坐标后延时2000毫秒, 该参数会受 <a href="https://zimaoxy.com/m/post/zm.settap/" target="_blank">zm.settap</a> 影响<br>显示日志: 字符串, 可选, 输出调试日志信息, 省略默认为"隐藏", 支持 `["显示","显示找到", "显示没找到","隐藏","show", "showfind", "shownofind","hide"]` 这几个值<br>输出行号: 字符串, 可选, 格式为`"_"`开头后跟行号, 比如`"_10"`表示第10行代码, 输出调试信息窗口显示第几行代码, 需开启显示日志才有效<br>备注: 字符串, 可选, 格式为`"@"`开头后跟内容, 比如`"@拾取屠龙刀"`, 输出调试信息窗口就会增加这条内容, 若连续两个`"@@"`则表示在浮窗中显示信息, 需要开启显示日志才有效<br>等待消失: 数值型, 可选, 填写`-1`禁用或`-2`启用, `-2`表示找到后或点击后继续查找, 直到找不到或消失超时, 省略默认为`-1`, 启用后返回值将有`miss`键名, 值为`true`时表示成功消失, 值为`false`表示未消失<br>消失超时: 数值型, 可选, 填写`负数`, 表示等待消失的超时时间, 单位毫秒, 注意必须填写负数, 不可填-1和-2, 省略默认为`-2000`<br>参数返回值: 表, 可选, 只能传入数组变量名, 用于保存查找结果, 格式与命令返回值相同</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 找到返回结果保存到表中, 格式为`{id, x, y, name, "id":id, "x":x, "y":y, "name":name, "miss":miss, "fun":fun}`, 没找到或出错返回null, 使用方法请看示例</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFindCmpPC');">复制代码</div>
                <pre id="codeFindCmpPC">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//--------------------初级用法--------------------//
//支持传入多点找色, 找图, 多点比色, 找色四大命令的图色数据
Dim 结果_绿龙 = zm.FindCmpPC(100, 200, 300, 400, "1FC5F4|0DD200|FFFFFF|504135|D97700")
If 结果_绿龙 Then 
	TracePrint "找到坐标为:", 结果_绿龙["x"], 结果_绿龙["y"]
Else 
	TracePrint "没有找到绿龙"
End If

//多点找色数据可以放到一维数组中传入, 也可以直接分两个参数传入
Dim 多点找色_白龙 = {"242424", "-10|2|ABC54A,9|4|12DC67"}
Dim 结果_白龙 = zm.FindCmpPC(100, 200, 300, 400, 多点找色_白龙)
//上面等同于 Dim 结果_白龙 = zm.FindCmpPC(100, 200, 300, 400, 多点找色_白龙[1], 多点找色_白龙[2])
If 结果_白龙 Then 
	TracePrint "找到坐标为:", 结果_白龙["x"], 结果_白龙["y"]
Else 
	TracePrint "没有找到白龙"
End If

//--------------------中级用法--------------------//
//可以在参数中传入数组代表返回值
Dim 结果_黑龙()
If zm.FindCmpPC("黑龙1.png|黑龙2.png", 结果_黑龙) Then
	TracePrint "找到坐标为:", 结果_黑龙["x"], 结果_黑龙["y"]
Else 
	TracePrint "没有找到黑龙"
End If

//可以把多个参数直接封装进一维数组中作为对象参数传入
Dim 多点比色_红龙 = {"205|177|0CBB00,228|169|FFFFFF", 0.8}
Dim 结果_红龙 = zm.FindCmpPC(多点比色_红龙)
If 结果_红龙 Then 
	TracePrint "找到坐标为:", 结果_红龙["x"], 结果_红龙["y"]
Else 
	TracePrint "没有找到红龙"
End If


//--------------------高级用法--------------------//
//多个不同类型的图色数据建议用一维数组分开传入
Dim 图片_黄龙 = {"黄龙1.png", "黄龙2.png"}
Dim 颜色_黄龙 = {"1FC5F4|0DD200|FFFFFF", "504135|D97700"}
Dim 多点找色_黄龙 = {{"242424", "-10|2|ABC54A,9|4|12DC67"}, {"1FC5F4","137|-7|0DD200,151|173|FFFFFF"}}
Dim 多点比色_黄龙 = {"205|177|0CBB00,228|169|FFFFFF", "195|242|1FC5F4,332|235|0DD200"}
Dim 结果_黄龙()
Dim 图色_黄龙 = {100, 200, 300, 400, 图片_黄龙, 颜色_黄龙, 多点找色_黄龙, 多点比色_黄龙, 5000, 结果_黄龙}
//依次按多点找色, 找图, 多点比色, 找色顺序查找, 每个类型限时5000毫秒, 找到任何一个立即返回到结果_黄龙数组中
If zm.FindCmpPC(图色_黄龙) Then 
	TracePrint "找到坐标为:", 结果_黄龙["x"], 结果_黄龙["y"], ", 序号为:", 结果_黄龙["id"], ", 命令为:", 结果_黄龙["fun"]
Else 
	TracePrint "没有找到黄龙"
End If

//--------------------修改默认值--------------------//
//本函数没有自己的默认值, 而是由四大图色命令的分别对应各自默认值
//使用zm.SetFindMultiColor()修改本命令使用多点找色数据时候的默认值
//使用zm.SetFindColor()修改本命令使用找色数据时候的默认值
//使用zm.SetFindPic()修改本命令使用找图数据时候的默认值
//使用zm.SetCmpColorEx()修改本命令使用多点比色数据时候的默认值
//这里修改多点找色默认值为例, 更多修改默认设置详见各个命令帮助

//设置多点找色的默认日志输出为显示找到状态, 返回值为xy数组
Dim xy()
zm.SetFindMultiColor {"ret":xy, "showlog":"显示找到"}
If zm.FindCmpPC("00AAFF", "42|42|565656") Then
    TracePrint "可以用以下3种格式获取返回值"
    TracePrint "找到序号" & xy["id"], "x=" & xy["x"], "y=" & xy["y"], "颜色=" & xy["name"]
Else
    TracePrint "没有找到"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>该命令用法灵活多变, 更多用法请大家自行摸索, 灵活使用输出日志可以事半功倍<br>
虽然本命令集成了四大图色命令, 但我依旧推荐单独使用对应图色命令, 因为各自对应命令更加便于阅读代码<br>
V4.2042: 初次加入</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FindCmpPCTable" id="FindCmpPCTable"> <a href="https://zimaoxy.com/m/post/zm.findcmppctable/" target="_blank">zm.FindCmpPCTable 遍历超级查找对比图色</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>与 <a href="https://zimaoxy.com/m/post/zm.findcmppc/" target="_blank">zm.findcmppc</a> 类似, 参数只有一个对象数组, 可实现遍历参数的键值对象进行查找</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FindCmpPCTable(对象)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象: 表, 可选, 把 <a href="https://zimaoxy.com/m/post/zm.findcmppc/" target="_blank">zm.findcmppc</a> 的对象参数放入table数组中, 实现遍历多点找色</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 找到返回结果保存到表中, 格式为`{"success":找到数量, "fail":没找到数量, "键名":{id, x, y, name, "id":id, "x":x, "y":y, "name":name, "miss":miss}, ...}`, 全部没找到或失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFindCmpPCTable');">复制代码</div>
                <pre id="codeFindCmpPCTable">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim 打怪(), Boss坐标()
打怪["史莱姆"] = {"00AAFF", "44|12|F01BA0-101010", true}
打怪["黑龙"] = {100,200,300,400, "1155BB", "11|-2|F01123", true}
打怪["紫猫BOSS"] = {"FFFFFF", "-55|102|000000", Boss坐标} //这个不点击, 并返回值保存在Boss坐标中

//遍历打怪数组, 返回每个对象成员的结果
Dim t = zm.FindCmpPC(打怪)
If t Then
    TracePrint "找到了", t["success"], "个对象"
    TracePrint "没找到", t["fail"], "个对象"
    If t["史莱姆"] Then
        TracePrint "找到史莱姆, 坐标为", t["史莱姆"]["x"], t["史莱姆"]["y"]
    End If
Else
    TracePrint "所有对象都没有找到"
End If

If Boss坐标(0) > -1 Then
    TracePrint "紫猫BOSS对象里的返回参数依旧有效"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>该命令用法灵活多变, 更多用法请大家自行摸索, 灵活使用输出日志可以事半功倍<br>
虽然本命令集成了四大图色命令, 但我依旧推荐单独使用对应图色命令, 因为各自对应命令更加便于阅读代码<br>
V4.2042: 初次加入</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FindCmpPCTap" id="FindCmpPCTap"> <a href="https://zimaoxy.com/m/post/zm.findcmppctap/" target="_blank">zm.FindCmpPCTap 超级查找对比图色点击</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>与 <a href="https://zimaoxy.com/m/post/zm.findcmppc/" target="_blank">zm.findcmppc</a> 类似, 区别在于本命令内置找到后点击. 由于查找与点击是两个动作组成, 为方便代码阅读理解, 故新增本命令</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FindCmpPCTap([对象][x1, y1, x2, y2, ][图色数据][, 方向][, 相似度[, 智能相似度[, 相似度步长]]][, 查找超时][, 点击坐标][, 显示日志][, 输出行号][, 备注][, 等待消失][, 消失超时][, 参数返回值])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象: 表, 可选, 把所有参数放入一个table中传入, 若填写本参数后, 建议不要再跟其他参数<br>x1: 数值型, 可选, 查找范围的左上角x坐标, 省略默认为0<br>y1: 数值型, 可选, 查找范围的左上角y坐标, 省略默认为0<br>x2: 数值型, 可选, 查找范围的右下角x坐标, 省略默认为0<br>y2: 数值型, 可选, 查找范围的右下角y坐标, 省略默认为0<br>图色数据: 字符串_ 或 _表, 可选, 可填写找图的图片路径, 找色的颜色值, 多点找色或多点比色的颜色数据, 若填写多个不同类型数据, 请用 `{}` 一维数组分开传入, 详见下面例子<br>方向: 字符串, 可选, 从指定方向开始查找, 省略默认为`"左上"`, 支持`["左上","中心","右上","左下","右下","上左","上右","下左","下右"]`这几个值<br>相似度: 数值型, 可选, 对比查找的相似度小数, 省略默认为`0.9`, 取值范围`[0, 1.0]`, 越高越相似<br>智能相似度: 数值型, 可选, 与相似度组成组成智能相似计算范围, 适合图色变化大的情况, 省略默认取值与`相似度`相同, 取值范围`[0, 1.0]`, 越高越相似<br>相似度步长: 数值型, 可选, 智能相似度调节变化间隔, 必须写在`相似度`后面, 省略默认为`0.05`, 取值范围`[0, 1.0]`<br>超时时间: 数值型, 可选, 最大查找耗时, 单位毫秒, 如果一次找不到, 可以限时循环查找, 省略默认为`1`<br>点击坐标: 字符串, 可选, 点击修改后的坐标, 格式`"±x,±y,t"`, 省略为找到的坐标, `t`是可选的, 表示点击后延时毫秒, 例如`"100,100"`表示固定点击坐标100,100, `"+10,-10"`表示偏移点击找到的x+10,y-10位置, `"10,10,2000"`表示点击10,10坐标后延时2000毫秒, 该参数会受 <a href="https://zimaoxy.com/m/post/zm.settap/" target="_blank">zm.settap</a> 影响<br>显示日志: 字符串, 可选, 输出调试日志信息, 省略默认为"隐藏", 支持 `["显示","显示找到", "显示没找到","隐藏","show", "showfind", "shownofind","hide"]` 这几个值<br>输出行号: 字符串, 可选, 格式为`"_"`开头后跟行号, 比如`"_10"`表示第10行代码, 输出调试信息窗口显示第几行代码, 需开启显示日志才有效<br>备注: 字符串, 可选, 格式为`"@"`开头后跟内容, 比如`"@拾取屠龙刀"`, 输出调试信息窗口就会增加这条内容, 若连续两个`"@@"`则表示在浮窗中显示信息, 需要开启显示日志才有效<br>等待消失: 数值型, 可选, 填写`-1`禁用或`-2`启用, `-2`表示找到后或点击后继续查找, 直到找不到或消失超时, 省略默认为`-1`, 启用后返回值将有`miss`键名, 值为`true`时表示成功消失, 值为`false`表示未消失<br>消失超时: 数值型, 可选, 填写`负数`, 表示等待消失的超时时间, 单位毫秒, 注意必须填写负数, 不可填-1和-2, 省略默认为`-2000`<br>参数返回值: 表, 可选, 只能传入数组变量名, 用于保存查找结果, 格式与命令返回值相同</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 找到返回结果保存到表中, 格式为`{id, x, y, name, "id":id, "x":x, "y":y, "name":name, "miss":miss, "fun":fun}`, 没找到或出错返回null, 使用方法请看示例</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFindCmpPCTap');">复制代码</div>
                <pre id="codeFindCmpPCTap">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//本命令内置找到后点击, 其他用法例子与zm.FindCmpPC()相同
Dim 多点比色_红龙 = {"205|177|0CBB00,228|169|FFFFFF", 0.8}
Dim 结果_红龙 = zm.FindCmpPCTap(多点比色_红龙)
If 结果_红龙 Then 
	TracePrint "找到并点击坐标为:", 结果_红龙["x"], 结果_红龙["y"]
Else 
	TracePrint "没有找到红龙"
End If

//点击坐标参数可以自由调整, 下面举几种例子
//这里的"100,200"代表只要找到, 就会点击固定坐标100, 200, 与找到坐标无关
zm.FindCmpPCTap(多点比色_红龙, "100,200")

//这里的"+10,200"代表只要找到, 就点击x坐标为找到的x+10, 点击y坐标为固定200
zm.FindCmpPCTap(多点比色_红龙, "+10,200")

//这里的"+10,-20"代表只要找到, 就点击x坐标为找到的x+10, 点击y坐标为找到的y-20, 相当于是偏移点击
zm.FindCmpPCTap(多点比色_红龙, "+10,-20")

//这里的"+10,-20,3000"代表只要找到, 就点击x坐标为找到的x+10, 点击y坐标为找到的y-20, 并且点击后延时3000毫秒
zm.FindCmpPCTap(多点比色_红龙, "+10,-20,3000")

//这里的"+0,-0,3000"代表只要找到, 就点击找到的坐标, 不做偏移, 并且点击后延时3000毫秒
zm.FindCmpPCTap(多点比色_红龙, "+0,+0,3000")</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>该命令用法灵活多变, 更多用法请大家自行摸索, 灵活使用输出日志可以事半功倍<br>
虽然本命令集成了四大图色命令, 但我依旧推荐单独使用对应图色命令, 因为各自对应命令更加便于阅读代码<br>
V4.2042: 初次加入</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FindColor" id="FindColor"> <a href="https://zimaoxy.com/m/post/zm.findcolor/" target="_blank">zm.FindColor 超级找色</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>比  <a href="https://zimaoxy.com/m/post/findcolor/" target="_blank">findcolor</a>  更加强大的命令, 具体特色如下<br><br>- 参数太多, 写的累? 所有参数都是可选的, 使你的代码更加简洁清晰<br>- 参数太多, 顺序记不住? 除了对象与范围是固定顺序外, 其他参数全部可以打乱顺序随便写<br>- 省略参数的默认值不理想? 可使用  <a href="https://zimaoxy.com/m/post/zm.setfindcolor/" target="_blank">zm.setfindcolor</a>  来自定义修改<br>- 担心一次找不到颜色? 自由设置限时循环查找时间, 提高成功率<br>- 画面变化太大, 相似度不好设置? 智能相似度帮你全自动查找<br>- 查找方向的数值总是记不住? 直接用中文 `"左上","中心","右上","左下","右下",...` 来代替<br>- 脚本出错找不到问题? 开启日志输出显示参数, 所有问题一目了然<br>- 找到后想等画面消失再继续下一步操作吗? 等待消失参数帮你解决这个烦恼<br>- 支持命令返回值与参数返回值, 你想怎么写, 就怎么写<br>- 返回值中有序号, 坐标, 还有对应的颜色值<br>- 支持对象参数写法, 将所有参数保存到一张表里, 直接传入该表<br>- 支持重写, 即传入对象参数后, 再写其他参数将会覆盖对应的对象数据<br>- 需要防检测点击功能? 推荐使用 <a href="https://zimaoxy.com/m/post/zm.findcolortap/" target="_blank">zm.findcolortap</a> <br>- 需要遍历多个对象数组? 推荐使用 <a href="https://zimaoxy.com/m/post/zm.findcolortable/" target="_blank">zm.findcolortable</a> <br>- 需要返回所有找到的坐标? 推荐使用 <a href="https://zimaoxy.com/m/post/zm.findcolorex/" target="_blank">zm.findcolorex</a> <br><br>!!! warning "常见错误"<br>    本命令的方向参数是字符串型, 例如`"左上"`之类, 而按键自带命令的方向是数值型, 例如`0`之类, 如果直接复制按键命令的参数, 一定要记得修改方向参数!</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">序号坐标颜色 = zm.FindColor([对象,][x1,y1,x2,y2,][颜色][,方向][,相似度[,智能相似度[,相似度步长]]][,查找次数][,是否点击][,点击坐标][,显示日志][,输出行号][,备注][,等待消失][,消失超时][,参数返回值])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象: 表, 可选, 把所有参数放入一个table中传入, 若后面跟有其他参数, 则会对应覆盖对象数据<br>x1: 数值型, 可选, 查找范围的左上角x坐标, 省略默认为0<br>y1: 数值型, 可选, 查找范围的左上角y坐标, 省略默认为0<br>x2: 数值型, 可选, 查找范围的右下角x坐标, 省略默认为0<br>y2: 数值型, 可选, 查找范围的右下角y坐标, 省略默认为0<br>颜色: 字符串, 可选, 要查找的16进制颜色，格式为“BBGGRR”，多个颜色用“&#124;”隔开，偏色使用“-”隔开，比如"FFFFFF-101010&#124;123456"<br>方向: 字符串, 可选, 从指定方向开始查找, 省略默认为`"左上"`, 支持`["左上","中心","右上","左下","右下","上左","上右","下左","下右"]`这几个值<br>相似度: 数值型, 可选, 对比查找的相似度小数, 省略默认为`1.0`, 取值范围`[0, 1.0]`, 越高越相似<br>智能相似度: 数值型, 可选, 与相似度组成组成智能相似计算范围, 适合图色变化大的情况, 省略默认取值与`相似度`相同, 取值范围`[0, 1.0]`, 越高越相似<br>相似度步长: 数值型, 可选, 智能相似度调节变化间隔, 必须写在`相似度`后面, 省略默认为`0.05`, 取值范围`[0, 1.0]`<br>超时时间: 数值型, 可选, 限时查找时间, 单位毫秒, 如果一次找不到, 可以限时循环查找, 省略默认为`1`<br>是否点击: 布尔型, 可选, 是否需要找到后自动点击该坐标, 支持`[true, false]`这两个值, 省略默认为`false`<br>点击坐标: 字符串, 可选, 点击修改后的坐标, 格式`"±x,±y,t"`, 省略为找到的坐标, `t`是可选的, 表示点击后延时毫秒, 例如`"100,100"`表示固定点击坐标100,100, `"+10,-10"`表示偏移点击找到的x+10,y-10位置, `"10,10,2000"`表示点击10,10坐标后延时2000毫秒, 该参数会受 <a href="https://zimaoxy.com/m/post/zm.settap/" target="_blank">zm.settap</a> 影响<br>显示日志: 字符串, 可选, 输出调试日志信息, 省略默认为"隐藏", 支持 `["显示","显示找到", "显示没找到","隐藏","show", "showfind", "shownofind","hide"]` 这几个值<br>输出行号: 字符串, 可选, 格式为`"_"`开头后跟行号, 比如`"_10"`表示第10行代码, 输出调试信息窗口显示第几行代码, 需开启显示日志才有效<br>备注: 字符串, 可选, 格式为`"@"`开头后跟内容, 在调试日志信息中加入该内容, 比如`"@拾取屠龙刀"`, 若连续两个`"@@"`则表示在浮窗中显示信息, 需要开启显示日志才有效<br>等待消失: 数值型, 可选, 填写`-1`禁用或`-2`启用, `-2`表示找到后或点击后继续查找, 直到找不到或消失超时, 省略默认为`-1`, 启用后返回值将有`miss`键名, 值为`true`时表示成功消失, 值为`false`表示未消失<br>消失超时: 数值型, 可选, 填写`负数`, 表示等待消失的超时时间, 单位毫秒, 注意必须填写负数, 不可填-1和-2, 省略默认为`-2000`<br>参数返回值: 表, 可选, 只能传入数组变量名, 用于保存查找结果, 格式与命令返回值相同</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 找到返回结果保存到表中, 格式为 `{id, x, y, name, "id":id, "x":x, "y":y, "name":name, "miss":miss}` , 没找到或出错返回`null`, 使用方法请看示例</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFindColor');">复制代码</div>
                <pre id="codeFindColor">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//--------------------初级用法--------------------//
Dim ret
//0.9表示相似度, 内置省略默认为1.0, 可自由设置
ret = zm.FindColor("00AAFF", 0.9)
If ret Then
    TracePrint "可以用以下3种格式获取返回值"
    TracePrint "找到颜色序号" & ret(0), "x=" & ret(1), "y=" & ret(2), "颜色=" & ret(3)
    TracePrint "找到颜色序号" & ret[1], "x=" & ret[2], "y=" & ret[3], "颜色=" & ret[4]
    TracePrint "找到颜色序号" & ret["id"], "x=" & ret["x"], "y=" & ret["y"], "颜色=" & ret["name"]
Else
    TracePrint "没有找到"
End If

//--------------------中级用法--------------------//
Dim 返回数组()
//参数返回值必须是任意数组的变量名, 注意括号写法
//范围省略默认为全屏, 若填写, 则4个数字必须全写
If zm.FindColor(100, 200, 300, 400, "00AAFF", 返回数组) Then
    TracePrint "可以用以下3种格式获取返回值"
    TracePrint "找到颜色序号" & 返回数组(0), "x=" & 返回数组(1), "y=" & 返回数组(2), "颜色=" & 返回数组(3)
    TracePrint "找到颜色序号" & 返回数组[1], "x=" & 返回数组[2], "y=" & 返回数组[3], "颜色=" & 返回数组[4]
    TracePrint "找到颜色序号" & 返回数组["id"], "x=" & 返回数组["x"], "y=" & 返回数组["y"], "颜色=" & 返回数组["name"]
Else
    TracePrint "没有找到"
End If

//--------------------高级用法--------------------//
//"00AAFF"颜色后面的可选参数全部可以打乱顺序任意填写或省略, 只要数据类型与格式正确即可, 详见上面参数介绍
//这句代码意思如下:
//在范围(100,200,300,400)里, 以相似度为(0.8)的设置, 从("中心")向四周循环限时2秒钟内查找颜色为("00AAFF")的点
//找到后退出循环查找, 并将找到的序号与坐标结果保存到数组变量(ret)与(返回数组)中
//同时开启日志的输出("显示")功能, 在当前脚本第("_36")行输出备注("@怪物1"), 查找结果与其他参数信息
ret = zm.FindColor(100, 200, 300, 400, "00AAFF", 0.8, 2000, "中心", "显示", "@怪物1", 返回数组, "_36")
If ret Then
    TracePrint "找到了"
Else
    TracePrint "没有找到"
End If

//--------------------对象用法--------------------//
//可以把所有参数放到一个表中, 颜色后面的可选参数一样可以打乱顺序任意填写或省略
//对象参数必须填写在第一个参数位置
//如果参数对象后面还有参数, 比如("_46"), 则表示重写对象里的("_36"), 使日志输出显示在46行
Dim 史莱姆 = {"00AAFF", 0.8, 2000, "显示", "@攻击史莱姆", 返回数组, "_46"}
zm.FindColor 史莱姆, 100, 200, 300, 400, "_46"

//--------------------修改默认值--------------------//
Dim IXYs()
//设置默认参数返回值IXYs, 若命令不填写参数返回值, 则默认保存在该变量中
//设置默认日志输出为显示状态, 后面所有 zm.FindColor() 都默认输出调试信息
//更多修改默认设置详见 zm.SetFindColor() 命令帮助
zm.SetFindColor {"ret":IXYs, "showlog":"显示"}
If zm.FindColor("00AAFF") Then
    TracePrint "可以用以下3种格式获取返回值"
    TracePrint "找到序号" & IXYs(0), "x=" & IXYs(1), "y=" & IXYs(2), "颜色=" & IXYs(3)
    TracePrint "找到序号" & IXYs[1], "x=" & IXYs[2], "y=" & IXYs[3], "颜色=" & IXYs[4]
    TracePrint "找到序号" & IXYs["id"], "x=" & IXYs["x"], "y=" & IXYs["y"], "颜色=" & IXYs["name"]
Else
    TracePrint "没有找到"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>该命令用法灵活多变, 更多用法请大家自行摸索, 灵活使用输出日志可以事半功倍<br>
偏色是微调，指对RBG三色分别确定取色范围。相似度是粗调，指对颜色整体做百分比判断。<br>
V1.1741: 加入命令<br>
V1.1745: 查找次数参数修改为超时参数, 加入自定义日志备注与行号, 其中设置相关的属性也有所变动<br>
V1.1746: 加入点击坐标参数<br>
V1.1750: 删除随机范围点击功能, 加入智能相似度参数<br>
V1.1802: <br>
    支持 <a href="https://zimaoxy.com/m/post/zm.settap/" target="_blank">zm.settap</a> 的随机点击<br>
    通过 <a href="https://zimaoxy.com/m/post/keepcapture/" target="_blank">keepcapture</a> 加快超级图色查找速度<br>
    优化部分参数判定, 兼容更多乱序参数<br>
    返回值加入找到颜色值<br>
V1.1803: 支持超级缩放命令, 点击功能只受是否点击参数影响<br>
V1.1804: 加入找到后等待消失可选参数<br>
V1.1813: 修复点击参数不继承`zm.SetTap()`设置延时问题, 感谢`likanglong`反馈<br>
V1.1818: <br>
    修复由超级缩放命令引起的自动点击坐标0,0问题, 感谢`ersheep`反馈此BUG<br>
    修复超级图色输出是否点击异常, 感谢`2578学员`反馈此BUG<br>
V2.1826: 为智能相似度增加另一种方便的写法, 旧语法依旧有效<br>
V2.1828: 若要点击找到坐标, 推荐使用 <a href="https://zimaoxy.com/m/post/zm.findcolortap/" target="_blank">zm.findcolortap</a> <br>
V4.2042: 日志参数 `showlog` 加入 `["显示找到","显示没找到","showfind","shownofind"]` 选项</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FindColorEx" id="FindColorEx"> <a href="https://zimaoxy.com/m/post/zm.findcolorex/" target="_blank">zm.FindColorEx 超级找色返回所有坐标</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>与 <a href="https://zimaoxy.com/m/post/zm.findcolor/" target="_blank">zm.findcolor</a> 类似, 区别在于本命令会找到所有符合条件的坐标并返回二维数组</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FindColorEx([对象][x1, y1, x2, y2, ]颜色[, 相似度[, 智能相似度[, 相似度步长]]][, 查找超时][, 是否点击][, 点击坐标][, 显示日志][, 输出行号][, 备注][, 等待消失][, 消失超时][, 参数返回值])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象: 表, 可选, 把所有参数放入一个table中传入, 若后面跟有其他参数, 则会对应覆盖对象数据<br>x1: 数值型, 可选, 查找范围的左上角x坐标, 省略默认为0<br>y1: 数值型, 可选, 查找范围的左上角y坐标, 省略默认为0<br>x2: 数值型, 可选, 查找范围的右下角x坐标, 省略默认为0<br>y2: 数值型, 可选, 查找范围的右下角y坐标, 省略默认为0<br>颜色: 字符串, 可选, 要查找的16进制颜色，格式为“BBGGRR”，多个颜色用“&#124;”隔开，偏色使用“-”隔开，比如"FFFFFF-101010&#124;123456"<br>方向: 字符串, 可选, 从指定方向开始查找, 省略默认为`"左上"`, 支持`["左上","中心","右上","左下","右下","上左","上右","下左","下右"]`这几个值<br>相似度: 数值型, 可选, 对比查找的相似度小数, 省略默认为`1.0`, 取值范围`[0, 1.0]`, 越高越相似<br>智能相似度: 数值型, 可选, 与相似度组成组成智能相似计算范围, 适合图色变化大的情况, 省略默认取值与`相似度`相同, 取值范围`[0, 1.0]`, 越高越相似<br>相似度步长: 数值型, 可选, 智能相似度调节变化间隔, 必须写在`相似度`后面, 省略默认为`0.05`, 取值范围`[0, 1.0]`<br>超时时间: 数值型, 可选, 限时查找时间, 单位毫秒, 如果一次找不到, 可以限时循环查找, 省略默认为`1`<br>是否点击: 布尔型, 可选, 是否需要找到后自动点击该坐标, 支持`[true, false]`这两个值, 省略默认为`false`<br>点击坐标: 字符串, 可选, 点击修改后的坐标, 格式`"±x,±y,t"`, 省略为找到的坐标, `t`是可选的, 表示点击后延时毫秒, 例如`"100,100"`表示固定点击坐标100,100, `"+10,-10"`表示偏移点击找到的x+10,y-10位置, `"10,10,2000"`表示点击10,10坐标后延时2000毫秒, 该参数会受 <a href="https://zimaoxy.com/m/post/zm.settap/" target="_blank">zm.settap</a> 影响<br>显示日志: 字符串, 可选, 输出调试日志信息, 省略默认为"隐藏", 支持 `["显示","显示找到", "显示没找到","隐藏","show", "showfind", "shownofind","hide"]` 这几个值<br>输出行号: 字符串, 可选, 格式为`"_"`开头后跟行号, 比如`"_10"`表示第10行代码, 输出调试信息窗口显示第几行代码, 需开启显示日志才有效<br>备注: 字符串, 可选, 格式为`"@"`开头后跟内容, 在调试日志信息中加入该内容, 比如`"@拾取屠龙刀"`, 若连续两个`"@@"`则表示在浮窗中显示信息, 需要开启显示日志才有效<br>等待消失: 数值型, 可选, 填写`-1`禁用或`-2`启用, `-2`表示找到后或点击后继续查找, 直到找不到或消失超时, 省略默认为`-1`, 启用后返回值将有`miss`键名, 值为`true`时表示成功消失, 值为`false`表示未消失<br>消失超时: 数值型, 可选, 填写`负数`, 表示等待消失的超时时间, 单位毫秒, 注意必须填写负数, 不可填-1和-2, 省略默认为`-2000`<br>参数返回值: 表, 可选, 只能传入数组变量名, 用于保存查找结果, 格式与命令返回值相同</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">table_ , 找到返回结果保存到表中, 格式为 `{ {id, x, y}, ..., "xy":{id:{ {x,y}, ...}, ...}, "id":{id, ...}, "counts":数量, "miss":miss}` , 没找到或出错返回`null`</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFindColorEx');">复制代码</div>
                <pre id="codeFindColorEx">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim ret
ret = zm.FindColorEx("BDBDBD|614B6B|FFFFFF")
If ret Then
    TracePrint "颜色找到了, 有以下几种方式遍历找到的坐标"
    TracePrint "第1种:遍历数组方法"
    For i = 0 to Ubound(ret)
        TracePrint "颜色序号:", ret(i, 0), " 坐标:", ret(i, 1), ret(i, 2)
    Next

    TracePrint "第2种:遍历键名"
    For Each k , v In ret["xy"]
    	For Each xy In v
    		TracePrint "颜色序号:", k, " 坐标:", xy[1], xy[2]
    	Next
    Next
    
    TracePrint "第3种:获取指定颜色序号的坐标"
    If ret["xy"][2] Then 
    	For Each xy In ret["xy"][2]
    		TracePrint "颜色序号2的找到坐标:", xy[1], xy[2]
    	Next
    Else 
    	TracePrint "颜色序号2没有找到"
    End If
Else
    TracePrint "没有找到颜色"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>该命令与 <a href="https://zimaoxy.com/m/post/zm.findcolor/" target="_blank">zm.findcolor</a> 类似, 唯一区别在于返回内容是找到的所有坐标二维数组<br>
V3.1830: 加入命令<br>
V3.1831: 修复返回值被前次结果覆盖的问题<br>
V3.1929: 修复返回值缺少counts问题<br>
V4.2042: 日志参数 `showlog` 加入 `["显示找到","显示没找到","showfind","shownofind"]` 选项</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FindColorTable" id="FindColorTable"> <a href="https://zimaoxy.com/m/post/zm.findcolortable/" target="_blank">zm.FindColorTable 超级找色遍历</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>与 <a href="https://zimaoxy.com/m/post/zm.findcolor/" target="_blank">zm.findcolor</a> 类似, 参数只有一个对象数组, 可实现遍历参数的键值对象进行查找</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FindColorTable(对象table)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象table: table, 把 <a href="https://zimaoxy.com/m/post/zm.findcolor/" target="_blank">zm.findcolor</a> 的对象参数放入table数组中, 实现遍历找色</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">查找结果, table_ , 找到返回结果保存到表中, 格式为 `{"success":找到数量, "fail":没找到数量, "键名":{id, x, y, name, "id":id, "x":x, "y":y, "name":name, "miss":miss}, ...}` , 全部没找到或失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFindColorTable');">复制代码</div>
                <pre id="codeFindColorTable">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim 打怪(), Boss坐标()
打怪["史莱姆"] = {"00AAFF", true}
打怪["黑龙"] = {100,200,300,400, "1155BB", true}
打怪["紫猫BOSS"] = {"FFFFFF", Boss坐标} //这个不点击

//遍历打怪数组, 返回每个对象成员的结果
Dim t = zm.FindColorTable(打怪)
If t Then
    TracePrint "找到了", t["success"], "个对象"
    TracePrint "没找到", t["fail"], "个对象"
    If t["史莱姆"] Then
        TracePrint "找到史莱姆, 坐标为", t["史莱姆"]["x"], t["史莱姆"]["y"]
    End If
Else
    TracePrint "所有对象都没有找到"
End If

If Boss坐标(0) > -1 Then
    TracePrint "紫猫BOSS对象里的返回参数依旧有效"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>该命令与 <a href="https://zimaoxy.com/m/post/zm.findcolor/" target="_blank">zm.findcolor</a> 类似, 唯一区别在于参数只有一个对象table, 可以遍历所有对象<br>
V2.1829: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FindColorTap" id="FindColorTap"> <a href="https://zimaoxy.com/m/post/zm.findcolortap/" target="_blank">zm.FindColorTap 超级找色点击</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>与 <a href="https://zimaoxy.com/m/post/zm.findcolor/" target="_blank">zm.findcolor</a> 类似, 区别在于本命令内置找到后点击. 由于查找与点击是两个动作组成, 为方便代码阅读理解, 故新增本命令</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">序号坐标颜色 = zm.FindColorTap([对象,][x1,y1,x2,y2,][颜色][,方向][,相似度[,智能相似度[,相似度步长]]][,查找次数][,点击坐标][,显示日志][,输出行号][,备注][,等待消失][,消失超时][,参数返回值])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象: 表, 可选, 把所有参数放入一个table中传入, 若后面跟有其他参数, 则会对应覆盖对象数据<br>x1: 数值型, 可选, 查找范围的左上角x坐标, 省略默认为0<br>y1: 数值型, 可选, 查找范围的左上角y坐标, 省略默认为0<br>x2: 数值型, 可选, 查找范围的右下角x坐标, 省略默认为0<br>y2: 数值型, 可选, 查找范围的右下角y坐标, 省略默认为0<br>颜色: 字符串, 可选, 要查找的16进制颜色，格式为“BBGGRR”，多个颜色用“&#124;”隔开，偏色使用“-”隔开，比如"FFFFFF-101010&#124;123456"<br>方向: 字符串, 可选, 从指定方向开始查找, 省略默认为`"左上"`, 支持`["左上","中心","右上","左下","右下","上左","上右","下左","下右"]`这几个值<br>相似度: 数值型, 可选, 对比查找的相似度小数, 省略默认为`1.0`, 取值范围`[0, 1.0]`, 越高越相似<br>智能相似度: 数值型, 可选, 与相似度组成组成智能相似计算范围, 适合图色变化大的情况, 省略默认取值与`相似度`相同, 取值范围`[0, 1.0]`, 越高越相似<br>相似度步长: 数值型, 可选, 智能相似度调节变化间隔, 必须写在`相似度`后面, 省略默认为`0.05`, 取值范围`[0, 1.0]`<br>超时时间: 数值型, 可选, 限时查找时间, 单位毫秒, 如果一次找不到, 可以限时循环查找, 省略默认为`1`<br>点击坐标: 字符串, 可选, 点击修改后的坐标, 格式`"±x,±y,t"`, 省略为点击找到坐标, `t`是可选的, 表示点击后延时毫秒, 例如`"100,100"`表示固定点击坐标100,100, `"+10,-10"`表示偏移点击找到的x+10,y-10位置, `"10,10,2000"`表示点击10,10坐标后延时2000毫秒, 该参数会受 <a href="https://zimaoxy.com/m/post/zm.settap/" target="_blank">zm.settap</a> 影响<br>显示日志: 字符串, 可选, 输出调试日志信息, 省略默认为"隐藏", 支持 `["显示","显示找到", "显示没找到","隐藏","show", "showfind", "shownofind","hide"]` 这几个值<br>输出行号: 字符串, 可选, 格式为`"_"`开头后跟行号, 比如`"_10"`表示第10行代码, 输出调试信息窗口显示第几行代码, 需开启显示日志才有效<br>备注: 字符串, 可选, 格式为`"@"`开头后跟内容, 在调试日志信息中加入该内容, 比如`"@拾取屠龙刀"`, 若连续两个`"@@"`则表示在浮窗中显示信息, 需要开启显示日志才有效<br>等待消失: 数值型, 可选, 填写`-1`禁用或`-2`启用, `-2`表示找到后或点击后继续查找, 直到找不到或消失超时, 省略默认为`-1`, 启用后返回值将有`miss`键名, 值为`true`时表示成功消失, 值为`false`表示未消失<br>消失超时: 数值型, 可选, 填写`负数`, 表示等待消失的超时时间, 单位毫秒, 注意必须填写负数, 不可填-1和-2, 省略默认为`-2000`<br>参数返回值: 表, 可选, 只能传入数组变量名, 用于保存查找结果, 格式与命令返回值相同</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 找到返回结果保存到表中, 格式为`{id, x, y, name, "id":id, "x":x, "y":y, "name":name, "miss":miss}`, 没找到或出错返回null, 使用方法请看示例</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFindColorTap');">复制代码</div>
                <pre id="codeFindColorTap">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//本命令内置找到后点击, 其他用法例子与zm.FindColor()相同
Dim ret
//找到颜色后执行点击
ret = zm.FindColorTap("00AAFF", 0.9)
If ret Then
    TracePrint "颜色找到并执行了点击"
Else
    TracePrint "没有找到颜色, 不执行点击"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>内置找到后点击坐标, 无法取消, 建议需要点击操作的超级图色使用本命令, 方便代码阅读理解<br>
该命令用法灵活多变, 更多用法请大家自行摸索, 灵活使用输出日志可以事半功倍<br>
偏色是微调，指对RBG三色分别确定取色范围。相似度是粗调，指对颜色整体做百分比判断。<br>
V1.1820: 加入命令<br>
V2.1826<br>
    为智能相似度增加另一种方便的写法, 旧语法依旧有效<br>
V4.2042: 日志参数 `showlog` 加入 `["显示找到","显示没找到","showfind","shownofind"]` 选项</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FindMultiColor" id="FindMultiColor"> <a href="https://zimaoxy.com/m/post/zm.findmulticolor/" target="_blank">zm.FindMultiColor 超级多点找色</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>比  <a href="https://zimaoxy.com/m/post/findmulticolor/" target="_blank">findmulticolor</a>  更加强大的命令, 具体特色如下<br><br>- 支持多个多点找色数据, 并且返回找到的序号, 详见示例<br>- 想找会变化的动态图? 请看下面示例<br>- 参数太多, 写的累? 所有参数都是可选的, 使你的代码更加简洁清晰<br>- 参数太多, 顺序记不住? 除了对象与范围是固定顺序外, 其他参数全部可以打乱顺序随便写<br>- 省略参数的默认值不理想? 可使用  <a href="https://zimaoxy.com/m/post/zm.setfindmulticolor/" target="_blank">zm.setfindmulticolor</a>  来自定义修改<br>- 担心一次找不到颜色? 自由设置限时循环查找时间, 提高成功率<br>- 画面变化太大, 相似度不好设置? 智能相似度帮你全自动查找<br>- 查找方向的数值总是记不住? 直接用中文 `"左上","中心","右上","左下","右下",...` 来代替<br>- 脚本出错找不到问题? 开启日志输出显示参数, 所有问题一目了然<br>- 找到后想等画面消失再继续下一步操作吗? 等待消失参数帮你解决这个烦恼<br>- 支持命令返回值与参数返回值, 你想怎么写, 就怎么写<br>- 返回值中有序号, 坐标, 还有对应的颜色值<br>- 支持对象参数写法, 将所有参数保存到一张表里, 直接传入该表<br>- 支持重写, 即传入对象参数后, 再写其他参数将会覆盖对应的对象数据, 多点数据比较特殊, 详见示例<br>- 需要防检测点击功能? 推荐使用 <a href="https://zimaoxy.com/m/post/zm.findmulticolortap/" target="_blank">zm.findmulticolortap</a> <br>- 需要遍历多个对象数组? 推荐使用 <a href="https://zimaoxy.com/m/post/zm.findmulticolortable/" target="_blank">zm.findmulticolortable</a> <br>- 需要返回所有找到的坐标? 推荐使用 <a href="https://zimaoxy.com/m/post/zm.findmulticolorex/" target="_blank">zm.findmulticolorex</a> <br><br>!!! warning "常见错误"<br>    本命令的方向参数是字符串型, 例如`"左上"`之类, 而按键自带命令的方向是数值型, 例如`0`之类, 如果直接复制按键命令的参数, 一定要记得修改方向参数!</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">序号坐标颜色 = zm.FindMultiColor([对象,][x1,y1,x2,y2,][第一点颜色,偏移颜色组][,方向][,相似度[,智能相似度[,相似度步长]]][,超时时间][,是否点击][,点击坐标][,显示日志][,输出行号][,备注][,等待消失][,消失超时][,参数返回值])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象: 表, 可选, 把所有参数放入一个table中传入, 若后面跟有其他参数, 则会对应覆盖对象数据<br>x1: 数值型, 可选, 查找范围的左上角x坐标, 省略默认为0<br>y1: 数值型, 可选, 查找范围的左上角y坐标, 省略默认为0<br>x2: 数值型, 可选, 查找范围的右下角x坐标, 省略默认为0<br>y2: 数值型, 可选, 查找范围的右下角y坐标, 省略默认为0<br>第一点颜色: 字符串, 可选, 要查找的16进制颜色，格式为“BBGGRR”，多个颜色用“&#124;”隔开，偏色使用“-”隔开，比如"FFFFFF-101010&#124;123456", 后面必须跟偏移颜色组, 支持多参数, 支持 `{第一点颜色, 偏移颜色组}` 格式, 详见示例<br>偏移颜色组: 字符串, 可选, 相对与第一个颜色坐标点的偏移颜色组，推荐用抓抓工具快速生成, 前面必须是第一点颜色，支持多参数, 支持 `{第一点颜色, 偏移颜色组}` 格式, 详见示例<br>方向: 字符串, 可选, 从指定方向开始查找, 省略默认为`"左上"`, 支持`["左上","中心","右上","左下","右下","上左","上右","下左","下右"]`这几个值<br>相似度: 数值型, 可选, 对比查找的相似度小数, 省略默认为`0.9`, 取值范围`[0, 1.0]`, 越高越相似<br>智能相似度: 数值型, 可选, 与相似度组成组成智能相似计算范围, 适合图色变化大的情况, 省略默认取值与`相似度`相同, 取值范围`[0, 1.0]`, 越高越相似<br>相似度步长: 数值型, 可选, 智能相似度调节变化间隔, 必须写在`相似度`后面, 省略默认为`0.05`, 取值范围`[0, 1.0]`<br>超时时间: 数值型, 可选, 最大查找耗时, 单位毫秒, 如果一次找不到, 可以限时循环查找, 省略默认为`1`<br>是否点击: 布尔型, 可选, 是否需要找到后自动点击该坐标, 支持`[true, false]`这两个值, 省略默认为`false`<br>点击坐标: 字符串, 可选, 点击修改后的坐标, 格式`"±x,±y,t"`, 省略为找到的坐标, `t`是可选的, 表示点击后延时毫秒, 例如`"100,100"`表示固定点击坐标100,100, `"+10,-10"`表示偏移点击找到的x+10,y-10位置, `"10,10,2000"`表示点击10,10坐标后延时2000毫秒, 该参数会受 <a href="https://zimaoxy.com/m/post/zm.settap/" target="_blank">zm.settap</a> 影响<br>显示日志: 字符串, 可选, 输出调试日志信息, 省略默认为"隐藏", 支持 `["显示","显示找到", "显示没找到","隐藏","show", "showfind", "shownofind","hide"]` 这几个值<br>输出行号: 字符串, 可选, 格式为`"_"`开头后跟行号, 比如`"_10"`表示第10行代码, 输出调试信息窗口显示第几行代码, 需开启显示日志才有效<br>备注: 字符串, 可选, 格式为`"@"`开头后跟内容, 比如`"@拾取屠龙刀"`, 输出调试信息窗口就会增加这条内容, 若连续两个`"@@"`则表示在浮窗中显示信息, 需要开启显示日志才有效<br>等待消失: 数值型, 可选, 填写`-1`禁用或`-2`启用, `-2`表示找到后或点击后继续查找, 直到找不到或消失超时, 省略默认为`-1`, 启用后返回值将有`miss`键名, 值为`true`时表示成功消失, 值为`false`表示未消失<br>消失超时: 数值型, 可选, 填写`负数`, 表示等待消失的超时时间, 单位毫秒, 注意必须填写负数, 不可填-1和-2, 省略默认为`-2000`<br>参数返回值: 表, 可选, 只能传入数组变量名, 用于保存查找结果, 格式与命令返回值相同</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 找到返回结果保存到表中, 格式为`{id, x, y, name, "id":id, "x":x, "y":y, "name":name, "miss":miss}`, 没找到或出错返回null, 使用方法请看示例</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFindMultiColor');">复制代码</div>
                <pre id="codeFindMultiColor">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//--------------------初级用法--------------------//
Dim retA
//表示查找两个多点找色数据, 分别是"BDBDBD","56|33|614B6B"和"242424","-10|2|ABC54A,9|4|12DC67"
//支持无限添加多点找色数据, 只要按照格式"第一点颜色","偏移颜色组"依次添加即可
retA = zm.FindMultiColor("BDBDBD", "56|33|614B6B", "242424", "-10|2|ABC54A,9|4|12DC67")
If retA Then
    TracePrint "颜色找到了"
Else
    TracePrint "没有找到颜色"
End If

//--------------------查找变化动态图--------------------//
Dim ret
//原理: 用抓抓截图后, 图片是静止不变的, 多次截图可以获取到不同的画面
//     说明所谓的动态图其实就是由一些静止不动的画面来回切换实现的
//     那么对每一次截图采集一些多点找色数据, 然后让脚本循环多次查找这些数据
//     只要任何一个数据找到了, 都可以认为是找到这个动态图了
//     所以可以使用本命令的无限添加多点数据与设置超时时间来实现
//     想提高查找速度的话, 建议缩小范围, 提高相似度
ret = zm.FindMultiColor("BDBDBD", "56|33|614B6B", "242424", "-10|2|ABC54A,9|4|12DC67",5000)
If ret Then
    TracePrint "找到序号" & ret(0), "x=" & ret(1), "y=" & ret(2), "颜色=" & ret(3)
Else
    TracePrint "没有找到"
End If

//--------------------中级用法--------------------//
Dim 返回数组()
//参数返回值必须是任意数组的变量名, 注意括号写法
//范围省略默认为全屏, 若填写, 则4个数字必须全写, 除对象参数外, 其他参数都要写在范围后面
If zm.FindMultiColor(100, 200, 300, 400, "000000", "44|42|565656", 0.8, 返回数组) Then
    TracePrint "找到序号" & 返回数组["id"], "x=" & 返回数组["x"], "y=" & 返回数组["y"], "颜色=" & 返回数组["name"]
Else
    TracePrint "没有找到"
End If

//--------------------高级用法--------------------//
//范围后面的可选参数全部可以打乱顺序任意填写或省略, 只要数据类型与格式正确即可
//注意, "第一点颜色","偏移颜色组"这两个参数必须连在一起, 详见上面参数介绍
//这句代码意思如下:
//在范围(100,200,300,400)里, 以相似度为(0.8)的设置, 从("中心")向四周循环多点找色查找最多2秒钟
//第一点为("00AAFF")偏移颜色组为("42|42|565656")和第一点为("DD58FF")偏移颜色组为("3|4|A25C6D")
//找到任何一个后退出循环查找, 然后点击找到的坐标(True), 并将找到的序号与坐标结果保存到数组变量(ret)与(返回数组)中
//同时开启日志的输出("显示")功能, 在当前脚本第("_39")行输出备注("@怪物1"), 查找结果与其他参数信息
Dim retB = zm.FindMultiColor(100, 200, 300, 400, "00AAFF", "42|42|565656", 0.8, 2000, "中心", "DD58FF", "3|4|A25C6D", True, "显示", "@怪物1", 返回数组, "_39")
If retB Then
    TracePrint "找到了"
Else
    TracePrint "没有找到"
End If

//--------------------对象用法--------------------//
//可以把所有参数放到一个表中, 可选参数一样可以打乱顺序任意填写或省略
//对象参数必须填写在第一个参数位置
//如果参数对象后面还有参数, 比如("_46"), 则表示重写对象里的("_36"), 使日志输出显示在46行
//注意, 多点找色数据不会被覆盖重写, 只会被追加, 相当于所有的多点找色数据都会被用来查找
Dim 史莱姆 = {"00AAFF", "42|42|565656", 0.8, 2000, True, "显示", "@攻击史莱姆", 返回数组, "_36"}
zm.FindMultiColor 史莱姆, 100, 200, 300, 400, "_46", "DD58FF", "3|4|A25C6D"

//--------------------修改默认值--------------------//
Dim IXYs()
//设置默认参数返回值IXYs, 若命令不填写参数返回值, 则默认保存在该变量中
//设置默认日志输出为显示状态, 后面所有 zm.FindMultiColor() 都默认输出调试信息
//更多修改默认设置详见 zm.SetFindMultiColor() 命令帮助
zm.SetFindMultiColor {"ret":IXYs, "showlog":"显示"}
If zm.FindMultiColor("00AAFF", "42|42|565656") Then
    TracePrint "可以用以下3种格式获取返回值"
    TracePrint "找到序号" & IXYs(0), "x=" & IXYs(1), "y=" & IXYs(2), "颜色=" & IXYs(3)
    TracePrint "找到序号" & IXYs[1], "x=" & IXYs[2], "y=" & IXYs[3], "颜色=" & IXYs[4]
    TracePrint "找到序号" & IXYs["id"], "x=" & IXYs["x"], "y=" & IXYs["y"], "颜色=" & IXYs["name"]
Else
    TracePrint "没有找到"
End If

//----------------V4.2039版以上支持颜色描述数组数据----------------//
Dim 黑龙, 白龙 //一维数组例子
黑龙 = {"BDBDBD", "56|33|614B6B"}
白龙 = {"242424", "-10|2|ABC54A,9|4|12DC67"}
Dim retD = zm.FindMultiColor(黑龙, 白龙, 0.8)
If retD Then
    TracePrint "颜色找到了"
Else
    TracePrint "没有找到颜色"
End If

Dim 颜色数组() //二维数组例子
颜色数组(0) = {"BDBDBD", "56|33|614B6B"}
颜色数组(1) = {"242424", "-10|2|ABC54A,9|4|12DC67"}
Dim retC = zm.FindMultiColor(颜色数组, 0.8)
If retC Then
    TracePrint "颜色找到了"
Else
    TracePrint "没有找到颜色"
End If
</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>该命令用法灵活多变, 更多用法请大家自行摸索, 灵活使用输出日志可以事半功倍<br>
多点找色数据请通过抓抓进行获取<br>
偏色是微调，指对RBG三色分别确定取色范围。相似度是粗调，指对颜色整体做百分比判断。<br>
偏移颜色组是指相对于第一个点的偏移坐标与颜色，比如第一个点颜色123456在100,120坐标，第二个点颜色abcdef在150,180坐标，那么点2相对于点1的偏移坐标就是150-100,180-120，偏移颜色组为“50|60|abcdef”。<br>
V1.1741: 加入命令<br>
V1.1745: 查找次数参数修改为超时参数, 加入自定义日志备注与行号, 其中设置相关的属性也有所变动<br>
V1.1746: 加入点击坐标参数<br>
V1.1750: 删除随机范围点击功能, 加入智能相似度参数<br>
V1.1802: <br>
    支持 <a href="https://zimaoxy.com/m/post/zm.settap/" target="_blank">zm.settap</a> 的随机点击<br>
    通过 <a href="https://zimaoxy.com/m/post/keepcapture/" target="_blank">keepcapture</a> 加快超级图色查找速度<br>
    优化部分参数判定, 兼容更多乱序参数<br>
    返回值加入找到颜色值<br>
V1.1803: 支持超级缩放命令, 点击功能只受是否点击参数影响<br>
V1.1804: 加入找到后等待消失可选参数<br>
V1.1813: 修复点击参数不继承`zm.SetTap()`设置延时和等待消失无效的问题, 感谢`likanglong`反馈<br>
V1.1818: <br>
    修复由超级缩放命令引起的自动点击坐标0,0问题, 感谢`ersheep`反馈此BUG<br>
    修复超级图色输出是否点击异常, 感谢`2578学员`反馈此BUG<br>
V2.1826: 为智能相似度增加另一种方便的写法, 旧语法依旧有效<br>
V2.1828: 若要点击找到坐标, 推荐使用 <a href="https://zimaoxy.com/m/post/zm.findmulticolortap/" target="_blank">zm.findmulticolortap</a> <br>
V3.1852: <br>
    偏移颜色组参数支持带小数点坐标<br>
    启用检测是否消失功能后, 返回最后一次出现的坐标与序号, 保存在键名`missx`, `missy`, `missid`中<br>
V4.2039: 加入颜色描述数组数据支持<br>
V4.2042: 日志参数 `showlog` 加入 `["显示找到","显示没找到","showfind","shownofind"]` 选项</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FindMultiColorEx" id="FindMultiColorEx"> <a href="https://zimaoxy.com/m/post/zm.findmulticolorex/" target="_blank">zm.FindMultiColorEx 超级多点找色返回所有坐标</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>与 <a href="https://zimaoxy.com/m/post/zm.findmulticolor/" target="_blank">zm.findmulticolor</a> 类似, 区别在于本命令会找到所有符合条件的坐标并返回二维数组</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">序号坐标颜色 = zm.FindMultiColorEx([对象,][x1,y1,x2,y2,][第一点颜色,偏移颜色组][,方向][,相似度[,智能相似度[,相似度步长]]][,超时时间][,是否点击坐标][,点击坐标][,显示日志][,输出行号][,备注][,等待消失][,消失超时][,参数返回值])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象: 表, 可选, 把所有参数放入一个table中传入, 若后面跟有其他参数, 则会对应覆盖对象数据<br>x1: 数值型, 可选, 查找范围的左上角x坐标, 省略默认为0<br>y1: 数值型, 可选, 查找范围的左上角y坐标, 省略默认为0<br>x2: 数值型, 可选, 查找范围的右下角x坐标, 省略默认为0<br>y2: 数值型, 可选, 查找范围的右下角y坐标, 省略默认为0<br>第一点颜色: 字符串, 可选, 要查找的16进制颜色，格式为“BBGGRR”，多个颜色用“&#124;”隔开，偏色使用“-”隔开，比如"FFFFFF-101010&#124;123456", 后面必须跟偏移颜色组, 支持多参数, 详见示例<br>偏移颜色组: 字符串, 可选, 相对与第一个颜色坐标点的偏移颜色组，推荐用抓抓工具快速生成, 前面必须是第一点颜色，支持多参数, 详见示例<br>方向: 字符串, 可选, 从指定方向开始查找, 省略默认为`"左上"`, 支持`["左上","中心","右上","左下","右下","上左","上右","下左","下右"]`这几个值<br>相似度: 数值型, 可选, 对比查找的相似度小数, 省略默认为`0.9`, 取值范围`[0, 1.0]`, 越高越相似<br>智能相似度: 数值型, 可选, 与相似度组成组成智能相似计算范围, 适合图色变化大的情况, 省略默认取值与`相似度`相同, 取值范围`[0, 1.0]`, 越高越相似<br>相似度步长: 数值型, 可选, 智能相似度调节变化间隔, 必须写在`相似度`后面, 省略默认为`0.05`, 取值范围`[0, 1.0]`<br>超时时间: 数值型, 可选, 最大查找耗时, 单位毫秒, 如果一次找不到, 可以限时循环查找, 省略默认为`1`<br>是否点击: 布尔型, 可选, 是否需要找到后自动点击该坐标, 支持`[true, false]`这两个值, 省略默认为`false`<br>点击坐标: 字符串, 可选, 点击修改后的坐标, 格式`"±x,±y,t"`, 省略为点击找到坐标, `t`是可选的, 表示点击后延时毫秒, 例如`"100,100"`表示固定点击坐标100,100, `"+10,-10"`表示偏移点击找到的x+10,y-10位置, `"10,10,2000"`表示点击10,10坐标后延时2000毫秒, 该参数会受 <a href="https://zimaoxy.com/m/post/zm.settap/" target="_blank">zm.settap</a> 影响<br>显示日志: 字符串, 可选, 输出调试日志信息, 省略默认为"隐藏", 支持 `["显示","显示找到", "显示没找到","隐藏","show", "showfind", "shownofind","hide"]` 这几个值<br>输出行号: 字符串, 可选, 格式为`"_"`开头后跟行号, 比如`"_10"`表示第10行代码, 输出调试信息窗口显示第几行代码, 需开启显示日志才有效<br>备注: 字符串, 可选, 格式为`"@"`开头后跟内容, 比如`"@拾取屠龙刀"`, 输出调试信息窗口就会增加这条内容, 若连续两个`"@@"`则表示在浮窗中显示信息, 需要开启显示日志才有效<br>等待消失: 数值型, 可选, 填写`-1`禁用或`-2`启用, `-2`表示找到后或点击后继续查找, 直到找不到或消失超时, 省略默认为`-1`, 启用后返回值将有`miss`键名, 值为`true`时表示成功消失, 值为`false`表示未消失<br>消失超时: 数值型, 可选, 填写`负数`, 表示等待消失的超时时间, 单位毫秒, 注意必须填写负数, 不可填-1和-2, 省略默认为`-2000`<br>参数返回值: table, 可选, 只能传入数组变量名, 用于保存查找结果, 格式与命令返回值相同</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">table_ , 找到返回结果保存到表中, 格式为`{ {id, x, y}, ..., "xy":{id:{ {x,y}, ...}, ...}, "id":{id, ...}, "counts":数量, "miss":miss}`, 没找到或出错返回`null`</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFindMultiColorEx');">复制代码</div>
                <pre id="codeFindMultiColorEx">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim ret
ret = zm.FindMultiColorEx("BDBDBD", "56|33|614B6B", "000000", "56|33|614B6B")
If ret Then
    TracePrint "颜色找到了, 有以下几种方式遍历找到的坐标"
    TracePrint "第1种:遍历数组方法"
    For i = 0 to Ubound(ret)
        TracePrint "颜色序号:", ret(i, 0), " 坐标:", ret(i, 1), ret(i, 2)
    Next

    TracePrint "第2种:遍历键名"
    For Each k , v In ret["xy"]
    	For Each xy In v
    		TracePrint "颜色序号:", k, " 坐标:", xy[1], xy[2]
    	Next
    Next
    
    TracePrint "第3种:获取指定颜色序号的坐标"
    If ret["xy"][2] Then 
    	For Each xy In ret["xy"][2]
    		TracePrint "颜色序号2的找到坐标:", xy[1], xy[2]
    	Next
    Else 
    	TracePrint "颜色序号2没有找到"
    End If
Else
    TracePrint "没有找到颜色"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>该命令与 <a href="https://zimaoxy.com/m/post/zm.findmulticolor/" target="_blank">zm.findmulticolor</a> 类似, 唯一区别在于返回内容是找到的所有坐标二维数组<br>
V2.1829: 加入命令<br>
V3.1830: <br>
    函数名从`zm.FindMultiColorAll()`改为`zm.FindMultiColorEx()`<br>
    返回值格式改动, 具体看帮助<br>
V3.1831: 修复返回值被前次结果覆盖的问题<br>
V3.1852: <br>
    偏移颜色组参数支持带小数点坐标<br>
    启用检测是否消失功能后, 返回最后一次出现的坐标与序号, 保存在键名`missx`, `missy`, `missid`中<br>
V4.2039: 加入颜色描述数组数据支持<br>
V4.2042: <br>
    修复颜色描述数组兼容问题<br>
    日志参数 `showlog` 加入 `["显示找到","显示没找到","showfind","shownofind"]` 选项</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FindMultiColorTable" id="FindMultiColorTable"> <a href="https://zimaoxy.com/m/post/zm.findmulticolortable/" target="_blank">zm.FindMultiColorTable 超级多点找色遍历</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>与 <a href="https://zimaoxy.com/m/post/zm.findmulticolor/" target="_blank">zm.findmulticolor</a> 类似, 参数只有一个对象数组, 可实现遍历参数的键值对象进行查找</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FindMultiColorTable(对象table)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象table: table, 把 <a href="https://zimaoxy.com/m/post/zm.findmulticolor/" target="_blank">zm.findmulticolor</a> 的对象参数放入table数组中, 实现遍历多点找色</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">table_ , 找到返回结果保存到表中, 格式为`{"success":找到数量, "fail":没找到数量, "键名":{id, x, y, name, "id":id, "x":x, "y":y, "name":name, "miss":miss}, ...}`, 全部没找到或失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFindMultiColorTable');">复制代码</div>
                <pre id="codeFindMultiColorTable">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim 打怪(), Boss坐标()
打怪["史莱姆"] = {"00AAFF", "44|12|F01BA0-101010", true}
打怪["黑龙"] = {100,200,300,400, "1155BB", "11|-2|F01123", true}
打怪["紫猫BOSS"] = {"FFFFFF", "-55|102|000000", Boss坐标} //这个不点击, 并返回值保存在Boss坐标中

//遍历打怪数组, 返回每个对象成员的结果
Dim t = zm.FindMultiColorTable(打怪)
If t Then
    TracePrint "找到了", t["success"], "个对象"
    TracePrint "没找到", t["fail"], "个对象"
    If t["史莱姆"] Then
        TracePrint "找到史莱姆, 坐标为", t["史莱姆"]["x"], t["史莱姆"]["y"]
    End If
Else
    TracePrint "所有对象都没有找到"
End If

If Boss坐标(0) > -1 Then
    TracePrint "紫猫BOSS对象里的返回参数依旧有效"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>该命令与 <a href="https://zimaoxy.com/m/post/zm.findmulticolor/" target="_blank">zm.findmulticolor</a> 类似, 唯一区别在于参数只有一个对象table, 可以遍历所有对象<br>
V2.1829: 加入命令<br>
V3.1852: <br>
    偏移颜色组参数支持带小数点坐标<br>
    启用检测是否消失功能后, 返回最后一次出现的坐标与序号, 保存在键名`missx`, `missy`, `missid`中<br>
V4.2039: 加入颜色描述数组数据支持</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FindMultiColorTap" id="FindMultiColorTap"> <a href="https://zimaoxy.com/m/post/zm.findmulticolortap/" target="_blank">zm.FindMultiColorTap 超级多点找色点击</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>与 <a href="https://zimaoxy.com/m/post/zm.findmulticolor/" target="_blank">zm.findmulticolor</a> 类似, 区别在于本命令内置找到后点击. 由于查找与点击是两个动作组成, 为方便代码阅读理解, 故新增本命令</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">序号坐标颜色 = zm.FindMultiColorTap([对象,][x1,y1,x2,y2,][第一点颜色,偏移颜色组][,方向][,相似度[,智能相似度[,相似度步长]]][,超时时间][,点击坐标][,显示日志][,输出行号][,备注][,等待消失][,消失超时][,参数返回值])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象: 表, 可选, 把所有参数放入一个table中传入, 若后面跟有其他参数, 则会对应覆盖对象数据<br>x1: 数值型, 可选, 查找范围的左上角x坐标, 省略默认为0<br>y1: 数值型, 可选, 查找范围的左上角y坐标, 省略默认为0<br>x2: 数值型, 可选, 查找范围的右下角x坐标, 省略默认为0<br>y2: 数值型, 可选, 查找范围的右下角y坐标, 省略默认为0<br>第一点颜色: 字符串, 可选, 要查找的16进制颜色，格式为“BBGGRR”，多个颜色用“&#124;”隔开，偏色使用“-”隔开，比如"FFFFFF-101010&#124;123456", 后面必须跟偏移颜色组, 支持多参数, 详见示例<br>偏移颜色组: 字符串, 可选, 相对与第一个颜色坐标点的偏移颜色组，推荐用抓抓工具快速生成, 前面必须是第一点颜色，支持多参数, 详见示例<br>方向: 字符串, 可选, 从指定方向开始查找, 省略默认为`"左上"`, 支持`["左上","中心","右上","左下","右下","上左","上右","下左","下右"]`这几个值<br>相似度: 数值型, 可选, 对比查找的相似度小数, 省略默认为`0.9`, 取值范围`[0, 1.0]`, 越高越相似<br>智能相似度: 数值型, 可选, 与相似度组成组成智能相似计算范围, 适合图色变化大的情况, 省略默认取值与`相似度`相同, 取值范围`[0, 1.0]`, 越高越相似<br>相似度步长: 数值型, 可选, 智能相似度调节变化间隔, 必须写在`相似度`后面, 省略默认为`0.05`, 取值范围`[0, 1.0]`<br>超时时间: 数值型, 可选, 最大查找耗时, 单位毫秒, 如果一次找不到, 可以限时循环查找, 省略默认为`1`<br>点击坐标: 字符串, 可选, 点击修改后的坐标, 格式`"±x,±y,t"`, 省略为点击找到坐标, `t`是可选的, 表示点击后延时毫秒, 例如`"100,100"`表示固定点击坐标100,100, `"+10,-10"`表示偏移点击找到的x+10,y-10位置, `"10,10,2000"`表示点击10,10坐标后延时2000毫秒, 该参数会受 <a href="https://zimaoxy.com/m/post/zm.settap/" target="_blank">zm.settap</a> 影响<br>显示日志: 字符串, 可选, 输出调试日志信息, 省略默认为"隐藏", 支持 `["显示","显示找到", "显示没找到","隐藏","show", "showfind", "shownofind","hide"]` 这几个值<br>输出行号: 字符串, 可选, 格式为`"_"`开头后跟行号, 比如`"_10"`表示第10行代码, 输出调试信息窗口显示第几行代码, 需开启显示日志才有效<br>备注: 字符串, 可选, 格式为`"@"`开头后跟内容, 比如`"@拾取屠龙刀"`, 输出调试信息窗口就会增加这条内容, 若连续两个`"@@"`则表示在浮窗中显示信息, 需要开启显示日志才有效<br>等待消失: 数值型, 可选, 填写`-1`禁用或`-2`启用, `-2`表示找到后或点击后继续查找, 直到找不到或消失超时, 省略默认为`-1`, 启用后返回值将有`miss`键名, 值为`true`时表示成功消失, 值为`false`表示未消失<br>消失超时: 数值型, 可选, 填写`负数`, 表示等待消失的超时时间, 单位毫秒, 注意必须填写负数, 不可填-1和-2, 省略默认为`-2000`<br>参数返回值: 表, 可选, 只能传入数组变量名, 用于保存查找结果, 格式与命令返回值相同</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 找到返回结果保存到表中, 格式为`{id, x, y, name, "id":id, "x":x, "y":y, "name":name, "miss":miss}`, 没找到或出错返回null, 使用方法请看示例</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFindMultiColorTap');">复制代码</div>
                <pre id="codeFindMultiColorTap">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//本命令内置找到后点击, 其他用法例子与zm.FindMultiColor()相同
Dim ret
ret = zm.FindMultiColorTap("BDBDBD", "56|33|614B6B", "242424", "-10|2|ABC54A,9|4|12DC67")
If ret Then
    TracePrint "颜色找到并执行了点击"
Else
    TracePrint "没有找到颜色, 不执行点击"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>内置找到后点击坐标, 无法取消, 建议需要点击操作的超级图色使用本命令, 方便代码阅读理解<br>
该命令用法灵活多变, 更多用法请大家自行摸索, 灵活使用输出日志可以事半功倍<br>
多点找色数据请通过抓抓进行获取<br>
偏色是微调，指对RBG三色分别确定取色范围。相似度是粗调，指对颜色整体做百分比判断。<br>
偏移颜色组是指相对于第一个点的偏移坐标与颜色，比如第一个点颜色123456在100,120坐标，第二个点颜色abcdef在150,180坐标，那么点2相对于点1的偏移坐标就是150-100,180-120，偏移颜色组为“50|60|abcdef”。<br>
V1.1820: 加入命令<br>
V2.1826<br>
    为智能相似度增加另一种方便的写法, 旧语法依旧有效<br>
V3.1852: <br>
    偏移颜色组参数支持带小数点坐标<br>
    启用检测是否消失功能后, 返回最后一次出现的坐标与序号, 保存在键名`missx`, `missy`, `missid`中<br>
V4.2039: 加入颜色描述数组数据支持<br>
V4.2042: 日志参数 `showlog` 加入 `["显示找到","显示没找到","showfind","shownofind"]` 选项</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FindPic" id="FindPic"> <a href="https://zimaoxy.com/m/post/zm.findpic/" target="_blank">zm.FindPic 超级找图</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>比  <a href="https://zimaoxy.com/m/post/findpic/" target="_blank">findpic</a>  更加强大的命令, 具体特色如下<br><br>- 想找会变化的动态图? 请看下面示例<br>- 附件Attachment单词太长? 那就直接省略掉, 只写图片文件名<br>- 想要兼容多套分辨率? 那就指定pic路径默认值为当前分辨率与dpi<br>- 参数太多, 写的累? 所有参数都是可选的, 使你的代码更加简洁清晰<br>- 参数太多, 顺序记不住? 除了对象与范围是固定顺序外, 其他参数全部可以打乱顺序随便写<br>- 省略参数的默认值不理想? 可使用  <a href="https://zimaoxy.com/m/post/zm.setfindpic/" target="_blank">zm.setfindpic</a>  来自定义修改<br>- 担心一次找不到图片? 自由设置限时循环查找时间, 提高成功率<br>- 画面变化太大, 相似度不好设置? 智能相似度帮你全自动查找<br>- 查找方向的数值总是记不住? 直接用中文 `"左上","中心","右上","左下","右下",...` 来代替<br>- 脚本出错找不到问题? 开启日志输出显示参数, 所有问题一目了然<br>- 找到后想等画面消失再继续下一步操作吗? 等待消失参数帮你解决这个烦恼<br>- 支持命令返回值与参数返回值, 你想怎么写, 就怎么写<br>- 返回值中有序号, 坐标, 还有对应的图片名<br>- 支持对象参数写法, 将所有参数保存到一张表里, 直接传入该表<br>- 支持重写, 即传入对象参数后, 再写其他参数将会覆盖对应的对象数据<br>- 需要防检测点击功能? 推荐使用 <a href="https://zimaoxy.com/m/post/zm.findpictap/" target="_blank">zm.findpictap</a> <br>- 需要遍历多个对象数组? 推荐使用 <a href="https://zimaoxy.com/m/post/zm.findpictable/" target="_blank">zm.findpictable</a> <br><br>!!! warning "常见错误"<br>    本命令的方向参数是字符串型, 例如`"左上"`之类, 而按键自带命令的方向是数值型, 例如`0`之类, 如果直接复制按键命令的参数, 一定要记得修改方向参数!</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">序号坐标图片名 = zm.FindPic([对象,][x1,y1,x2,y2,][图片][,偏色][,方向][,相似度[,智能相似度[,相似度步长]]][,超时时间][,是否点击][,点击坐标][,显示日志][,输出行号][,备注][,等待消失][,消失超时][,参数返回值])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象: 表, 可选, 把所有参数放入一个table中传入, 若后面跟有其他参数, 则会对应覆盖对象数据<br>x1: 数值型, 可选, 查找范围的左上角x坐标, 省略默认为0<br>y1: 数值型, 可选, 查找范围的左上角y坐标, 省略默认为0<br>x2: 数值型, 可选, 查找范围的右下角x坐标, 省略默认为0<br>y2: 数值型, 可选, 查找范围的右下角y坐标, 省略默认为0<br>图片: 字符串, 可选, 查找的图片路径, 多个图片路径用“&#124;”隔开, 支持透明图, 支持PNG BMP JPG等格式, 注意图片数量过多可能会导致异常错误, 具体以设备性能为准.<br>偏色: 字符串, 可选, 图片的偏色, 格式为“BBGGRR”, 省略默认为"000000"<br>方向: 字符串, 可选, 从指定方向开始查找, 省略默认为`"左上"`, 支持`["左上","中心","右上","左下","右下","上左","上右","下左","下右"]`这几个值<br>相似度: 数值型, 可选, 对比查找的相似度小数, 省略默认为`0.8`, 取值范围`[0, 1.0]`, 越高越相似<br>智能相似度: 数值型, 可选, 与相似度组成组成智能相似计算范围, 适合图色变化大的情况, 省略默认取值与`相似度`相同, 取值范围`[0, 1.0]`, 越高越相似<br>相似度步长: 数值型, 可选, 智能相似度调节变化间隔, 必须写在`相似度`后面, 省略默认为`0.05`, 取值范围`[0, 1.0]`<br>超时时间: 数值型, 可选, 最大查找耗时, 单位毫秒, 如果一次找不到, 可以限时循环查找, 省略默认为`1`<br>是否点击: 布尔型, 可选, 是否需要找到后自动点击该坐标, 支持`[true, false]`这两个值, 省略默认为`false`<br>点击坐标: 字符串, 可选, 点击修改后的坐标, 格式`"±x,±y,t"`, 省略为找到的坐标, `t`是可选的, 表示点击后延时毫秒, 例如`"100,100"`表示固定点击坐标100,100, `"+10,-10"`表示偏移点击找到的x+10,y-10位置, `"10,10,2000"`表示点击10,10坐标后延时2000毫秒, 该参数会受 <a href="https://zimaoxy.com/m/post/zm.settap/" target="_blank">zm.settap</a> 影响<br>显示日志: 字符串, 可选, 输出调试日志信息, 省略默认为"隐藏", 支持 `["显示","显示找到", "显示没找到","隐藏","show", "showfind", "shownofind","hide"]` 这几个值<br>输出行号: 字符串, 可选, 格式为`"_"`开头后跟行号, 比如`"_10"`表示第10行代码, 输出调试信息窗口显示第几行代码, 需开启显示日志才有效<br>备注: 字符串, 可选, 格式为`"@"`开头后跟内容, 比如`"@拾取屠龙刀"`, 输出调试信息窗口就会增加这条内容, 若连续两个`"@@"`则表示在浮窗中显示信息, 需要开启显示日志才有效<br>等待消失: 数值型, 可选, 填写`-1`禁用或`-2`启用, `-2`表示找到后或点击后继续查找, 直到找不到或消失超时, 省略默认为`-1`, 启用后返回值将有`miss`键名, 值为`true`时表示成功消失, 值为`false`表示未消失<br>消失超时: 数值型, 可选, 填写`负数`, 表示等待消失的超时时间, 单位毫秒, 注意必须填写负数, 不可填-1和-2, 省略默认为`-2000`<br>参数返回值: 表, 可选, 只能传入数组变量名, 用于保存查找结果, 格式与命令返回值相同</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 找到返回结果保存到表中, 格式为`{id, x, y, name, "id":id, "x":x, "y":y, "name":name, "miss":miss}`, 没找到或出错返回null, 使用方法请看示例</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFindPic');">复制代码</div>
                <pre id="codeFindPic">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//--------------------初级用法--------------------//
Dim ret
//一张图片名实现附件找图功能, 省略了Attachment:
ret = zm.FindPic("图片.png")
If ret Then
    TracePrint "可以用以下3种格式获取返回值"
    TracePrint "找到序号" & ret(0), "x=" & ret(1), "y=" & ret(2), "图片名=" & ret(3)
    TracePrint "找到序号" & ret[1], "x=" & ret[2], "y=" & ret[3], "图片名=" & ret[4]
    TracePrint "找到序号" & ret["id"], "x=" & ret["x"], "y=" & ret["y"], "图片名=" & ret["name"]
Else
    TracePrint "没有找到"
End If

//--------------------查找变化动态图--------------------//
Dim ret
//原理: 用抓抓截图后, 图片是静止不变的, 多次截图可以获取到不同的画面
//      说明所谓的动态图其实就是由一些静止不动的画面来回切换实现的
//      那么对每一次截图并保存下来, 只要任何一张图找到了, 都可以认为是找到这个动态图了
//      所以可以使用本命令设置超时时间来实现
//      想提高查找速度的话, 建议缩小范围, 提高相似度
ret = zm.FindPic("图片1.png|图片2.png|图片3.png",5000)
If ret Then
    TracePrint "找到序号" & ret(0), "x=" & ret(1), "y=" & ret(2), "图片名=" & ret(3)
Else
    TracePrint "没有找到"
End If

//--------------------中级用法--------------------//
Dim 返回数组()
//参数返回值必须是任意数组的变量名, 注意括号写法
//范围省略默认为全屏, 若填写, 则4个数字必须全写, 除对象参数外, 其他参数都要写在范围后面
If zm.FindPic(100, 200, 300, 400, "图片1.bmp|Attachment:图片2.png|/sdcard/图片3.jpg", 0.8, 返回数组) Then
    TracePrint "找到序号" & 返回数组["id"], "x=" & 返回数组["x"], "y=" & 返回数组["y"], "图片名=" & 返回数组["name"]
Else
    TracePrint "没有找到"
End If

//--------------------高级用法--------------------//
//范围后面的可选参数全部可以打乱顺序任意填写或省略, 只要数据类型与格式正确即可
//注意, "第一点颜色","偏移颜色组"这两个参数必须连在一起, 详见上面参数介绍
//这句代码意思如下:
//在范围(100,200,300,400)里, 以相似度为(0.8)的设置, 从("中心")向四周循环查找("图片.png")最多2秒钟
//找到任何一张后退出循环查找, 然后点击找到的坐标(True), 并将找到的序号与坐标结果保存到数组变量(ret)与(返回数组)中
//同时开启日志的输出("显示")功能, 在当前脚本第("_54")行输出备注("@怪物1"), 查找结果与其他参数信息
ret = zm.FindPic(100, 200, 300, 400, "图片.png", 0.8, 2000, "中心", True, "显示", "@怪物1", 返回数组, "_54")
If ret Then
    TracePrint "找到了"
Else
    TracePrint "没有找到"
End If

//--------------------对象用法--------------------//
//可以把所有参数放到一个表中, 可选参数一样可以打乱顺序任意填写或省略
//对象参数必须填写在第一个参数位置
//如果参数对象后面还有参数, 比如("_46"), 则表示重写对象里的("_36"), 使日志输出显示在65行
Dim 史莱姆 = {"图片.png", 0.8, 2000, True, "显示", "@攻击史莱姆", 返回数组, "_36"}
zm.FindPic 史莱姆, "_65", "史莱姆.bmp"

//--------------------修改默认值--------------------//
Dim IXYs()
//设置默认参数返回值IXYs, 若命令不填写参数返回值, 则默认保存在该变量中
//设置默认日志输出为显示状态, 后面所有 zm.FindPic() 都默认输出调试信息
//更多修改默认设置详见 zm.SetFindPic() 命令帮助
zm.SetFindPic {"ret":IXYs, "showlog":"显示"}
If zm.FindPic("图片.png") Then
    TracePrint "可以用以下3种格式获取返回值"
    TracePrint "找到序号" & IXYs(0), "x=" & IXYs(1), "y=" & IXYs(2), "图片名=" & IXYs(3)
    TracePrint "找到序号" & IXYs[1], "x=" & IXYs[2], "y=" & IXYs[3], "图片名=" & IXYs[4]
    TracePrint "找到序号" & IXYs["id"], "x=" & IXYs["x"], "y=" & IXYs["y"], "图片名=" & IXYs["name"]
Else
    TracePrint "没有找到"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>该命令用法灵活多变, 更多用法请大家自行摸索, 灵活使用输出日志可以事半功倍<br>
偏色是微调，指对RBG三色分别确定取色范围。相似度是粗调，指对颜色整体做百分比判断。<br>
透明图是指当你图片4个角的颜色均相同时，则这张图片中所有这个颜色将被视为透明色，在找图匹配点过程中忽略这些点的颜色。另外，透明图也支持PNG格式图片中的透明点。<br>
更多详细说明与例子见<https://zimaoxy.com/b/t-18-1-1.html><br>
V1.1741: 加入命令<br>
V1.1745: 查找次数参数修改为超时参数, 加入自定义日志备注与行号, 其中设置相关的属性也有所变动<br>
V1.1746: 加入点击坐标参数<br>
V1.1750: 删除随机范围点击功能, 加入智能相似度参数<br>
V1.1802: <br>
    支持 <a href="https://zimaoxy.com/m/post/zm.settap/" target="_blank">zm.settap</a> 的随机点击<br>
    通过 <a href="https://zimaoxy.com/m/post/keepcapture/" target="_blank">keepcapture</a> 加快超级图色查找速度<br>
    优化部分参数判定, 兼容更多乱序参数<br>
    返回值加入找到图片名<br>
V1.1803: 支持超级缩放命令, 点击功能只受是否点击参数影响<br>
V1.1804: 加入找到后等待消失可选参数<br>
V1.1813: 修复点击参数不继承`zm.SetTap()`设置延时问题, 感谢`likanglong`反馈<br>
V1.1818: <br>
    修复由超级缩放命令引起的自动点击坐标0,0问题, 感谢`ersheep`反馈此BUG<br>
    修复超级图色输出是否点击异常, 感谢`2578学员`反馈此BUG<br>
V2.1826: 为智能相似度增加另一种方便的写法, 旧语法依旧有效<br>
V2.1828: 若要点击找到坐标, 推荐使用 <a href="https://zimaoxy.com/m/post/zm.findpictap/" target="_blank">zm.findpictap</a> <br>
V4.2042: 日志参数 `showlog` 加入 `["显示找到","显示没找到","showfind","shownofind"]` 选项</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FindPicEx" id="FindPicEx"> <a href="https://zimaoxy.com/m/post/zm.findpicex/" target="_blank">zm.FindPicEx 超级找图返回所有坐标</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>与 <a href="https://zimaoxy.com/m/post/zm.findpic/" target="_blank">zm.findpic</a> 类似, 区别在于本命令会找到所有符合条件的坐标并返回二维数组<br><br>!!! warning "常见错误"<br>    本命令没有方向参数!</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FindPicEx([对象,][x1,y1,x2,y2,][图片][,偏色][,相似度[,智能相似度[,相似度步长]]][,超时时间][,是否点击][,点击坐标][,显示日志][,输出行号][,备注][,等待消失][,消失超时][,参数返回值])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象: 表, 可选, 把所有参数放入一个table中传入, 若后面跟有其他参数, 则会对应覆盖对象数据<br>x1: 数值型, 可选, 查找范围的左上角x坐标, 省略默认为0<br>y1: 数值型, 可选, 查找范围的左上角y坐标, 省略默认为0<br>x2: 数值型, 可选, 查找范围的右下角x坐标, 省略默认为0<br>y2: 数值型, 可选, 查找范围的右下角y坐标, 省略默认为0<br>图片: 字符串, 可选, 查找的图片路径, 多个图片路径用“&#124;”隔开, 支持透明图, 支持PNG BMP JPG等格式, 注意图片数量过多可能会导致异常错误, 具体以设备性能为准.<br>偏色: 字符串, 可选, 图片的偏色, 格式为“BBGGRR”, 省略默认为"000000"<br>相似度: 数值型, 可选, 对比查找的相似度小数, 省略默认为`0.8`, 取值范围`[0, 1.0]`, 越高越相似<br>智能相似度: 数值型, 可选, 与相似度组成组成智能相似计算范围, 适合图色变化大的情况, 省略默认取值与`相似度`相同, 取值范围`[0, 1.0]`, 越高越相似<br>相似度步长: 数值型, 可选, 智能相似度调节变化间隔, 必须写在`相似度`后面, 省略默认为`0.05`, 取值范围`[0, 1.0]`<br>超时时间: 数值型, 可选, 最大查找耗时, 单位毫秒, 如果一次找不到, 可以限时循环查找, 省略默认为`1`<br>是否点击: 布尔型, 可选, 是否需要找到后自动点击该坐标, 支持`[true, false]`这两个值, 省略默认为`false`<br>点击坐标: 字符串, 可选, 点击修改后的坐标, 格式`"±x,±y,t"`, 省略为找到的坐标, `t`是可选的, 表示点击后延时毫秒, 例如`"100,100"`表示固定点击坐标100,100, `"+10,-10"`表示偏移点击找到的x+10,y-10位置, `"10,10,2000"`表示点击10,10坐标后延时2000毫秒, 该参数会受 <a href="https://zimaoxy.com/m/post/zm.settap/" target="_blank">zm.settap</a> 影响<br>显示日志: 字符串, 可选, 输出调试日志信息, 省略默认为"隐藏", 支持 `["显示","显示找到", "显示没找到","隐藏","show", "showfind", "shownofind","hide"]` 这几个值<br>输出行号: 字符串, 可选, 格式为`"_"`开头后跟行号, 比如`"_10"`表示第10行代码, 输出调试信息窗口显示第几行代码, 需开启显示日志才有效<br>备注: 字符串, 可选, 格式为`"@"`开头后跟内容, 比如`"@拾取屠龙刀"`, 输出调试信息窗口就会增加这条内容, 若连续两个`"@@"`则表示在浮窗中显示信息, 需要开启显示日志才有效<br>等待消失: 数值型, 可选, 填写`-1`禁用或`-2`启用, `-2`表示找到后或点击后继续查找, 直到找不到或消失超时, 省略默认为`-1`, 启用后返回值将有`miss`键名, 值为`true`时表示成功消失, 值为`false`表示未消失<br>消失超时: 数值型, 可选, 填写`负数`, 表示等待消失的超时时间, 单位毫秒, 注意必须填写负数, 不可填-1和-2, 省略默认为`-2000`<br>参数返回值: 表, 可选, 只能传入数组变量名, 用于保存查找结果, 格式与命令返回值相同</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">table_ , 找到返回结果保存到表中, 格式为`{ {id, x, y}, ..., "xy":{id:{ {x,y}, ...}, ...}, "id":{id, ...}, "counts":数量, "miss":miss}`, 没找到或出错返回`null`</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFindPicEx');">复制代码</div>
                <pre id="codeFindPicEx">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim ret
ret = zm.FindPicEx("紫猫.png|学院.bmp|/sdcard/test.png")
If ret Then
    TracePrint "图片找到了, 有以下几种方式遍历找到的坐标"
    TracePrint "第1种:遍历数组方法"
    For i = 0 to Ubound(ret)
        TracePrint "图片序号:", ret(i, 0), " 坐标:", ret(i, 1), ret(i, 2)
    Next

    TracePrint "第2种:遍历键名"
    For Each k , v In ret["xy"]
    	For Each xy In v
    		TracePrint "图片序号:", k, " 坐标:", xy[1], xy[2]
    	Next
    Next
    
    TracePrint "第3种:获取指定图片序号的坐标"
    If ret["xy"][2] Then 
    	For Each xy In ret["xy"][2]
    		TracePrint "图片序号2的找到坐标:", xy[1], xy[2]
    	Next
    Else 
    	TracePrint "图片序号2没有找到"
    End If
Else
    TracePrint "没有找到图片"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>该命令与 <a href="https://zimaoxy.com/m/post/zm.findpic/" target="_blank">zm.findpic</a> 类似, 区别在于返回内容是找到的所有坐标二维数组<br>
V3.1831: 加入命令<br>
V4.2042: 日志参数 `showlog` 加入 `["显示找到","显示没找到","showfind","shownofind"]` 选项</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FindPicExA" id="FindPicExA"> <a href="https://zimaoxy.com/m/post/zm.findpicexa/" target="_blank">zm.FindPicExA 超级找图返回所有坐标(Image版)</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>与 <a href="https://zimaoxy.com/m/post/zm.findpicex/" target="_blank">zm.findpicex</a> 类似, 区别在于本命令采用  <a href="https://zimaoxy.com/m/post/image.findpic/" target="_blank">image.findpic</a>  算法实现<br><br>!!! warning "常见错误"<br>    本命令的方向参数是字符串型, 例如`"左上"`之类, 而按键自带命令的方向是数值型, 例如`0`之类, 如果直接复制按键命令的参数, 一定要记得修改方向参数!</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FindPicExA([对象,][x1,y1,x2,y2,][图片][,偏色][,方向][,相似度[,智能相似度[,相似度步长]]][,超时时间][,是否点击][,点击坐标][,显示日志][,输出行号][,备注][,等待消失][,消失超时][,参数返回值])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象: 表, 可选, 把所有参数放入一个table中传入, 若后面跟有其他参数, 则会对应覆盖对象数据<br>x1: 数值型, 可选, 查找范围的左上角x坐标, 省略默认为0<br>y1: 数值型, 可选, 查找范围的左上角y坐标, 省略默认为0<br>x2: 数值型, 可选, 查找范围的右下角x坐标, 省略默认为0<br>y2: 数值型, 可选, 查找范围的右下角y坐标, 省略默认为0<br>图片: 字符串, 可选, 查找的图片路径, 多个图片路径用“&#124;”隔开, 支持透明图, 支持PNG BMP JPG等格式, 注意图片数量过多可能会导致异常错误, 具体以设备性能为准.<br>偏色: 字符串, 可选, 图片的偏色, 格式为“BBGGRR”, 省略默认为"000000"<br>方向: 字符串, 可选, 从指定方向开始查找, 省略默认为`"左上"`, 支持`["左上","中心","右上","左下","右下","上左","上右","下左","下右"]`这几个值<br>相似度: 数值型, 可选, 对比查找的相似度小数, 省略默认为`0.8`, 取值范围`[0, 1.0]`, 越高越相似<br>智能相似度: 数值型, 可选, 与相似度组成组成智能相似计算范围, 适合图色变化大的情况, 省略默认取值与`相似度`相同, 取值范围`[0, 1.0]`, 越高越相似<br>相似度步长: 数值型, 可选, 智能相似度调节变化间隔, 必须写在`相似度`后面, 省略默认为`0.05`, 取值范围`[0, 1.0]`<br>超时时间: 数值型, 可选, 最大查找耗时, 单位毫秒, 如果一次找不到, 可以限时循环查找, 省略默认为`1`<br>是否点击: 布尔型, 可选, 是否需要找到后自动点击该坐标, 支持`[true, false]`这两个值, 省略默认为`false`<br>点击坐标: 字符串, 可选, 点击修改后的坐标, 格式`"±x,±y,t"`, 省略为找到的坐标, `t`是可选的, 表示点击后延时毫秒, 例如`"100,100"`表示固定点击坐标100,100, `"+10,-10"`表示偏移点击找到的x+10,y-10位置, `"10,10,2000"`表示点击10,10坐标后延时2000毫秒, 该参数会受 <a href="https://zimaoxy.com/m/post/zm.settap/" target="_blank">zm.settap</a> 影响<br>显示日志: 字符串, 可选, 输出调试日志信息, 省略默认为"隐藏", 支持 `["显示","显示找到", "显示没找到","隐藏","show", "showfind", "shownofind","hide"]` 这几个值<br>输出行号: 字符串, 可选, 格式为`"_"`开头后跟行号, 比如`"_10"`表示第10行代码, 输出调试信息窗口显示第几行代码, 需开启显示日志才有效<br>备注: 字符串, 可选, 格式为`"@"`开头后跟内容, 比如`"@拾取屠龙刀"`, 输出调试信息窗口就会增加这条内容, 若连续两个`"@@"`则表示在浮窗中显示信息, 需要开启显示日志才有效<br>等待消失: 数值型, 可选, 填写`-1`禁用或`-2`启用, `-2`表示找到后或点击后继续查找, 直到找不到或消失超时, 省略默认为`-1`, 启用后返回值将有`miss`键名, 值为`true`时表示成功消失, 值为`false`表示未消失<br>消失超时: 数值型, 可选, 填写`负数`, 表示等待消失的超时时间, 单位毫秒, 注意必须填写负数, 不可填-1和-2, 省略默认为`-2000`<br>参数返回值: 表, 可选, 只能传入数组变量名, 用于保存查找结果, 格式与命令返回值相同</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">table_ , 找到返回结果保存到表中, 格式为`{ {x, y}, ..., "counts":数量, "miss":miss}`, 没找到或出错返回`null`</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFindPicExA');">复制代码</div>
                <pre id="codeFindPicExA">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim ret
ret = zm.FindPicExA("紫猫.png|学院.bmp|/sdcard/test.png")
If ret Then
    TracePrint "图片找到了, 有以下几种方式遍历找到的坐标"
    TracePrint "第1种:遍历数组方法"
    For i = 0 to Ubound(ret)
        TracePrint " 坐标:", ret(i, 0), ret(i, 1)
    Next
    
    TracePrint "第2种:遍历表方法"
    For i = 1 to Ubound(ret)+1
        TracePrint " 坐标:", ret[i][1], ret[i][2]
    Next
Else
    TracePrint "没有找到图片"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V4.2118: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FindPicTable" id="FindPicTable"> <a href="https://zimaoxy.com/m/post/zm.findpictable/" target="_blank">zm.FindPicTable 超级找图遍历</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>与 <a href="https://zimaoxy.com/m/post/zm.findpic/" target="_blank">zm.findpic</a> 类似, 参数只有一个对象数组, 可实现遍历参数的键值对象进行查找</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FindPicTable(对象table)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象table: table, 把 <a href="https://zimaoxy.com/m/post/zm.findpic/" target="_blank">zm.findpic</a> 的对象参数放入table数组中, 实现遍历找图</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">查找结果, table_ , 找到返回结果保存到表中, 格式为`{"success":找到数量, "fail":没找到数量, "键名":{id, x, y, name, "id":id, "x":x, "y":y, "name":name, "miss":miss}, ...}`, 全部没找到或失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFindPicTable');">复制代码</div>
                <pre id="codeFindPicTable">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim 打怪(), Boss坐标()
打怪["史莱姆"] = {"史莱姆1.bmp|史莱姆2.png", true}
打怪["黑龙"] = {100,200,300,400, "龙.png", true}
打怪["紫猫BOSS"] = {"帅气的紫猫老师.png", Boss坐标} //这个不点击, 并返回值保存在Boss坐标中

//遍历打怪数组, 返回每个对象成员的结果
Dim t = zm.FindPicTable(打怪)
If t Then
    TracePrint "找到了", t["success"], "个对象"
    TracePrint "没找到", t["fail"], "个对象"
    If t["史莱姆"] Then
        TracePrint "找到史莱姆, 坐标为", t["史莱姆"]["x"], t["史莱姆"]["y"]
    End If
Else
    TracePrint "所有对象都没有找到"
End If

If Boss坐标(0) > -1 Then
    TracePrint "紫猫BOSS对象里的返回参数依旧有效"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>该命令与 <a href="https://zimaoxy.com/m/post/zm.findpic/" target="_blank">zm.findpic</a> 类似, 唯一区别在于参数只有一个对象table, 可以遍历所有对象<br>
V2.1829: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FindPicTap" id="FindPicTap"> <a href="https://zimaoxy.com/m/post/zm.findpictap/" target="_blank">zm.FindPicTap 超级找图点击</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>与 <a href="https://zimaoxy.com/m/post/zm.findpic/" target="_blank">zm.findpic</a> 类似, 区别在于本命令内置找到后点击. 由于查找与点击是两个动作组成, 为方便代码阅读理解, 故新增本命令</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">序号坐标图片名 = zm.FindPicTap([对象,][x1,y1,x2,y2,][图片][,偏色][,方向][,相似度[,智能相似度[,相似度步长]]][,超时时间][,点击坐标][,显示日志][,输出行号][,备注][,等待消失][,消失超时][,参数返回值])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象: 表, 可选, 把所有参数放入一个table中传入, 若后面跟有其他参数, 则会对应覆盖对象数据<br>x1: 数值型, 可选, 查找范围的左上角x坐标, 省略默认为0<br>y1: 数值型, 可选, 查找范围的左上角y坐标, 省略默认为0<br>x2: 数值型, 可选, 查找范围的右下角x坐标, 省略默认为0<br>y2: 数值型, 可选, 查找范围的右下角y坐标, 省略默认为0<br>图片: 字符串, 可选, 查找的图片路径, 多个图片路径用“&#124;”隔开, 支持透明图, 支持PNG BMP JPG等格式, 注意图片数量过多可能会导致异常错误, 具体以设备性能为准.<br>偏色: 字符串, 可选, 图片的偏色, 格式为“BBGGRR”, 省略默认为"000000"<br>方向: 字符串, 可选, 从指定方向开始查找, 省略默认为`"左上"`, 支持`["左上","中心","右上","左下","右下","上左","上右","下左","下右"]`这几个值<br>相似度: 数值型, 可选, 对比查找的相似度小数, 省略默认为`0.8`, 取值范围`[0, 1.0]`, 越高越相似<br>智能相似度: 数值型, 可选, 与相似度组成组成智能相似计算范围, 适合图色变化大的情况, 省略默认取值与`相似度`相同, 取值范围`[0, 1.0]`, 越高越相似<br>相似度步长: 数值型, 可选, 智能相似度调节变化间隔, 必须写在`相似度`后面, 省略默认为`0.05`, 取值范围`[0, 1.0]`<br>超时时间: 数值型, 可选, 最大查找耗时, 单位毫秒, 如果一次找不到, 可以限时循环查找, 省略默认为`1`<br>点击坐标: 字符串, 可选, 点击修改后的坐标, 格式`"±x,±y,t"`, 省略为点击找到坐标, `t`是可选的, 表示点击后延时毫秒, 例如`"100,100"`表示固定点击坐标100,100, `"+10,-10"`表示偏移点击找到的x+10,y-10位置, `"10,10,2000"`表示点击10,10坐标后延时2000毫秒, 该参数会受 <a href="https://zimaoxy.com/m/post/zm.settap/" target="_blank">zm.settap</a> 影响<br>显示日志: 字符串, 可选, 输出调试日志信息, 省略默认为"隐藏", 支持 `["显示","显示找到", "显示没找到","隐藏","show", "showfind", "shownofind","hide"]` 这几个值<br>输出行号: 字符串, 可选, 格式为`"_"`开头后跟行号, 比如`"_10"`表示第10行代码, 输出调试信息窗口显示第几行代码, 需开启显示日志才有效<br>备注: 字符串, 可选, 格式为`"@"`开头后跟内容, 比如`"@拾取屠龙刀"`, 输出调试信息窗口就会增加这条内容, 若连续两个`"@@"`则表示在浮窗中显示信息, 需要开启显示日志才有效<br>等待消失: 数值型, 可选, 填写`-1`禁用或`-2`启用, `-2`表示找到后或点击后继续查找, 直到找不到或消失超时, 省略默认为`-1`, 启用后返回值将有`miss`键名, 值为`true`时表示成功消失, 值为`false`表示未消失<br>消失超时: 数值型, 可选, 填写`负数`, 表示等待消失的超时时间, 单位毫秒, 注意必须填写负数, 不可填-1和-2, 省略默认为`-2000`<br>参数返回值: 表, 可选, 只能传入数组变量名, 用于保存查找结果, 格式与命令返回值相同</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 找到返回结果保存到表中, 格式为`{id, x, y, name, "id":id, "x":x, "y":y, "name":name, "miss":miss}`, 没找到或出错返回null, 使用方法请看示例</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFindPicTap');">复制代码</div>
                <pre id="codeFindPicTap">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//本命令内置找到后点击, 其他用法例子与zm.FindPic()相同
Dim ret
ret = zm.FindPicTap("图片.png")
If ret Then
    TracePrint "图片找到并执行了点击"
Else
    TracePrint "没有找到图片, 不执行点击"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>内置找到后点击坐标, 无法取消, 建议需要点击操作的超级图色使用本命令, 方便代码阅读理解<br>
该命令用法灵活多变, 更多用法请大家自行摸索, 灵活使用输出日志可以事半功倍<br>
偏色是微调，指对RBG三色分别确定取色范围。相似度是粗调，指对颜色整体做百分比判断。<br>
透明图是指当你图片4个角的颜色均相同时，则这张图片中所有这个颜色将被视为透明色，在找图匹配点过程中忽略这些点的颜色。另外，透明图也支持PNG格式图片中的透明点。<br>
更多详细说明与例子见<https://zimaoxy.com/b/t-18-1-1.html><br>
V1.1820: 加入命令<br>
V2.1826<br>
    为智能相似度增加另一种方便的写法, 旧语法依旧有效<br>
V4.2042: 日志参数 `showlog` 加入 `["显示找到","显示没找到","showfind","shownofind"]` 选项</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FindStr" id="FindStr"> <a href="https://zimaoxy.com/m/post/zm.findstr/" target="_blank">zm.FindStr 超级找字</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>比  <a href="https://zimaoxy.com/m/post/findstr/" target="_blank">findstr</a>  更加强大的命令, 具体特色如下<br><br>- 不想记设置字库与切换字库命令? 本命令已集成这两个功能, 只要填写参数即可<br>- 参数太多, 写的累? 所有参数都是可选的, 使你的代码更加简洁清晰<br>- 参数太多, 顺序记不住? 除了对象与范围是固定顺序外, 其他参数全部可以打乱顺序随便写<br>- 省略参数的默认值不理想? 可使用  <a href="https://zimaoxy.com/m/post/zm.setfindstr/" target="_blank">zm.setfindstr</a>  来自定义修改<br>- 担心一次找不到文字? 自由设置限时循环查找时间, 提高成功率<br>- 画面变化太大, 相似度不好设置? 智能相似度帮你全自动查找<br>- 脚本出错找不到问题? 开启日志输出显示参数, 所有问题一目了然<br>- 找到后想等画面消失再继续下一步操作吗? 等待消失参数帮你解决这个烦恼<br>- 支持命令返回值与参数返回值, 你想怎么写, 就怎么写<br>- 返回值中有序号, 坐标, 还有对应的文字内容<br>- 支持对象参数写法, 将所有参数保存到一张表里, 直接传入该表<br>- 支持重写, 即传入对象参数后, 再写其他参数将会覆盖对应的对象数据<br>- 需要防检测点击功能? 推荐使用 <a href="https://zimaoxy.com/m/post/zm.findstrtap/" target="_blank">zm.findstrtap</a> <br>- 需要遍历多个对象数组? 推荐使用 <a href="https://zimaoxy.com/m/post/zm.findstrtable/" target="_blank">zm.findstrtable</a> </td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">序号与坐标 = zm.FindStr([对象,][x1,y1,x2,y2,][文字][,颜色][,相似度[,智能相似度[,相似度步长]]][,超时时间][,字库文件名][,字库序号][,是否点击][,点击坐标][,显示日志][,输出行号][,备注][,等待消失][,消失超时][,参数返回值])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象: 表, 可选, 把所有参数放入一个table中传入, 若后面跟有其他参数, 则会对应覆盖对象数据<br>x1: 数值型, 可选, 查找范围的左上角x坐标, 省略默认为0<br>y1: 数值型, 可选, 查找范围的左上角y坐标, 省略默认为0<br>x2: 数值型, 可选, 查找范围的右下角x坐标, 省略默认为0<br>y2: 数值型, 可选, 查找范围的右下角y坐标, 省略默认为0<br>文字: 字符串, 可选, 查找的文字内容, 多个文字用“&#124;”隔开, 可以用`$`开头表示文字参数<br>颜色: 字符串, 可选, 要文字的16进制颜色，格式为“BBGGRR”，多个颜色用“&#124;”隔开，偏色使用“-”隔开，比如"FFFFFF-101010&#124;123456"<br>相似度: 数值型, 可选, 对比查找的相似度小数, 省略默认为`0.9`, 取值范围`[0, 1.0]`, 越高越相似<br>智能相似度: 数值型, 可选, 与相似度组成组成智能相似计算范围, 适合图色变化大的情况, 省略默认取值与`相似度`相同, 取值范围`[0, 1.0]`, 越高越相似<br>相似度步长: 数值型, 可选, 智能相似度调节变化间隔, 必须写在`相似度`后面, 省略默认为`0.05`, 取值范围`[0, 1.0]`<br>超时时间: 数值型, 可选, 最大查找耗时, 单位毫秒, 如果一次找不到, 可以限时循环查找, 省略默认为`1`<br>字库文件名: 字符串, 可选, 填写字库的文件名即可, 附件路径`"Attachment:"`可以省略不写<br>字库序号: 字符串, 可选, 切换字库序号, 0号字库填写`"#0"`, 以此类推, 当填写字库文件名, 不填字库序号时, 默认设置并使用9号字库<br>是否点击: 布尔型, 可选, 是否需要找到后自动点击该坐标, 支持`[true, false]`这两个值, 省略默认为`false`<br>点击坐标: 字符串, 可选, 点击修改后的坐标, 格式`"±x,±y,t"`, 省略为找到的坐标, `t`是可选的, 表示点击后延时毫秒, 例如`"100,100"`表示固定点击坐标100,100, `"+10,-10"`表示偏移点击找到的x+10,y-10位置, `"10,10,2000"`表示点击10,10坐标后延时2000毫秒, 该参数会受 <a href="https://zimaoxy.com/m/post/zm.settap/" target="_blank">zm.settap</a> 影响<br>显示日志: 字符串, 可选, 输出调试日志信息, 省略默认为"隐藏", 支持 `["显示","显示找到", "显示没找到","隐藏","show", "showfind", "shownofind","hide"]` 这几个值<br>输出行号: 字符串, 可选, 格式为`"_"`开头后跟行号, 比如`"_10"`表示第10行代码, 输出调试信息窗口显示第几行代码, 需开启显示日志才有效<br>备注: 字符串, 可选, 格式为`"@"`开头后跟内容, 比如`"@拾取屠龙刀"`, 输出调试信息窗口就会增加这条内容, 若连续两个`"@@"`则表示在浮窗中显示信息, 需要开启显示日志才有效<br>等待消失: 数值型, 可选, 填写`-1`禁用或`-2`启用, `-2`表示找到后或点击后继续查找, 直到找不到或消失超时, 省略默认为`-1`, 启用后返回值将有`miss`键名, 值为`true`时表示成功消失, 值为`false`表示未消失<br>消失超时: 数值型, 可选, 填写`负数`, 表示等待消失的超时时间, 单位毫秒, 注意必须填写负数, 不可填-1和-2, 省略默认为`-2000`<br>参数返回值: 表, 可选, 只能传入数组变量名, 用于保存查找结果, 格式与命令返回值相同</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 找到返回结果保存到表中, 格式为`{id, x, y, name, "id":id, "x":x, "y":y, "name":name, "miss":miss}`, 没找到或出错返回null, 使用方法请看示例</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFindStr');">复制代码</div>
                <pre id="codeFindStr">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//--------------------初级用法--------------------//
Dim ret
SetDictEx 0, "Attachment:mq_soft.txt"
UseDict 0
//默认全屏查找颜色为"FFFFFF-101010"的"紫猫学院"这4个字
ret = zm.FindStr("紫猫学院", "FFFFFF-101010")
If ret Then
    TracePrint "可以用以下3种格式获取返回值"
    TracePrint "找到序号" & ret(0), "x=" & ret(1), "y=" & ret(2), "文字=" & ret(3)
    TracePrint "找到序号" & ret[1], "x=" & ret[2], "y=" & ret[3], "文字=" & ret[4]
    TracePrint "找到序号" & ret["id"], "x=" & ret["x"], "y=" & ret["y"], "文字=" & ret["name"]
Else
    TracePrint "没有找到"
End If

//--------------------中级用法--------------------//
Dim 返回数组()
//参数返回值必须是任意数组的变量名, 注意括号写法
//设置附件的"mq_soft.txt"为9号字库, 注意, 所有找字命令都会默认使用此字库
//范围省略默认为全屏, 若填写, 则4个数字必须全写, 除对象参数外, 其他参数都要写在范围后面
If zm.FindStr(100, 200, 300, 400, "紫猫学院", "FFFFFF-101010", "mq_soft.txt", 返回数组) Then
    TracePrint "可以用以下3种格式获取返回值"
    TracePrint "找到序号=" & 返回数组(0), "x=" & 返回数组(1), "y=" & 返回数组(2), "文字=" & 返回数组(3)
    TracePrint "找到序号=" & 返回数组[1], "x=" & 返回数组[2], "y=" & 返回数组[3], "文字=" & 返回数组[4]
    TracePrint "找到序号=" & 返回数组["id"], "x=" & 返回数组["x"], "y=" & 返回数组["y"], "文字=" & 返回数组["name"]
Else
    TracePrint "没有找到"
End If

//--------------------高级用法--------------------//
//文字后面的可选参数全部可以打乱顺序任意填写或省略, 只要数据类型与格式正确即可
//这句代码意思如下:
//在范围(100,200,300,400)里, 相似度为(0.8), 设置附件字库("mq_soft.txt")为("1")号字库
//限时2000毫秒内循环查找颜色为("FFFFFF-101010")的("紫猫|学院")
//找到任何一个后退出循环查找, 然后点击找到的坐标(True), 并将找到的序号与坐标结果保存到数组变量(ret)与(返回数组)中
//同时开启日志的输出("显示")功能, 在当前脚本第("_40")行输出备注("@怪物1"), 查找结果与其他参数信息
ret = zm.FindStr(100, 200, 300, 400, "紫猫|学院", "FFFFFF-101010", 0.8, 2000, True, "mq_soft.txt", "#1", "显示", "@怪物1", 返回数组, "_40")
If ret Then
    TracePrint "找到了"
Else
    TracePrint "没有找到"
End If

//--------------------对象用法--------------------//
//可以把所有参数放到一个表中, 可选参数一样可以打乱顺序任意填写或省略
//对象参数必须填写在第一个参数位置
Dim 史莱姆 = {"紫猫|学院", 0.8, 3000, True, "显示", "@攻击史莱姆", 返回数组, "_36"}
zm.FindStr 史莱姆

//--------------------重写用法--------------------//
//如果参数对象后面还有参数, 比如("_56"), 则表示重写对象里的("_36"), 使日志输出显示在65行
//注意, 如果重写, 则必须给参数文字带前缀"$", 比如"$紫猫|学院"
Dim 史莱姆 = {"$紫猫|学院", 0.8, 1000, True, "显示", "@攻击史莱姆", 返回数组, "_36"}
zm.FindStr 史莱姆, "$喵星人", "FFFFFF-101010", 1.0, "_56"

//--------------------修改默认值--------------------//
Dim IXYs()
//设置默认参数返回值IXYs, 若命令不填写参数返回值, 则默认保存在该变量中
//设置默认日志输出为显示状态, 后面所有 zm.FindStr() 都默认输出调试信息
//更多修改默认设置详见 zm.SetFindStr() 命令帮助
zm.SetFindStr {"ret":IXYs, "showlog":"显示"}
If zm.FindStr("喵星人", "00AAFF") Then
    TracePrint "可以用以下3种格式获取返回值"
    TracePrint "找到序号" & IXYs(0), "x=" & IXYs(1), "y=" & IXYs(2), "文字=" & IXYs(3)
    TracePrint "找到序号" & IXYs[1], "x=" & IXYs[2], "y=" & IXYs[3], "文字=" & IXYs[4]
    TracePrint "找到序号" & IXYs["id"], "x=" & IXYs["x"], "y=" & IXYs["y"], "文字=" & IXYs["name"]
Else
    TracePrint "没有找到"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>该命令用法灵活多变, 更多用法请大家自行摸索, 灵活使用输出日志可以事半功倍<br>
当区域范围均为0时，表示全屏查找文字，强烈建议缩小范围查找，这样可以提高效率。<br>
偏色是微调，指对RBG三色分别确定取色范围。相似度是粗调，指对颜色整体做百分比判断。<br>
颜色格式为“BGR”，目前不支持HSV颜色、不支持背景色识别。<br>
目前只支持附件中的字库，不支持绝对路径，故更新字库后，一定要记得更新附件。<br>
参数字库文件名仅支持新版抓抓制作的字库, 若使用大漠字库, 请用官方命令设置<br>
V1.1741: 加入命令<br>
V1.1745: 查找次数参数修改为超时参数, 加入自定义日志备注与行号, 其中设置相关的属性也有所变动<br>
V1.1746: 加入点击坐标参数<br>
V1.1750: 删除随机范围点击功能, 加入智能相似度参数<br>
V1.1802: <br>
    支持 <a href="https://zimaoxy.com/m/post/zm.settap/" target="_blank">zm.settap</a> 的随机点击<br>
    通过 <a href="https://zimaoxy.com/m/post/keepcapture/" target="_blank">keepcapture</a> 加快超级图色查找速度<br>
    优化部分参数判定, 兼容更多乱序参数<br>
    返回值加入找到文字<br>
V1.1803: 支持超级缩放命令, 点击功能只受是否点击参数影响<br>
V1.1804: 加入找到后等待消失可选参数<br>
V1.1813: 修复点击参数不继承`zm.SetTap()`设置延时问题, 感谢`likanglong`反馈<br>
V1.1818: <br>
    修复由超级缩放命令引起的自动点击坐标0,0问题, 感谢`ersheep`反馈此BUG<br>
    修复超级图色输出是否点击异常, 感谢`2578学员`反馈此BUG<br>
V2.1826: 为智能相似度增加另一种方便的写法, 旧语法依旧有效<br>
V2.1828: 若要点击找到坐标, 推荐使用 <a href="https://zimaoxy.com/m/post/zm.findstrtap/" target="_blank">zm.findstrtap</a> <br>
V4.2017: 修复字库序号参数报错问题<br>
V4.2042: 日志参数 `showlog` 加入 `["显示找到","显示没找到","showfind","shownofind"]` 选项</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FindStrTable" id="FindStrTable"> <a href="https://zimaoxy.com/m/post/zm.findstrtable/" target="_blank">zm.FindStrTable 超级找字遍历</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>与 <a href="https://zimaoxy.com/m/post/zm.findstr/" target="_blank">zm.findstr</a> 类似, 参数只有一个对象数组, 可实现遍历参数的键值对象进行查找</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.FindStrTable(对象table)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象table: table, 把 <a href="https://zimaoxy.com/m/post/zm.findstr/" target="_blank">zm.findstr</a> 的对象参数放入table数组中, 实现遍历找字</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">table_ , 找到返回结果保存到表中, 格式为`{"success":找到数量, "fail":没找到数量, "键名":{id, x, y, name, "id":id, "x":x, "y":y, "name":name, "miss":miss}, ...}`, 没找到或失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFindStrTable');">复制代码</div>
                <pre id="codeFindStrTable">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//此处省略了设置字库的代码, 请自行补充完善

Dim 打怪(), Boss坐标()
打怪["史莱姆"] = {"史莱姆", "000000", true}
打怪["黑龙"] = {100,200,300,400, "黑龙", "123ABC-303030", true}
打怪["紫猫BOSS"] = {"帅气的紫猫老师","FFFFFF", Boss坐标} //这个不点击, 并返回值保存在Boss坐标中

//遍历打怪数组, 返回每个对象成员的结果
Dim t = zm.FindStrTable(打怪)
If t Then
    TracePrint "找到了", t["success"], "个对象"
    TracePrint "没找到", t["fail"], "个对象"
    If t["史莱姆"] Then
        TracePrint "找到史莱姆, 坐标为", t["史莱姆"]["x"], t["史莱姆"]["y"]
    End If
Else
    TracePrint "所有对象都没有找到"
End If

If Boss坐标(0) > -1 Then
    TracePrint "紫猫BOSS对象里的返回参数依旧有效"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>该命令与 <a href="https://zimaoxy.com/m/post/zm.findstr/" target="_blank">zm.findstr</a> 类似, 唯一区别在于参数只有一个对象table, 可以遍历所有对象<br>
V2.1829: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="FindStrTap" id="FindStrTap"> <a href="https://zimaoxy.com/m/post/zm.findstrtap/" target="_blank">zm.FindStrTap 超级找字点击</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>与 <a href="https://zimaoxy.com/m/post/zm.findstr/" target="_blank">zm.findstr</a> 类似, 区别在于本命令内置找到后点击. 由于查找与点击是两个动作组成, 为方便代码阅读理解, 故新增本命令</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">序号与坐标 = zm.FindStrTap([对象,][x1,y1,x2,y2,][文字][,颜色][,相似度[,智能相似度[,相似度步长]]][,超时时间][,字库文件名][,字库序号][,点击坐标][,显示日志][,输出行号][,备注][,等待消失][,消失超时][,参数返回值])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象: 表, 可选, 把所有参数放入一个table中传入, 若后面跟有其他参数, 则会对应覆盖对象数据<br>x1: 数值型, 可选, 查找范围的左上角x坐标, 省略默认为0<br>y1: 数值型, 可选, 查找范围的左上角y坐标, 省略默认为0<br>x2: 数值型, 可选, 查找范围的右下角x坐标, 省略默认为0<br>y2: 数值型, 可选, 查找范围的右下角y坐标, 省略默认为0<br>文字: 字符串, 可选, 查找的文字内容, 多个文字用“&#124;”隔开, 可以用`$`开头表示文字参数<br>颜色: 字符串, 可选, 要文字的16进制颜色，格式为“BBGGRR”，多个颜色用“&#124;”隔开，偏色使用“-”隔开，比如"FFFFFF-101010&#124;123456"<br>相似度: 数值型, 可选, 对比查找的相似度小数, 省略默认为`0.9`, 取值范围`[0, 1.0]`, 越高越相似<br>智能相似度: 数值型, 可选, 与相似度组成组成智能相似计算范围, 适合图色变化大的情况, 省略默认取值与`相似度`相同, 取值范围`[0, 1.0]`, 越高越相似<br>相似度步长: 数值型, 可选, 智能相似度调节变化间隔, 必须写在`相似度`后面, 省略默认为`0.05`, 取值范围`[0, 1.0]`<br>超时时间: 数值型, 可选, 最大查找耗时, 单位毫秒, 如果一次找不到, 可以限时循环查找, 省略默认为`1`<br>字库文件名: 字符串, 可选, 填写字库的文件名即可, 附件路径`"Attachment:"`可以省略不写<br>字库序号: 字符串, 可选, 切换字库序号, 0号字库填写`"#0"`, 以此类推, 当填写字库文件名, 不填字库序号时, 默认设置并使用9号字库<br>点击坐标: 字符串, 可选, 点击修改后的坐标, 格式`"±x,±y,t"`, 省略为点击找到坐标, `t`是可选的, 表示点击后延时毫秒, 例如`"100,100"`表示固定点击坐标100,100, `"+10,-10"`表示偏移点击找到的x+10,y-10位置, `"10,10,2000"`表示点击10,10坐标后延时2000毫秒, 该参数会受 <a href="https://zimaoxy.com/m/post/zm.settap/" target="_blank">zm.settap</a> 影响<br>显示日志: 字符串, 可选, 输出调试日志信息, 省略默认为"隐藏", 支持 `["显示","显示找到", "显示没找到","隐藏","show", "showfind", "shownofind","hide"]` 这几个值<br>输出行号: 字符串, 可选, 格式为`"_"`开头后跟行号, 比如`"_10"`表示第10行代码, 输出调试信息窗口显示第几行代码, 需开启显示日志才有效<br>备注: 字符串, 可选, 格式为`"@"`开头后跟内容, 比如`"@拾取屠龙刀"`, 输出调试信息窗口就会增加这条内容, 若连续两个`"@@"`则表示在浮窗中显示信息, 需要开启显示日志才有效<br>等待消失: 数值型, 可选, 填写`-1`禁用或`-2`启用, `-2`表示找到后或点击后继续查找, 直到找不到或消失超时, 省略默认为`-1`, 启用后返回值将有`miss`键名, 值为`true`时表示成功消失, 值为`false`表示未消失<br>消失超时: 数值型, 可选, 填写`负数`, 表示等待消失的超时时间, 单位毫秒, 注意必须填写负数, 不可填-1和-2, 省略默认为`-2000`<br>参数返回值: 表, 可选, 只能传入数组变量名, 用于保存查找结果, 格式与命令返回值相同</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 找到返回结果保存到表中, 格式为`{id, x, y, name, "id":id, "x":x, "y":y, "name":name, "miss":miss}`, 没找到或出错返回null, 使用方法请看示例</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeFindStrTap');">复制代码</div>
                <pre id="codeFindStrTap">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//本命令内置找到后点击, 其他用法例子与zm.FindStr()相同
Dim ret
SetDictEx 0, "Attachment:mq_soft.txt"
UseDict 0
ret = zm.FindStrTap("紫猫学院", "FFFFFF-101010")
If ret Then
    TracePrint "文字找到并执行了点击"
Else
    TracePrint "没有找到文字, 不执行点击"
End If</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>内置找到后点击坐标, 无法取消, 建议需要点击操作的超级图色使用本命令, 方便代码阅读理解<br>
该命令用法灵活多变, 更多用法请大家自行摸索, 灵活使用输出日志可以事半功倍<br>
当区域范围均为0时，表示全屏查找文字，强烈建议缩小范围查找，这样可以提高效率。<br>
偏色是微调，指对RBG三色分别确定取色范围。相似度是粗调，指对颜色整体做百分比判断。<br>
颜色格式为“BGR”，目前不支持HSV颜色、不支持背景色识别。<br>
目前只支持附件中的字库，不支持绝对路径，故更新字库后，一定要记得更新附件。<br>
参数字库文件名仅支持新版抓抓制作的字库, 若使用大漠字库, 请用官方命令设置<br>
V1.1820: 加入命令<br>
V2.1826<br>
    为智能相似度增加另一种方便的写法, 旧语法依旧有效<br>
V4.2042: 日志参数 `showlog` 加入 `["显示找到","显示没找到","showfind","shownofind"]` 选项</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="SetCmpColorEx" id="SetCmpColorEx"> <a href="https://zimaoxy.com/m/post/zm.setcmpcolorex/" target="_blank">zm.SetCmpColorEx 设置CmpColorEx默认参数</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>修改  <a href="https://zimaoxy.com/m/post/zm.cmpcolorex/" target="_blank">zm.cmpcolorex</a>  的默认参数值。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">默认值 = zm.SetCmpColorEx(属性表)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">属性表: 表, 按照指定格式对表中的键值对进行赋值, 例如{"sim":0.8, "showlog":"显示"}表示修改相似度默认为0.8, 日志输出默认为显示, 更多属性见下面表格<br><br>属性 | 默认值 | 数据类型 | 解释<br>---|-----|------|---<br>sim | 0.9 | 数值型 | 默认颜色相似度, 取值范围[0, 1.0], 越高越相似<br>autosim | "" | 字符串 | 默认智能相似度, 格式为"最低相似度-最高相似度-相似度步长"<br>numsim | "1.0" | 字符串 | 默认数量相似度, 取值范围[0, 1.0], 越高越相似<br>timeout | 1 | 数值型 | 默认超时时间, 默认1毫秒<br>delaytime | 10 | 数值型 | 循环对比间隔时间, 开启超时时间参数后, 如果发现设备出现卡顿, 可加大delaytime<br>delaytap | 0 | 数值型 | 对比成功后如果要点击, 则延时一段时间再点击<br>tap | false | 布尔型 | 找到后是否点击, 默认不点击<br>showlog | "隐藏" | 字符串 | 日志输出显示, 可选 `["显示","显示找到","显示没找到","隐藏","show", "showfind", "shownofind","hide"]` 这几个值<br>ret | null | 数组型 | 参数返回值, 只能写数组变量名, 设置后, 若命令不带参数返回值, 则默认返回到此变量中<br></td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 返回所有默认属性值, 可使用 `For Each` 遍历查看</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeSetCmpColorEx');">复制代码</div>
                <pre id="codeSetCmpColorEx">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim IXYs() //预定义默认参数返回数组
//设置默认参数返回值IXYs, 若找色命令不填写参数返回值, 则默认保存在该变量中
//设置默认日志输出为显示状态, 后面所有 超级多点比色 都默认输出调试信息
zm.SetCmpColorEx {"ret":IXYs, "showlog":"显示"}
If zm.CmpColorEx("51|66|00AAFF") Then
    TracePrint "可以用以下3种格式获取返回值"
    TracePrint "找到颜色序号" & IXYs(0), "x=" & IXYs(1), "y=" & IXYs(2)
    TracePrint "找到颜色序号" & IXYs[1], "x=" & IXYs[2], "y=" & IXYs[3]
    TracePrint "找到颜色序号" & IXYs["id"], "x=" & IXYs["x"], "y=" & IXYs["y"]
End If

//默认值改动后, 效果会一直存在, 并且可以随时增加新的变化
//此处改动颜色相似度默认为0.8, 超时时间为5000毫秒, 并将日志改为隐藏, 找到后自动点击一次
Dim t = {"sim":0.8, "timeout":5000, "tap":true, "showlog":"hide"}
Dim ret = zm.SetCmpColorEx(t)
//可以通过For Each查看目前所有默认属性值, 参数列表中未出现的属性不建议修改
TracePrint "属性名:属性值"
For Each k , v In ret
    TracePrint k, ":", v
Next</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>请严格按照参数列表的属性名与数据类型进行赋值改动<br>
V3.1830: 加入命令<br>
V3.1835: 加入循环对比间隔时间<br>
V3.1849: <br>
  加入延时点击属性`delaytap`<br>
  修改循环间隔时间默认为10毫秒<br>
V4.2042: 日志参数 `showlog` 加入 `["显示找到","显示没找到","showfind","shownofind"]` 选项</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="SetFindColor" id="SetFindColor"> <a href="https://zimaoxy.com/m/post/zm.setfindcolor/" target="_blank">zm.SetFindColor 设置FindColor默认参数</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>修改  <a href="https://zimaoxy.com/m/post/zm.findcolor/" target="_blank">zm.findcolor</a>  的默认参数值。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">默认值 = zm.SetFindColor(属性表)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">属性表: 表, 按照指定格式对表中的键值对进行赋值, 例如{"sim":0.8, "showlog":"显示"}表示修改相似度默认为0.8, 日志输出默认为显示, 更多属性见下面表格<br><br>属性 | 默认值 | 数据类型 | 解释<br>---|-----|------|---<br>x1 | 0 | 数值型 | 查找范围左上角x坐标<br>y1 | 0 | 数值型 | 查找范围左上角y坐标<br>x2 | 0 | 数值型 | 查找范围右下角x坐标<br>y2 | 0 | 数值型 | 查找范围右下角y坐标<br>color | "" | 字符串 | 默认查找的十六进制颜色值<br>dir | "左上" | 字符串 | 默认从左上开始查找, 可选["左上","中心","右上","左下","右下"]这几个值<br>sim | 1.0 | 数值型 | 默认相似度, 取值范围[0, 1.0], 越高越相似<br>autosim | "" | 字符串 | 默认智能相似度, 格式为"最低相似度-最高相似度-相似度步长"<br>timeout | 1 | 数值型 | 默认超时时间, 默认1毫秒<br>delaytime | 10 | 数值型 | 循环查找间隔时间, 开启超时时间参数后, 如果发现设备出现卡顿, 可加大delaytime<br>delaytap | 0 | 数值型 | 找到后如果要点击, 则延时一段时间再点击<br>tap | false | 布尔型 | 找到后是否点击, 默认不点击<br>showlog | "隐藏" | 字符串 | 日志输出显示, 可选 `["显示","显示找到","显示没找到","隐藏","show", "showfind", "shownofind","hide"]` 这几个值<br>ret | null | 数组型 | 参数返回值, 只能写数组变量名, 设置后, 若命令不带参数返回值, 则默认返回到此变量中<br></td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 返回所有默认属性值, 可使用 `For Each` 遍历查看</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeSetFindColor');">复制代码</div>
                <pre id="codeSetFindColor">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim IXYs() //预定义默认参数返回数组
//设置默认参数返回值IXYs, 若找色命令不填写参数返回值, 则默认保存在该变量中
//设置默认日志输出为显示状态, 后面所有 超级找色 都默认输出调试信息
zm.SetFindColor {"ret":IXYs, "showlog":"显示"}
If zm.FindColor("00AAFF") Then
    TracePrint "可以用以下3种格式获取返回值"
    TracePrint "找到颜色序号" & IXYs(0), "x=" & IXYs(1), "y=" & IXYs(2)
    TracePrint "找到颜色序号" & IXYs[1], "x=" & IXYs[2], "y=" & IXYs[3]
    TracePrint "找到颜色序号" & IXYs["id"], "x=" & IXYs["x"], "y=" & IXYs["y"]
End If

//默认值改动后, 效果会一直存在, 并且可以随时增加新的变化
//此处改动相似度默认为0.8, 超时时间为5000毫秒, 并将日志改为隐藏, 找到后自动点击一次
Dim t = {"sim":0.8, "timeout":5000, "tap":true, "showlog":"hide"}
Dim ret = zm.SetFindColor(t)
//可以通过For Each查看目前所有默认属性值, 参数列表中未出现的属性不建议修改
TracePrint "属性名:属性值"
For Each k , v In ret
    TracePrint k, ":", v
Next</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>请严格按照参数列表的属性名与数据类型进行赋值改动<br>
V1.1741: 加入命令<br>
V1.1745: 查找次数参数修改为超时参数, 加入自定义日志备注与行号, 其中设置相关的属性也有所变动<br>
V3.1835: 加入循环查找间隔时间<br>
V3.1849: <br>
  加入延时点击属性`delaytap`<br>
  修改循环间隔时间默认为10毫秒<br>
V4.2042: 日志参数 `showlog` 加入 `["显示找到","显示没找到","showfind","shownofind"]` 选项</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="SetFindMultiColor" id="SetFindMultiColor"> <a href="https://zimaoxy.com/m/post/zm.setfindmulticolor/" target="_blank">zm.SetFindMultiColor 设置FindMultiColor默认参数</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>修改  <a href="https://zimaoxy.com/m/post/zm.findmulticolor/" target="_blank">zm.findmulticolor</a>  的默认参数值。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">默认值 = zm.SetFindMultiColor(属性表)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">属性表: 表, 按照指定格式对表中的键值对进行赋值, 例如{"sim":0.8, "showlog":"显示"}表示修改相似度默认为0.8, 日志输出默认为显示, 更多属性见下面表格<br><br>属性 | 默认值 | 数据类型 | 解释<br>---|-----|------|---<br>x1 | 0 | 数值型 | 查找范围左上角x坐标<br>y1 | 0 | 数值型 | 查找范围左上角y坐标<br>x2 | 0 | 数值型 | 查找范围右下角x坐标<br>y2 | 0 | 数值型 | 查找范围右下角y坐标<br>dir | "左上" | 字符串 | 默认从左上开始查找, 可选["左上","中心","右上","左下","右下"]这几个值<br>sim | 0.9 | 数值型 | 默认相似度, 取值范围[0, 1.0], 越高越相似<br>autosim | "" | 字符串 | 默认智能相似度, 格式为"最低相似度-最高相似度-相似度步长"<br>timeout | 1 | 数值型 | 默认超时时间, 默认1毫秒<br>delaytime | 10 | 数值型 | 循环查找间隔时间, 开启超时时间参数后, 如果发现设备出现卡顿, 可加大delaytime<br>delaytap | 0 | 数值型 | 找到后如果要点击, 则延时一段时间再点击<br>tap | false | 布尔型 | 找到后是否点击, 默认不点击<br>offsetxy | 0 | 数值型 | 对颜色偏移组的坐标实现再次偏移功能<br>showlog | "隐藏" | 字符串 | 日志输出显示, 可选 `["显示","显示找到","显示没找到","隐藏","show", "showfind", "shownofind","hide"]` 这几个值<br>ret | null | 数组型 | 参数返回值, 只能写数组变量名, 设置后, 若命令不带参数返回值, 则默认返回到此变量中<br></td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 返回所有默认属性值, 可使用 `For Each` 遍历查看</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeSetFindMultiColor');">复制代码</div>
                <pre id="codeSetFindMultiColor">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim IXYs() //预定义默认参数返回数组
//设置默认参数返回值IXYs, 若多点找色命令不填写参数返回值, 则默认保存在该变量中
//设置默认日志输出为显示状态, 后面所有 超级多点找色 都默认输出调试信息
zm.SetFindMultiColor {"ret":IXYs, "showlog":"显示"}
If zm.FindMultiColor("00AAFF", "1|4|1432AB") Then
    TracePrint "可以用以下3种格式获取返回值"
    TracePrint "找到颜色序号" & IXYs(0), "x=" & IXYs(1), "y=" & IXYs(2)
    TracePrint "找到颜色序号" & IXYs[1], "x=" & IXYs[2], "y=" & IXYs[3]
    TracePrint "找到颜色序号" & IXYs["id"], "x=" & IXYs["x"], "y=" & IXYs["y"]
End If

//默认值改动后, 效果会一直存在, 并且可以随时增加新的变化
//此处改动相似度默认为0.8, 超时时间为5000毫秒, 并将日志改为隐藏, 找到后自动点击一次
Dim t = {"sim":0.8, "timeout":5000, "tap":true, "showlog":"hide"}
Dim ret = zm.SetFindMultiColor(t)
//可以通过For Each查看目前所有默认属性值, 参数列表中未出现的属性不建议修改
TracePrint "属性名:属性值"
For Each k , v In ret
    TracePrint k, ":", v
Next</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>请严格按照参数列表的属性名与数据类型进行赋值改动<br>
V1.1741: 加入命令<br>
V1.1745: 查找次数参数修改为超时参数, 加入自定义日志备注与行号, 其中设置相关的属性也有所变动<br>
V3.1835: 加入循环查找间隔时间<br>
V3.1849: <br>
  加入延时点击属性`delaytap`<br>
  修改循环间隔时间默认为10毫秒<br>
v3.1852<br>
  偏移颜色组参数可以通过  <a href="https://zimaoxy.com/m/post/zm.setfindmulticolor/" target="_blank">zm.setfindmulticolor</a>  设置 `"offsetxy":1` 属性或其他数字, 实现偏移坐标再次变动功能, 该属性不支持  <a href="https://zimaoxy.com/m/post/zm.findmulticolorex/" target="_blank">zm.findmulticolorex</a> <br>
V4.2042: 日志参数 `showlog` 加入 `["显示找到","显示没找到","showfind","shownofind"]` 选项</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="SetFindPic" id="SetFindPic"> <a href="https://zimaoxy.com/m/post/zm.setfindpic/" target="_blank">zm.SetFindPic 设置FindPic默认参数</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>修改  <a href="https://zimaoxy.com/m/post/zm.findpic/" target="_blank">zm.findpic</a>  的默认参数值。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">默认值 = zm.SetFindPic(属性表)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">属性表: 表, 按照指定格式对表中的键值对进行赋值, 例如{"sim":0.9, "showlog":"显示"}表示修改相似度默认为0.9, 日志输出默认为显示, 更多属性见下面表格<br><br>属性 | 默认值 | 数据类型 | 解释<br>---|-----|------|---<br>x1 | 0 | 数值型 | 查找范围左上角x坐标<br>y1 | 0 | 数值型 | 查找范围左上角y坐标<br>x2 | 0 | 数值型 | 查找范围右下角x坐标<br>y2 | 0 | 数值型 | 查找范围右下角y坐标<br>pic | "Attachment:" | 字符串 | 默认图片路径, 当参数图片只写文件名时, 自动附加此路径<br>color | "000000" | 字符串 | 默认图片偏色<br>dir | "左上" | 字符串 | 默认从左上开始查找, 可选["左上","中心","右上","左下","右下"]这几个值<br>sim | 0.8 | 数值型 | 默认相似度, 取值范围[0, 1.0], 越高越相似<br>autosim | "" | 字符串 | 默认智能相似度, 格式为"最低相似度-最高相似度-相似度步长"<br>timeout | 1 | 数值型 | 默认超时时间, 默认1毫秒<br>delaytime | 10 | 数值型 | 循环查找间隔时间, 开启超时时间参数后, 如果发现设备出现卡顿, 可加大delaytime<br>delaytap | 0 | 数值型 | 找到后如果要点击, 则延时一段时间再点击<br>tap | false | 布尔型 | 找到后是否点击, 默认不点击<br>showlog | "隐藏" | 字符串 | 日志输出显示, 可选 `["显示","显示找到","显示没找到","隐藏","show", "showfind", "shownofind","hide"]` 这几个值<br>ret | null | 数组型 | 参数返回值, 只能写数组变量名, 设置后, 若命令不带参数返回值, 则默认返回到此变量中<br></td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 返回所有默认属性值, 可使用 `For Each` 遍历查看</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeSetFindPic');">复制代码</div>
                <pre id="codeSetFindPic">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim IXYs() //预定义默认参数返回数组
//设置默认参数返回值IXYs, 若找图命令不填写参数返回值, 则默认保存在该变量中
//设置默认日志输出为显示状态, 后面所有 超级找图 都默认输出调试信息
zm.SetFindPic {"ret":IXYs, "showlog":"显示"}
If zm.FindPic("紫猫.bmp") Then
    TracePrint "可以用以下3种格式获取返回值"
    TracePrint "找到颜色序号" & IXYs(0), "x=" & IXYs(1), "y=" & IXYs(2)
    TracePrint "找到颜色序号" & IXYs[1], "x=" & IXYs[2], "y=" & IXYs[3]
    TracePrint "找到颜色序号" & IXYs["id"], "x=" & IXYs["x"], "y=" & IXYs["y"]
End If

//默认值改动后, 效果会一直存在, 并且可以随时增加新的变化
//此处改动相似度默认为0.8, 超时时间为5000毫秒, 并将日志改为隐藏, 找到后自动点击一次
Dim t = {"sim":0.8, "timeout":5000, "tap":true, "showlog":"hide"}
Dim ret = zm.SetFindPic(t)
//可以通过For Each查看目前所有默认属性值, 参数列表中未出现的属性不建议修改
TracePrint "属性名:属性值"
For Each k , v In ret
    TracePrint k, ":", v
Next</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>请严格按照参数列表的属性名与数据类型进行赋值改动<br>
V1.1741: 加入命令<br>
V1.1745: 查找次数参数修改为超时参数, 加入自定义日志备注与行号, 其中设置相关的属性也有所变动<br>
V3.1835: 加入循环查找间隔时间<br>
V3.1849: <br>
  加入延时点击属性`delaytap`<br>
  修改循环间隔时间默认为10毫秒<br>
V4.2042: 日志参数 `showlog` 加入 `["显示找到","显示没找到","showfind","shownofind"]` 选项</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="SetFindStr" id="SetFindStr"> <a href="https://zimaoxy.com/m/post/zm.setfindstr/" target="_blank">zm.SetFindStr 设置FindStr默认参数</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>修改  <a href="https://zimaoxy.com/m/post/zm.findstr/" target="_blank">zm.findstr</a>  的默认参数值。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">默认值 = zm.SetFindStr(属性表)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">属性表: 表, 按照指定格式对表中的键值对进行赋值, 例如{"sim":0.8, "showlog":"显示"}表示修改相似度默认为0.8, 日志输出默认为显示, 更多属性见下面表格<br><br>属性 | 默认值 | 数据类型 | 解释<br>---|-----|------|---<br>x1 | 0 | 数值型 | 查找范围左上角x坐标<br>y1 | 0 | 数值型 | 查找范围左上角y坐标<br>x2 | 0 | 数值型 | 查找范围右下角x坐标<br>y2 | 0 | 数值型 | 查找范围右下角y坐标<br>color | "000000" | 字符串 | 默认文字颜色<br>sim | 0.9 | 数值型 | 默认相似度, 取值范围[0, 1.0], 越高越相似<br>autosim | "" | 字符串 | 默认智能相似度, 格式为"最低相似度-最高相似度-相似度步长"<br>timeout | 1 | 数值型 | 默认超时时间, 默认1毫秒<br>delaytime | 10 | 数值型 | 循环查找间隔时间, 开启超时时间参数后, 如果发现设备出现卡顿, 可加大delaytime<br>delaytap | 0 | 数值型 | 找到后如果要点击, 则延时一段时间再点击<br>tap | false | 布尔型 | 找到后是否点击, 默认不点击<br>showlog | "隐藏" | 字符串 | 日志输出显示, 可选 `["显示","显示找到","显示没找到","隐藏","show", "showfind", "shownofind","hide"]` 这几个值<br>ret | null | 数组型 | 参数返回值, 只能写数组变量名, 设置后, 若命令不带参数返回值, 则默认返回到此变量中<br></td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 返回所有默认属性值, 可使用 `For Each` 遍历查看</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeSetFindStr');">复制代码</div>
                <pre id="codeSetFindStr">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim IXYs() //预定义默认参数返回数组
//设置默认参数返回值IXYs, 若找字命令不填写参数返回值, 则默认保存在该变量中
//设置默认日志输出为显示状态, 后面所有 超级找字 都默认输出调试信息
zm.SetFindStr {"ret":IXYs, "showlog":"显示"}
If zm.FindStr("紫猫|学院", "FBFBFB-202020", "0", "mq_soft.txt") Then
    TracePrint "可以用以下3种格式获取返回值"
    TracePrint "找到序号" & IXYs(0), "x=" & IXYs(1), "y=" & IXYs(2)
    TracePrint "找到序号" & IXYs[1], "x=" & IXYs[2], "y=" & IXYs[3]
    TracePrint "找到序号" & IXYs["id"], "x=" & IXYs["x"], "y=" & IXYs["y"]
End If

//默认值改动后, 效果会一直存在, 并且可以随时增加新的变化
//此处改动相似度默认为0.8, 超时时间为5000毫秒, 并将日志改为隐藏, 找到后自动点击一次
Dim t = {"sim":0.8, "timeout":5000, "tap":true, "showlog":"hide"}
Dim ret = zm.SetFindStr(t)
//可以通过For Each查看目前所有默认属性值, 参数列表中未出现的属性不建议修改
TracePrint "属性名:属性值"
For Each k , v In ret
    TracePrint k, ":", v
Next</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>请严格按照参数列表的属性名与数据类型进行赋值改动<br>
V1.1741: 加入命令<br>
V1.1745: 查找次数参数修改为超时参数, 加入自定义日志备注与行号, 其中设置相关的属性也有所变动<br>
V3.1835: 加入循环查找间隔时间<br>
V3.1849: <br>
  加入延时点击属性`delaytap`<br>
  修改循环间隔时间默认为10毫秒<br>
V4.2042: 日志参数 `showlog` 加入 `["显示找到","显示没找到","showfind","shownofind"]` 选项</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="KeyPress" id="KeyPress"> <a href="https://zimaoxy.com/m/post/zm.keypress/" target="_blank">zm.KeyPress 超级按键</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>按下并弹起一个按键, 可加入随机延时防检测</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.KeyPress([对象][按键[, 间隔毫秒[, 随机毫秒]]][, 显示日志][, 输出行号][, 备注])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">对象: table, 可选, 把所有参数放入一个table中传入, 若后面跟有其他参数, 则会对应覆盖对象数据, 省略默认为null<br>按键: 字符串_或_数值型, 可选, 字符串时表示某个键的名字, 数值时表示某个键的编码, 填写对象参数后可省略<br>间隔毫秒: 数值型, 可选, 按下与弹起之间的间隔时间, -1表示与自带KeyPress相同, 单位毫秒, 省略默认为-1<br>随机毫秒: 数值型, 可选, 与间隔毫秒组成随机数范围, -1表示不随机, 单位毫秒, 省略默认为-1<br>显示日志: 字符串, 可选, 输出调试日志信息, 支持["显示","隐藏","show","hide"]这几个值, 省略默认为”隐藏”<br>输出行号: 字符串, 可选, 格式为"_"开头后跟行号, 比如"_10"表示第10行代码, 输出调试信息窗口显示第几行代码, 需开启显示日志才有效<br>备注: 字符串, 可选, 格式为"@"开头后跟内容, 比如"@拾取屠龙刀", 输出调试信息窗口就会增加这条内容, 若连续两个"@@"则表示在浮窗中显示信息, 需要开启显示日志才有效</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">table_ , 返回实际按键与间隔时间表, 格式为{key,t,”key”:key,”t”:t}, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeKeyPress');">复制代码</div>
                <pre id="codeKeyPress">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//按住电源键3秒后松开
zm.KeyPress "power", 3000

//按住音量+随机3到5秒
zm.KeyPress "VolUp", 3000, 5000</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V3.1835: 初次加入</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="KeyPressCopy" id="KeyPressCopy"> <a href="https://zimaoxy.com/m/post/zm.keypresscopy/" target="_blank">zm.KeyPressCopy 按下复制键</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>模拟按下快捷键复制文本, 类似于`Ctrl+C`, 注意, 部分设备或App可能存在不兼容导致失效情况!</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.KeyPressCopy(是否关闭菜单)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">是否关闭菜单: 布尔型, 可选, 部分设备或app按下组合键后会出现菜单, 省略默认false</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeKeyPressCopy');">复制代码</div>
                <pre id="codeKeyPressCopy">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

zm.KeyPressCopy()</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>注意, 部分设备或App可能存在不兼容导致失效情况!<br>
V3.1852: 初次加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="KeyPressCut" id="KeyPressCut"> <a href="https://zimaoxy.com/m/post/zm.keypresscut/" target="_blank">zm.KeyPressCut 按下剪贴键</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>模拟按下快捷键剪贴文本, 类似于`Ctrl+X`, 注意, 部分设备或App可能存在不兼容导致失效情况!</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.KeyPressCut(是否关闭菜单)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">是否关闭菜单: 布尔型, 可选, 部分设备或app按下组合键后会出现菜单, 省略默认false</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeKeyPressCut');">复制代码</div>
                <pre id="codeKeyPressCut">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

zm.KeyPressCut()</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>注意, 部分设备或App可能存在不兼容导致失效情况!<br>
V3.1852: 初次加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="KeyPressDel" id="KeyPressDel"> <a href="https://zimaoxy.com/m/post/zm.keypressdel/" target="_blank">zm.KeyPressDel 按下删除键</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>删除文本内容, 可以向左或向右删除, 也可以删除当前一行内容, 注意, 部分设备或App可能存在不兼容导致失效情况!</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.KeyPressDel([方向])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">方向: 数值型, 可选, 0表示删除光标左边的字符, 1表示删除光标右边的字符, 2表示删除当前一行内容, 省略默认为0</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeKeyPressDel');">复制代码</div>
                <pre id="codeKeyPressDel">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

zm.KeyPressDel()   //删除左边的
zm.KeyPressDel(1)  //删除右边的
zm.KeyPressDel(2)  //删除一整行</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>注意, 部分设备或App可能存在不兼容导致失效情况!<br>
V3.1852: 初次加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="KeyPressPaste" id="KeyPressPaste"> <a href="https://zimaoxy.com/m/post/zm.keypresspaste/" target="_blank">zm.KeyPressPaste 按下粘贴键</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>模拟按下快捷键粘贴文本, 类似于`Ctrl+V`, 注意, 部分设备或App可能存在不兼容导致失效情况!</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.KeyPressPaste(是否关闭菜单)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">是否关闭菜单: 布尔型, 可选, 部分设备或app按下组合键后会出现菜单, 省略默认false</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeKeyPressPaste');">复制代码</div>
                <pre id="codeKeyPressPaste">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

zm.KeyPressPaste()</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>注意, 部分设备或App可能存在不兼容导致失效情况!<br>
V3.1852: 初次加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="KeyPressScreenShot" id="KeyPressScreenShot"> <a href="https://zimaoxy.com/m/post/zm.keypressscreenshot/" target="_blank">zm.KeyPressScreenShot 按下截图键</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>按下截图键自动保存, 注意, 部分设备的截图文件夹位置可能不一致, 需要手动设置</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.KeyPressScreenShot([截图文件夹][, 保存路径])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">截图文件夹: 字符串, 可选, 指定设备默认截图文件夹路径, 大部分设备默认路径为"/sdcard/Pictures/Screenshots/", 截图路径不对时, 请手动截图一次查看截图文件夹路径, 本参数必须以"/"结尾<br>保存路径: 字符串, 可选, 复制截取的图片到指定文件路径, 省略默认不复制</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 返回默认保存到截图文件夹的图片路径, 不受参数2影响</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeKeyPressScreenShot');">复制代码</div>
                <pre id="codeKeyPressScreenShot">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim path
path = zm.KeyPressScreenShot() //按下截图键保存
TracePrint path</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>注意, 部分设备的截图文件夹位置可能不一致, 请手动截图一次查看截图文件夹路径, 再传入到截图文件夹参数中<br>
V3.1852: 初次加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="KeyPressSelectAll" id="KeyPressSelectAll"> <a href="https://zimaoxy.com/m/post/zm.keypressselectall/" target="_blank">zm.KeyPressSelectAll 按下全选键</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>模拟按下快捷键粘贴文本, 类似于`Ctrl+A`, 注意, 部分设备或App可能存在不兼容导致失效情况!</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.KeyPressSelectAll([是否关闭菜单])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">是否关闭菜单: 布尔型, 可选, 部分设备或app按下组合键后会出现菜单, 省略默认false</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeKeyPressSelectAll');">复制代码</div>
                <pre id="codeKeyPressSelectAll">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

zm.KeyPressSelectAll()</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>注意, 部分设备或App可能存在不兼容导致失效情况!<br>
V3.1852: 初次加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="KeyPressStr" id="KeyPressStr"> <a href="https://zimaoxy.com/m/post/zm.keypressstr/" target="_blank">zm.KeyPressStr 模拟按键输入</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>模拟KeyPress输入字符串内容, 在InputText无效情况下尝试使用, 仅支持小写字母, 数字, 英文标点符号, 不支持大写字母, 中文!</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.KeyPressStr(按键字符串[, 间隔毫秒])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">按键字符串: 字符串, 待输入的字符串内容, 仅支持小写字母, 数字, 英文标点符号, 不支持大写字母, 中文<br>间隔毫秒: 数值型, 可选, 两个字符串之间按键间隔时间, 单位毫秒, 省略默认为200</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">布尔型_ , 成功返回true, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeKeyPressStr');">复制代码</div>
                <pre id="codeKeyPressStr">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//输入abc,def
zm.KeyPressStr "abc,def"</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>命令原型是使用KeyPress命令模拟按下字符串参数的每一个字符键, 所以不支持中文, 大写字母之类的字符!<br>
V3.1835: 初次加入</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="KeyPressSwitch" id="KeyPressSwitch"> <a href="https://zimaoxy.com/m/post/zm.keypressswitch/" target="_blank">zm.KeyPressSwitch 打开运行程序列表</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>打开当前后台程序列表, 类似于切换应用的键, 注意, 部分设备或App可能存在不兼容导致失效情况!</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.KeyPressSwitch()</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">无</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">无</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeKeyPressSwitch');">复制代码</div>
                <pre id="codeKeyPressSwitch">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

zm.KeyPressSwitch()</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>注意, 部分设备或App可能存在不兼容导致失效情况!<br>
V3.1852: 初次加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="SetKeyPress" id="SetKeyPress"> <a href="https://zimaoxy.com/m/post/zm.setkeypress/" target="_blank">zm.SetKeyPress 设置超级按键</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>修改 ` <a href="https://zimaoxy.com/m/post/zm.keypress/" target="_blank">zm.keypress</a> ` 的默认参数值</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.SetKeyPress(属性表)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">属性表: table, 按照指定格式对表中的键值对进行赋值, 例如{"t":100, "rndt":200, "showlog":"显示"}表示修改按下与弹起之间随机延时100到200毫秒, 日志输出默认为显示, 更多属性见下面表格<br><br>属性 | 默认值 | 数据类型 | 解释<br>---|-----|------|---<br>t | -1 | 数值型 | 按下与弹起的间隔毫秒, -1表示KeyPress的默认值<br>rndt | -1 | 数值型 | 与间隔毫秒组成随机数范围, -1表示不随机<br>showlog | "隐藏" | 字符串 | 日志输出显示, 可选["显示","隐藏","show","hide"]这几个值<br></td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">table_ , 返回设置后的参数列表, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeSetKeyPress');">复制代码</div>
                <pre id="codeSetKeyPress">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//设置按键按下与弹起之间的间隔时间为随机1000毫秒到2000毫秒
zm.SetKeyPress {"t":1000, "rndt":2000}</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V3.1835: 初次加入</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="RndArrElement" id="RndArrElement"> <a href="https://zimaoxy.com/m/post/zm.rndarrelement/" target="_blank">zm.RndArrElement 随机数组元素</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>从一维数组的指定下标范围随机取元素。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.RndArrElement(一维数组[, 起始下标[, 终止下标]])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">一维数组: 数组型, 待随机取值的一维数组。<br>起始下标: 数值型, 可选参数，表示下标随机范围，当终止下标省略时，随机0到起始下标。<br>终止下标: 数值型, 可选参数，表示下标随机范围，当起始下标省略时，随机0到最大下标。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">任意类型_ ，返回随机到的数组元素。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeRndArrElement');">复制代码</div>
                <pre id="codeRndArrElement">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim a = {"紫", "猫", "编", "程", "学", "院", 345911220}
Dim s = zm.RndArrElement(a)
TracePrint s</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>调用随机函数前，可用  <a href="https://zimaoxy.com/m/post/zm.rndinitseed/" target="_blank">zm.rndinitseed</a>  运行一次，防止出现有规律的随机。<br>
V1.1720: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="RndInitSeed" id="RndInitSeed"> <a href="https://zimaoxy.com/m/post/zm.rndinitseed/" target="_blank">zm.RndInitSeed 初始化随机种子</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>使用socket库初始化随机种子, 防止规律随机, 建议省略参数, zm.Init()内部已经执行此函数, 无需重复调用</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.RndInitSeed([种子])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">种子: 数值型, 可选, 要初始化的种子, 省略默认将对当前时间计算获取种子值</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数值型_ ，返回随机数种子</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeRndInitSeed');">复制代码</div>
                <pre id="codeRndInitSeed">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

zm.RndInitSeed //如果你开头执行过zm.Init()命令, 则无需再调用本命令</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1720: 加入命令<br>
V1.1730: 修复报错问题<br>
V1.1738: 优化提示</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="RndName" id="RndName"> <a href="https://zimaoxy.com/m/post/zm.rndname/" target="_blank">zm.RndName 随机取姓名</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>随机取姓名，可以指定性别。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.RndName([性别])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">性别: 数值型, 可选参数，表示取姓名的性别，0为女性，1为男性，默认省略为null，表示全随机。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ ，返回随机姓名结果</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeRndName');">复制代码</div>
                <pre id="codeRndName">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim name = zm.RndName()
TracePrint name</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>调用随机函数前，可用  <a href="https://zimaoxy.com/m/post/zm.rndinitseed/" target="_blank">zm.rndinitseed</a>  运行一次。<br>
V1.1720: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="RndNum" id="RndNum"> <a href="https://zimaoxy.com/m/post/zm.rndnum/" target="_blank">zm.RndNum 随机整数</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>获取指定范围的随机数，两个参数不区分大小顺序。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.RndNum(m, n)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">m: 数值型, 可选参数，最大值或最小值，省略默认为0。<br>n: 数值型, 可选参数，最大值或最小值，省略默认为0。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数值型_ ，返回参数范围的随机整数。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeRndNum');">复制代码</div>
                <pre id="codeRndNum">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

TracePrint zm.RndNum(100, 10) //随机10到100
TracePrint zm.RndNum(10, 100) //随机10到100
TracePrint zm.RndNum(100)     //随机0到100</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>调用随机函数前，可用  <a href="https://zimaoxy.com/m/post/zm.rndinitseed/" target="_blank">zm.rndinitseed</a>  运行一次。<br>
V1.1720: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="RndPos" id="RndPos"> <a href="https://zimaoxy.com/m/post/zm.rndpos/" target="_blank">zm.RndPos 随机坐标</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>从多个坐标中随机获取一个坐标与序号</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.RndPos([x,y,...][坐标数组,...])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">x: 数值型, 横坐标数值, 与坐标数组参数二选一, 详见例子<br>y: 数值型, 纵坐标数值, 与坐标数组参数二选一, 详见例子<br>坐标数组: 表, 由坐标组成的数组, 格式为{x,y}, 与坐标数值参数二选一, 详见例子</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">表_ , 返回序号与坐标, 序号从0开始, 格式为{id, x, y}</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeRndPos');">复制代码</div>
                <pre id="codeRndPos">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

//------------数值坐标参数例子------------//
//支持任意数量的坐标, 只要按照x,y格式顺序填写即可
//不可以与坐标数组参数同时填写!
//下面例子是从(100,200),(300,400),(500,600)这3个坐标中随机获取一个坐标
Dim xy = zm.RndPos(100,200,300,400,500,600)
TracePrint "序号:" & xy(0), ", x坐标=" & xy(1), ", y坐标=" & xy(2)

//------------坐标数组参数例子------------//
//支持任意数量的坐标数组, 不可以与数值坐标参数同时填写!
//下面例子是从(100,200),(300,400),(500,600)这3个坐标中随机获取一个坐标
Dim xxyy = zm.RndPos({100,200},{300,400},{500,600})
TracePrint "序号:" & xxyy(0), ", x坐标=" & xxyy(1), ", y坐标=" & xxyy(2)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1804: 加入命令</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="RndStr" id="RndStr"> <a href="https://zimaoxy.com/m/post/zm.rndstr/" target="_blank">zm.RndStr 随机字符串</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>随机指定范围的字符串内容。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.RndStr(个数[, 模式[, 是否不重复]])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">个数: 数值型, 随机字符个数<br>模式: 数值型, 可选参数，表示随机内容，详见下表格，多个类型可相加，省略默认为1+2+4<br>是否不重复: 布尔型, 可选参数，是否取不重复随机内容，省略默认为false</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符型_ ，随机到的字符串内容。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeRndStr');">复制代码</div>
                <pre id="codeRndStr">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

TracePrint zm.RndStr(5)
TracePrint zm.RndStr(6, 2)
TracePrint zm.RndStr(10, 1 + 4, true)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>调用随机函数前，可用  <a href="https://zimaoxy.com/m/post/zm.rndinitseed/" target="_blank">zm.rndinitseed</a>  运行一次。<br>
V1.1720: 加入命令<br>
V1.1724: 增加随机标点符号。<br>
V1.1802: 修复可选参数无效问题</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="RndUniqueArr" id="RndUniqueArr"> <a href="https://zimaoxy.com/m/post/zm.rnduniquearr/" target="_blank">zm.RndUniqueArr 不重复随机数</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>从一维数组中随机取指定个数的不重复元素值。</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.RndUniqueArr([数组,][ 最小值, 最大值,] 个数)</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">数组: 数组型, 可选，一维数组，待随机的数组，与最小值最大值参数二选一。<br>最小值: 数值型, 可选，随机最小值，与数组参数二选一。<br>最大值: 数值型, 可选，随机最大值，与数组参数二选一。<br>个数: 数值型, 可选，获取随机数的数量，省略为最大个数，即打乱顺序，洗牌功能。</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">数组型_ ，获取到的不重复随机元素。</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeRndUniqueArr');">复制代码</div>
                <pre id="codeRndUniqueArr">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

Dim a = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10}
Dim b = zm.RndUniqueArr(a, 5)
TracePrint zm.VarInfo(b)

//从1到10中随机取5个不重复随机数
Dim c = zm.RndUniqueArr(1,10,5)
TracePrint zm.VarInfo(c)</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>调用随机函数前，可用  <a href="https://zimaoxy.com/m/post/zm.rndinitseed/" target="_blank">zm.rndinitseed</a>  运行一次。<br>
提供的一维数组里元素不能出现重复，否则结果可能会出现重复。<br>
V1.1720 加入命令<br>
V1.1750 加入数字范围参数<br>
V3.1830 从`zm.RndNoRepeatArr()`函数名改为`zm.RndUniqueArr()`</td>
        </tr>
    </table>
    <table width="100%" border="0" cellpadding="0" cellspacing="1" class="ts">
        <tr>
            <th width="100">命令名称：</th>
            <td class="name" name="UUID" id="UUID"> <a href="https://zimaoxy.com/m/post/zm.uuid/" target="_blank">zm.UUID 生成UUID</a> </td>
        </tr>
        <tr>
            <th>功能说明：</th>
            <td>生成唯一不重复的UUID, 失败返回null, 建议在脚本开头执行一次 <a href="https://zimaoxy.com/m/post/zm.init/" target="_blank">zm.init</a> 后使用本命令</td>
        </tr>
        <tr>
            <th>语法格式：</th>
            <td class="yufa">结果 = zm.UUID([格式])</td>
        </tr>
        <tr>
            <th>命令参数：</th>
            <td class="canshu">格式: 数值型, 可选, 表示返回大小写格式, 0为小写, 1为大写, 省略默认为0</td>
        </tr>
        <tr>
            <th>返回值：</th>
            <td class="fanhui">字符串_ , 返回36位长度的UUID字符串, 失败返回null</td>
        </tr>
        <tr>
            <th>脚本例子：</th>
            <td class="lizi">
                <div class="copy" onmouseover="hand(this);" onclick="copyToClipboard('codeUUID');">复制代码</div>
                <pre id="codeUUID">
Import "zm.luae" //导入插件,只需执行一次
zm.Init  //初始化插件,只需执行一次

For 10
	TracePrint zm.UUID()
Next</pre>
            </td>
        </tr>
        <tr>
            <th>备注：</th>
            <td>V1.1820: 加入命令<br>
V3.1902: 加入返回大小写参数</td>
        </tr>
    </table>
<img src="http://ia.51.la/go1?id=20744747&pvFlag=1" border="0" style="display:none;" />
</body>
</html>